<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="Master in Computational Social Sciences • 2023-2024">
  <title>Data programming</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/data-science-2.jpeg" data-background-opacity="0.2" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Data programming</h1>
  <p class="subtitle">Data Analysis in R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Master in Computational Social Sciences • 2023-2024 
</div>
</div>
</div>

</section>
<section>
<section id="welcome-to-r" class="title-slide slide level1 center">
<h1>Welcome to R!</h1>
<p><span style="color:#444442;"><strong>Put your spreadsheets aside</strong></span></p>
</section>
<section id="hi" class="slide level2">
<h2>Hi!</h2>
<p><span class="hl-green"><strong>Mail</strong></span>: <strong><a href="mailto:javiealv@pa.uc3m.es" class="email">javiealv@pa.uc3m.es</a></strong> and <strong><a href="mailto:javalv09@ucm.es" class="email">javalv09@ucm.es</a></strong>.</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/me.jpeg"></p>
</div><div class="column" style="width:70%;">
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Javier Álvarez Liébana</strong></span> from Carabanchel (Madrid).</p></li>
<li class="fragment"><p>Degree in Mathematics (UCM). <span class="hl-yellow"><strong>PhD in Statistics</strong></span> (UGR).</p></li>
<li class="fragment"><p>In charge of <span class="hl-yellow"><strong>data visualization and analysis for the Principality of Asturias (2021-2022)</strong></span> during the COVID pandemic.</p></li>
<li class="fragment"><p>Member of the <span class="hl-yellow"><strong>Spanish Society of Statistics and OR</strong></span> and the <span class="hl-yellow"><strong>Spanish Royal Mathematical Society</strong></span>.</p></li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<p>Currently, <span class="hl-yellow"><strong>researcher and lecturer at the Faculty of Statistics of the UCM</strong></span>. Disseminating via <a href="https://twitter.com/dadosdelaplace"><strong>Twitter</strong></a> and <a href="https://instagram.com/javieralvarezliebana"><strong>Instagram</strong></a>.</p>
</div>
</section>
<section id="goals" class="slide level2">
<h2>Goals</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p><img data-src="https://assets-global.website-files.com/6092cb6b4ac959f39728dd26/6188a97fa499b5fbfe410417_target%20(1).png"></p>
</div><div class="column" style="width:63%;">
<div>
<ul>
<li class="fragment"><p>Take away the <span class="hl-yellow"><strong>fear of programming errors</strong></span> → learn to program by programming</p></li>
<li class="fragment"><p>Understanding <span class="hl-yellow"><strong>basic R concepts</strong></span> from scratch → learning to abstract ideas and algorithms</p></li>
<li class="fragment"><p>Utility of programming → <span class="hl-yellow"><strong>reproducible</strong>, <strong>transparent</strong></span> and maintainable workflows.</p></li>
<li class="fragment"><p>Introduction to <span class="hl-yellow"><strong>analysis and preprocessing</strong></span> of data → <code>{tidyverse}</code>.</p></li>
<li class="fragment"><p>Handling <span class="hl-yellow"><strong>advanced data types</strong></span> → <code>{forcats}</code>, <code>{lubridate}</code> and <code>{purrr}</code> packages</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="evaluation" class="slide level2">
<h2>Evaluation</h2>
<ul>
<li><span class="hl-yellow"><strong>Attendance and individual participation</strong></span> in the class (10%)</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Individual work done during the course</strong></span> (35%). Throughout the course there are <span class="hl-purple"><strong>3 individual task submissions</strong></span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Group work</strong></span> done at the end of the course (30%) (between 2 and 4 people), in which the analysis of a real case must be presented.</li>
</ul>
</div>
</section>
<section id="plannning" class="slide level2">
<h2>Plannning</h2>
<div class="column-screen-inset-right">
<div style="font-size:20px">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">LESSON</th>
<th style="text-align: center;">WEEK</th>
<th style="text-align: center;">DATE</th>
<th style="text-align: center;">TOPIC</th>
<th style="text-align: center;">SCRIPTS</th>
<th style="text-align: center;">EJ.</th>
<th style="text-align: center;">CASO PRÁCTICO</th>
<th style="text-align: center;">ENTREGA</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-1-primeros-pasos">1</a></td>
<td style="text-align: center;">S1</td>
<td style="text-align: center;">14 sep</td>
<td style="text-align: center;">R base programming</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno">💻</a> <a href="#/tu-turno-1">💻</a> <a href="#/tu-turno-1a">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-1">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-2">2</a></td>
<td style="text-align: center;">S2</td>
<td style="text-align: center;">26 sep</td>
<td style="text-align: center;">First databases: tibbles and tidy data</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-tibble">💻</a> <a href="#/tu-turno-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-2">🐣</a> <a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-3">3</a></td>
<td style="text-align: center;">S3</td>
<td style="text-align: center;">28 sep</td>
<td style="text-align: center;">Tidyverse: rows</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-3">💻</a> <a href="#/tu-turno-3a">💻</a> <a href="#/tu-turno-3b">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-4">4</a></td>
<td style="text-align: center;">S4</td>
<td style="text-align: center;">5 oct</td>
<td style="text-align: center;">Tidyverse: columns</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-4a">💻</a> <a href="#/tu-turno-4b">💻</a> <a href="#/tu-turno-4c">💻</a></td>
<td style="text-align: center;"><a href="#/caso4">🐣</a> <a href="#/caso4a">🐣</a> <a href="#/caso4b">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-5">5</a></td>
<td style="text-align: center;">S5</td>
<td style="text-align: center;">10 oct</td>
<td style="text-align: center;">Tidyverse: summarising. Rmarkdown</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-5a">💻</a> <a href="#/tu-turno-5b">💻</a></td>
<td style="text-align: center;"><a href="#/caso5a">🐣</a> <a href="#/caso5b">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-6">6</a></td>
<td style="text-align: center;">S6</td>
<td style="text-align: center;">19 oct</td>
<td style="text-align: center;">Import/export</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-4">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-7">7</a></td>
<td style="text-align: center;">S7</td>
<td style="text-align: center;">24 oct</td>
<td style="text-align: center;">Functions</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-4">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-8">8</a></td>
<td style="text-align: center;">S7</td>
<td style="text-align: center;">26 oct</td>
<td style="text-align: center;">Control flow structures. Factors, lists and strings</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-4">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-9">9</a></td>
<td style="text-align: center;">S10</td>
<td style="text-align: center;">16 nov</td>
<td style="text-align: center;">Joins and SQL</td>
<td style="text-align: center;"><a href="https://github.com/dadosdelaplace/mucss-data-programming/material/scripts">📝</a></td>
<td style="text-align: center;"><a href="#/tu-turno-4">💻</a></td>
<td style="text-align: center;"><a href="#/caso-práctico-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="plannning-1" class="slide level2">
<h2>Plannning</h2>
<ul>
<li><p>Individual Task I (10%): 24th October (R base, databases, tidydata)</p></li>
<li><p>Individual Task II (25%): 5th December (Tidyverse, control flow structures, functions, lists, etc)</p></li>
<li><p>Group Task (30%)</p></li>
</ul>
</section>
<section id="materials" class="slide level2">
<h2>Materials</h2>
<ul>
<li><span class="hl-yellow"><strong>Slides</strong></span>: the slides that we will use in the classroom throughout the course, structured by classes, will be available and updated at <strong><a href="https://javieralvarezliebana.es/mucss-data-programming/slides" class="uri">https://javieralvarezliebana.es/mucss-data-programming/slides</a></strong>.</li>
</ul>
<p>In the slide menu (bottom left) you have an <span class="hl-yellow"><strong>option to download them in pdf</strong></span> under <code>Tools</code> (tip: do not do this until the end of the course as they will be modified).</p>
<p>&nbsp;</p>
<ul>
<li><span class="hl-yellow"><strong>Package summaries</strong></span>: <a href="https://github.com/dadosdelaplace/mucss-data-programming/tree/main/cheatsheets"><strong>package cheatsheets</strong></a> in .pdf format</li>
</ul>
</section></section>
<section>
<section id="clase-1-primeros-pasos" class="title-slide slide level1 center">
<h1>Lesson 1: R base programming</h1>
<p><span style="color:#444442;"><strong>Introduction to R and RStudio ecosystems. Working with projects. First uses of functions and packages. Basic data types.</strong></span></p>
</section>
<section id="requirements" class="slide level2">
<h2>Requirements</h2>
<p>For the course the only requirements will be:</p>
<ol type="1">
<li><p><span class="hl-yellow"><strong>Internet connection</strong></span> (for downloading some data and packages).</p></li>
<li><p><span class="hl-yellow"><strong>Installing R</strong></span><span class="fragment fade-in">: it will be our language. The download will be done (free of charge) from <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a></span></p></li>
</ol>
<div class="fragment fade-in">
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Installing RStudio</strong></span> from <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></li>
</ol>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/cranR.jpg" width="420"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rstudio.jpg" width="420"></p>
</div>
</div>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/gramatica.webp" width="400"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/word.jpg" width="470"></p>
</div>
</div>
<div class="fragment fade-in-then-out">
<p>We will program as we write (English, for example) → <code>R</code> is the <span class="hl-yellow"><strong>language</strong></span></p>
</div>
<div class="fragment fade-up">
<ul>
<li>We will need a <span class="hl-yellow"><strong>grammar</strong></span> (<code>R</code>)</li>
</ul>
<div class="fragment fade-in">
<ul>
<li>And an environment, for example a <span class="hl-yellow"><strong>Word</strong></span> (<code>RStudio</code>), to write it in.</li>
</ul>
</div>
</div>
</section>
<section id="installing-r" class="slide level2">
<h2>Installing R</h2>
<p>The <code>R</code> language will be our <span class="hl-yellow"><strong>grammar and spelling</strong></span> (our rules).</p>
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 1</strong></span>: go to <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a> and select your operating system.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 2</strong></span>: for Mac just click on the <strong>.pkg file</strong>, and open it once downloaded. For Windows systems, click on <strong>install R for the first time</strong> and then on <strong>Download R for Windows</strong>. Once downloaded, open it like any other installation file.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 3</strong></span>: open the installation executable.</p></li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Whenever you download something from CRAN (either R itself or a package), <span class="hl-orange"><strong>make sure you have an internet connection</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-steps" class="slide level2">
<h2>First steps</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>To check that it has been installed correctly, after opening <code>R</code>, you should see a <strong>white screen</strong> similar to this one.</p>
<p>That “white screen” is called <span class="hl-yellow"><strong>console</strong></span> and we can make a first use of it as a <strong>calculator</strong>.</p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/consola.jpg" width="200"></p>
</div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>Idea</strong></span>: let us define a variable called <code>a</code>, and it will be assigned the value <code>1</code> (type the code below in the console and hit “enter”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="first-steps-1" class="slide level2">
<h2>First steps</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>To check that it has been installed correctly, after opening <code>R</code>, you should see a <strong>white screen</strong> similar to this one.</p>
<p>That “white screen” is called <span class="hl-yellow"><strong>console</strong></span> and we can make a first use of it as a <strong>calculator</strong>.</p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/consola.jpg" width="200"></p>
</div>
</div>
<p><span class="hl-yellow"><strong>Idea</strong></span>: we will define another variable called <code>b</code> and assign it the value <code>2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>In <code>R</code> we use <code>&lt;-</code> as an arrow: the variable to the left of the arrow is assigned the value to the right (e.g.&nbsp;<code>a &lt;- 1</code>).</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-steps-2" class="slide level2">
<h2>First steps</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>To check that it has been installed correctly, after opening <code>R</code>, you should see a <strong>white screen</strong> similar to this one.</p>
<p>That “white screen” is called <span class="hl-yellow"><strong>console</strong></span> and we can make a first use of it as a <strong>calculator</strong>.</p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/consola.jpg" width="270"></p>
</div>
</div>
<p><span class="hl-yellow"><strong>Idea</strong></span>: we will do the sum <code>a + b</code> and it will return its result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section>
<section id="installing-r-studio" class="slide level2">
<h2>Installing R Studio</h2>
<p><code>RStudio</code> will be the <span class="hl-yellow"><strong>Word</strong></span> that we will use to write (what is known as an <span class="hl-yellow"><strong>IDE: integrated development environment</strong></span>).</p>
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 1</strong></span>: go to the <a href="https://posit.co/download/rstudio-desktop/">official RStudio website</a> (now called Posit) and select the free download.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 2</strong></span>: select the executable that appears according to your operating system.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 3</strong></span>: after downloading the executable, open it like any other executable and let the installation finish.</p></li>
</ul>
</div>
</section>
<section id="pane-layout-in-rstudio" class="slide level2">
<h2>Pane layout in RStudio</h2>
<p>When you open <code>RStudio</code> you will probably have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Console</strong></span>: this is the name to call the big window that takes up a good part of your screen. Try writing the same code as before (the sum of the variables) in it. The console will be where we will <strong>execute commands and show results</strong>.</li>
</ul>

<img data-src="img/consola_rstudio.jpg" width="420" class="r-stretch"></section>
<section id="pane-layout-in-rstudio-1" class="slide level2">
<h2>Pane layout in RStudio</h2>
<p>When you open <code>RStudio</code> you will probably have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Environment</strong></span>: the small screen (you can adjust the margins) located at the upper right part. It will show us the <strong>variables we have defined</strong>.</li>
</ul>

<img data-src="img/environment.jpg" width="420" class="r-stretch"></section>
<section id="pane-layout-in-rstudio-2" class="slide level2">
<h2>Pane layout in RStudio</h2>
<p>When you open <code>RStudio</code> you will probably have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Multi-purpose panel</strong></span>: the window at the bottom right will not only be used to search for <strong>function help</strong>, but also to <strong>view graphics</strong>.</li>
</ul>

<img data-src="img/multiusos.jpg" width="420" class="r-stretch"></section>
<section id="why-r" class="slide level2">
<h2>Why R?</h2>

<img data-src="img/meme_barco.jpg" class="r-stretch"></section>
<section id="why-r-1" class="slide level2">
<h2>Why R?</h2>
<p><code>R</code> is the <span class="hl-yellow"><strong>main statistical language</strong></span>, created by and for statisticians, with 5 fundamental advantages <span class="hl-red"><strong>over Excel</strong></span>:</p>
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Programming language</strong></span>: obviousness → <span class="hl-purple"><strong>replicable</strong></span> analysis.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Free of charge</strong></span>: the philosophy of the <code>R</code> community is code sharing under <strong>copyleft</strong> → <span class="hl-purple"><strong>ethical use of public money</strong></span></p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Open source</strong></span>: not only is it free but it allows free access to other people’s code, even to <strong>own source code</strong> → <span class="hl-purple"><strong>flexibility and transparency</strong></span></p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Modular language</strong></span>: there are other people’s code that we can reuse (almost 20 000 <span class="hl-yellow"><strong>packages</strong></span>) → <span class="hl-purple"><strong>time-saving</strong></span></p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>High-level language</strong></span></p></li>
</ul>
</div>
</section>
<section id="why-r-2" class="slide level2">
<h2>Why R?</h2>

<img data-src="img/incel_excel.png" class="r-stretch"></section>
<section id="why-programming" class="slide level2">
<h2>Why programming?</h2>
<ul>
<li><p><span class="hl-yellow"><strong>Automate</strong></span> → it will allow you to automate recurring tasks.</p></li>
<li><p><span class="hl-yellow"><strong>Replicability</strong></span> → you will be able to replicate your analysis always in the same way.</p></li>
<li><p><span class="hl-yellow"><strong>Flexibility</strong></span> → you will be able to adapt the software to your needs.</p></li>
<li><p><span class="hl-yellow"><strong>Transparency</strong></span> → it could be audited by the community.</p></li>
</ul>

<img data-src="img/the_general_problem.png" class="r-stretch"></section>
<section id="main-idea-packages" class="slide level2">
<h2>Main idea: packages</h2>
<p>One of the key ideas of <code>R</code> is the <span class="hl-yellow"><strong>use of packages</strong></span>: codes that other people have implemented to <strong>solve a problem</strong>.</p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/paquetes.png"></p>
</div><div class="column" style="width:65%;">
<div class="fragment" data-fragment-index="1">
<ul>
<li><span class="hl-yellow"><strong>Installing</strong></span>: download the codes from the web (internet required) → <span class="hl-purple"><strong>“buy a book”</strong></span>, only once (per computer)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li><span class="hl-yellow"><strong>Loading</strong></span>: after downloading the package, we indicate which packages we want to use each time we open <code>RStudio</code> → <span class="hl-purple"><strong>bring the book off the shelf</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="main-idea-packages-1" class="slide level2">
<h2>Main idea: packages</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/paquetes.png"></p>
</div><div class="column" style="width:65%;">
<p>Once installed, there are two ways to use a package (bring it off the shelf)</p>
<div class="fragment" data-fragment-index="1">
<ul>
<li><span class="hl-yellow"><strong>The whole package</strong></span>: with <code>library()</code>, using the package name without quotes, we load into our session the <span class="hl-purple"><strong>whole book</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li><span class="hl-yellow"><strong>Some particular functions</strong></span> using <code>package::function</code> we indicate that we only want a <span class="hl-purple"><strong>concrete page of that book</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="you-will-be-wrong" class="slide level2">
<h2>You will be wrong</h2>
<p>During your learning process, it is going to be very common that things don’t go right the first time → <span class="hl-yellow"><strong>you will make mistakes</strong></span>. Not only will it be important to assume this, but it is <span class="hl-yellow"><strong>important to read the error messages</strong></span> to learn from them.</p>
<div class="fragment">
<ul>
<li><span class="hl-red"><strong>Error messages</strong></span>: preceded by <strong>“Error in…”</strong> and will be those failures that <span class="hl-red"><strong>prevent execution</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="st">"a"</span> <span class="sc">+</span> <span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "a" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-orange"><strong>Warning messages</strong></span>: preceded by <strong>“Warning in…”</strong> are the most sensitive (possible) failures since they are inconsistencies that <span class="hl-orange"><strong>do not prevent execution</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Code is ok but the result provided a NaN value, **Not A Number**, a value that is not a (real) number</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(-1): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</div>
</section>
<section id="scripts-.r-files" class="slide level2">
<h2>Scripts (.R files)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/abrir_script.jpg" width="350"></p>
</div><div class="column" style="width:65%;">
<p>A <span class="hl-yellow"><strong>script</strong></span> will be the document in which we program, our <code>.doc</code> file (here with <code>.R</code> extension) where we will write the commands. To <strong>open our first script</strong>, click in the menu on <code>File &lt; New File &lt; R Script</code>.</p>
</div>
</div>
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>It is important <strong>not to overuse the console</strong>: everything you do not write in a script, when you close, <span class="hl-orange"><strong>you will have lost it</strong></span>.</p>
</div>
</div>
</div>
</section>
<section id="executing-the-first-script" class="slide level2">
<h2>Executing the first script</h2>
<p>Now we have a <strong>fourth window</strong>: the window where we <span class="hl-yellow"><strong>write our codes</strong></span>. How to run it?</p>
<div class="fragment">
<ol type="1">
<li><strong>We write</strong> the code to execute.</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Save</strong> the .R file by clicking on <code>Save current document</code>.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>The code is not executed unless we tell it to do so. We have three options:</li>
</ol>
<ul>
<li><span class="hl-yellow"><strong>Copy and paste</strong></span> into console.</li>
<li><span class="hl-yellow"><strong>Select lines</strong></span> and <code>Ctrl+Enter</code>.</li>
<li><span class="hl-yellow"><strong>Enable Source on save</strong></span> to the right of save: it not only saves but executes the <strong>whole code</strong>.</li>
</ul>
</div>
</section>
<section id="tu-turno" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Execute your first script</strong>: create a script from scratch, program as indicated below and execute it (in the 3 possible ways)</span></p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-1-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-1-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-1-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-1-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>📝 Define a variable named <code>a</code> and whose value is -1.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2">
<p>📝 Add below another line to define a variable <code>b</code> with value 5. Then multiply both variables.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>a <span class="sc">*</span> b <span class="co"># no saved</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>mult <span class="ot">&lt;-</span> a <span class="sc">*</span> b <span class="co"># saved</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3">
<p>📝 Modify the code below to define two variables c and d, with values 3 and -1. Then split the variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>c <span class="ot">&lt;-</span> <span class="co"># you should assign the value 3</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>d <span class="ot">&lt;-</span> <span class="co"># you should assign the value -1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>c <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>d <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>c <span class="sc">/</span> d <span class="co"># no saved</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>div <span class="ot">&lt;-</span> c <span class="sc">/</span> d <span class="co"># saved</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4">
<p>📝 Assign a positive value to <code>x</code> and calculate its square root; assign another negative <code>y</code> and calculate its absolute value with the <code>abs()</code> function.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">sqrt</span>(x)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="fu">abs</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5">
<p>📝 Using the variable <code>x</code> already defined, complete/modify the code below to store in a new variable <code>z</code> the result stored in <code>x</code> minus 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>z <span class="ot">&lt;-</span> ? <span class="sc">-</span> ? <span class="co"># complete the code</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="dv">5</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>Functions as<code>sqrt()</code>, <code>abs()</code> or <code>max()</code> are what we call <span class="hl-purple"><strong>functions</strong></span>: lines of code that we have “encapsulated” under a name, and given some input arguments, execute the commands (a kind of shortcut).</p>
</div>
</div>
</div>
</section>
<section id="be-organized-projects" class="slide level2">
<h2>Be organized: projects</h2>
<p>In the same way that on the computer we usually work <span class="hl-yellow"><strong>ordered by folders</strong></span>, in <code>RStudio</code> we can do the same to work in <span class="hl-yellow"><strong>efficient way by creating projects</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p>A <span class="hl-yellow"><strong>project will be a “folder”</strong></span> inside <code>RStudio</code>, so our working directory will automatically be the project folder itself (you can switch from one project to another with the top right menu).</p>
<p>We can create one in a new folder or in an existing folder.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rstudio_proyectos.png" width="370"></p>
</div>
</div>
</div>
</section>
<section id="from-the-value-to-the-database" class="slide level2">
<h2>From the VALUE to the DATABASE</h2>
<p>What <span class="hl-yellow"><strong>data type</strong></span> can we have in each cell of a <strong>database</strong>?</p>

<img data-src="img/celdas.jpg" class="r-stretch quarto-figure-center"><div>
<ul>
<li class="fragment"><span class="hl-yellow"><strong>Cell (single value)</strong></span>: single data of a specific type.</li>
<li class="fragment"><span class="hl-yellow"><strong>Variable</strong></span>: <strong>concatenation</strong> of values of the same type (<span class="hl-purple"><strong>vectors</strong></span>).</li>
<li class="fragment"><span class="hl-yellow"><strong>Matrix</strong></span>: concatenation of variables of <strong>same type and length</strong>.</li>
<li class="fragment"><span class="hl-yellow"><strong>Data table</strong></span>: concatenation of variables of <span class="hl-purple"><strong>different type but equal length</strong></span>.</li>
<li class="fragment"><span class="hl-yellow"><strong>List</strong></span>: concatenation of variables of <span class="hl-purple"><strong>different type and different length</strong></span></li>
</ul>
</div>
</section>
<section id="type-of-single-data" class="slide level2">
<h2>Type of (single) data</h2>
<p>Are there <span class="hl-yellow"><strong>variables beyond numbers</strong></span>?</p>
<div class="fragment">
<p>Let us think, for example, of a person’s stored data:</p>
<div class="fragment fade-up">
<ul>
<li>The age or weight will be a <span class="hl-yellow"><strong>numeric variable</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>age <span class="ot">&lt;-</span> <span class="dv">33</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Its name will be a string of <span class="hl-yellow"><strong>text (string or char)</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>name <span class="ot">&lt;-</span> <span class="st">"javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>To the question “Are you single?”, the answer will be what we call as a <span class="hl-yellow"><strong>logical variable</strong></span> (<code>TRUE</code> if you are single or <code>FALSE</code> otherwise).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>single <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Your date of birth will be just that, a <span class="hl-yellow"><strong>date</strong></span>.</li>
</ul>
</div>
</div>
</section>
<section id="numeric-variables" class="slide level2">
<h2>Numeric variables</h2>
<p>The simplest data (we have already used it) will be the <span class="hl-yellow"><strong>numeric variables</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>To know the type of a variable we have the function <code>class()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">class</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>With numeric variables we can perform the <span class="hl-yellow"><strong>arithmetic operations</strong></span> of a calculator: addition (<code>+</code>), square root (<code>sqrt()</code>), square (<code>^2</code>), etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>a<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">abs</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</div>
</section>
<section id="string-variables" class="slide level2">
<h2>String variables</h2>
<p>Let us imagine that, in addition to the age of a person, we want to store his/her name: now the variable will be of type <code>character</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Javier"</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">class</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>Strings variables</strong></span> are a type with which we obviously <span class="hl-red"><strong>cannot perform arithmetic operations</strong></span> (other operations such as pasting or locating patterns can be performed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>name <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in name + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>String variables are <span class="hl-orange"><strong>ALWAYS in quotes</strong></span>: <code>TRUE</code> (logical, binary value) is not the same as <code>"TRUE"</code> (char or string).</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-function-paste" class="slide level2">
<h2>First function: paste</h2>
<p>In <code>R</code> we denote as <span class="hl-yellow"><strong>function</strong></span> a piece of <span class="hl-yellow"><strong>encapsulated code</strong></span> under a name, and which depends on some input <span class="hl-yellow"><strong>arguments</strong></span>. Our first function will be <code>paste()</code>: given two strings, it allows us to paste them together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">paste</span>(<span class="st">"Javier"</span>, <span class="st">"Álvarez"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javier Álvarez"</code></pre>
</div>
</div>
<div class="fragment">
<p>Note that <span class="hl-yellow"><strong>default</strong></span> pastes strings with a space, but we can add an <span class="hl-yellow"><strong>optional argument</strong></span> to tell it the separator (in <code>sep = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">paste</span>(<span class="st">"Javier"</span>, <span class="st">"Álvarez"</span>, <span class="at">sep =</span> <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javier*Álvarez"</code></pre>
</div>
</div>
</div>
</section>
<section id="first-function-paste-1" class="slide level2">
<h2>First function: paste</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/paste_help.jpg"></p>
</div><div class="column" style="width:50%;">
<p>How to know <span class="hl-yellow"><strong>what arguments a function needs</strong></span>? By typing <code>? paste</code> in the console, you will get a <span class="hl-yellow"><strong>help</strong></span> in the multi-purpose panel.</p>
<p>In this help panel, you will see in its header what arguments the function already has <span class="hl-yellow"><strong>default</strong></span> assigned to it.</p>
</div>
</div>
<div class="fragment">
<p>There is a similar function named as <code>paste0()</code> that pastes by default with <code>sep = ""</code> (without anything else).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">paste0</span>(<span class="st">"Javier"</span>, <span class="st">"Álvarez"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JavierÁlvarez"</code></pre>
</div>
</div>
</div>
</section>
<section id="first-package-glue" class="slide level2">
<h2>First package: glue</h2>
<p>A more intuitive way to work with string variables is to use the <code>{glue}</code> package: the first thing to do is to “buy the book” (if we have never done it before). After that <span class="hl-yellow"><strong>load the package</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">install.packages</span>(<span class="st">"glue"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">library</span>(glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="fragment">
<p>This package allows us to use <span class="hl-yellow"><strong>variables inside strings</strong></span>. For example, “I am … years old”, where the age is stored in a variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>age <span class="ot">&lt;-</span> <span class="dv">33</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">glue</span>(<span class="st">"I am {age} years old"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>I am 33 years old</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Inside brackets we can also execute operations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>units <span class="ot">&lt;-</span> <span class="st">"days"</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">glue</span>(<span class="st">"I am {age * 365} {units} old"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>I am 12045 days old</code></pre>
</div>
</div>
</div>
</section>
<section id="logical-conditions" class="slide level2">
<h2>Logical conditions</h2>
<p>Another fundamental type will be the <span class="hl-yellow"><strong>logical or binary or boolean variables</strong></span> (<strong>just two values</strong>):</p>
<ul>
<li><code>TRUE</code>: <span class="hl-yellow"><strong>true</strong></span> stored internally as a 1.</li>
<li><code>FALSE</code>: <span class="hl-yellow"><strong>false</strong></span> stored internally as a 0.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>single <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Are you single? --&gt; YES</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">class</span>(single)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<div class="fragment">
<p>It can take a third value, <code>NA</code> or <span class="hl-yellow"><strong>missing data</strong></span>, the acronym for <em>not available</em>.</p>
</div>
<div class="fragment">
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Logical variables <span class="hl-red"><strong>NOT string variables</strong></span>: <code>"TRUE"</code> is a string, <code>TRUE</code> is a logical value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="st">"TRUE"</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "TRUE" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="logical-conditions-1" class="slide level2">
<h2>Logical conditions</h2>
<p>Logical values are usually the result of <span class="hl-yellow"><strong>evaluate logical conditions</strong></span>. For example, let us imagine we want to check if my name is Javi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>name <span class="ot">&lt;-</span> <span class="st">"María"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>The <span class="hl-yellow"><strong>logical operator</strong></span> <code>==</code> allow us to ask if left equals right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>name <span class="sc">==</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>With its opposite <code>!=</code> we ask if it is different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>name <span class="sc">!=</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>It is not the same <code>&lt;-</code> (<span class="hl-yellow"><strong>assignment</strong></span>) as <code>==</code> (we are <span class="hl-yellow"><strong>asking</strong></span>, it is a logical comparison).</p>
</div>
</div>
</div>
</div>
</section>
<section id="logical-conditions-2" class="slide level2">
<h2>Logical conditions</h2>
<p>In addition to “equal to” versus “different” comparisons, also order comparisons such as <code>&lt;, &lt;=, &gt; or &gt;=</code>.</p>
<p><strong>Is the person less than 32 years old?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>age <span class="ot">&lt;-</span> <span class="dv">38</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>age <span class="sc">&lt;</span> <span class="dv">32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p><strong>Age is greater than or equal to 38 years old?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>age <span class="sc">&gt;=</span> <span class="dv">38</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="date-variables" class="slide level2">
<h2>Date variables</h2>
<p>A very special data type: the <span class="hl-yellow"><strong>date type data</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>date_char <span class="ot">&lt;-</span> <span class="st">"2021-04-21"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>It looks like a simple string but <span class="hl-yellow"><strong>represents an instant in time</strong></span>. What should happen if <span class="hl-purple"><strong>we add a 1 to a date</strong></span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>date_char <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in date_char + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Dates <span class="hl-red"><strong>cannot be string variables</strong></span>: we must convert string variables to date with <code>as_date()</code> from the <code>{lubridate}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb64-2"><a href="#cb64-2"></a>date <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">"2023-03-28"</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a>date <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-29"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">class</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
</div>
</div>
</section>
<section id="date-variables-1" class="slide level2">
<h2>Date variables</h2>
<p>In this package we have very useful functions for <span class="hl-yellow"><strong>handling dates</strong></span>:</p>
<ul>
<li><code>today()</code> allowes to directly obtain the <span class="hl-purple"><strong>current date</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">today</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-16"</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>now()</code> allows to obtain <span class="hl-purple"><strong>current datetime</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">now</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-16 13:17:28 CET"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><code>year()</code>, <code>month()</code> or <code>day()</code> allows us to <span class="hl-purple"><strong>extract year, month and day</strong></span> for a given date.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>date <span class="ot">&lt;-</span> <span class="fu">today</span>()</span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="fu">year</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">month</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
</div>
</section>
<section id="cheatsheets" class="slide level2">
<h2>Cheatsheets</h2>

<img data-src="img/lubridate.png" class="r-stretch"><div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>More documentation</strong></p>
</div>
<div class="callout-content">
<p>You have a pdf summary of the most important packages in the <span class="hl-green"><strong>corresponding folder on campus</strong></span>. See also <a href="https://posit.co/resources/cheatsheets/" class="uri">https://posit.co/resources/cheatsheets/</a></p>
</div>
</div>
</div>
</section>
<section id="tu-turno-1" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-2-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-2-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-2-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<p>📝 Define a variable that stores your age (named as <code>age</code>) and another with your name (named as <code>name</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>age <span class="ot">&lt;-</span> <span class="dv">33</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<p>📝 Define another variable named as <code>siblings</code> that answers the question “do you have siblings?” and another one with the date of your birth (named as <code>birth_date</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>siblings <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb77-4"><a href="#cb77-4"></a>birth_date <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">"1989-09-10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3">
<p>📝 Define another variable with your last names (named as <code>surnames</code>) and use <code>glue()</code> to have a single variable <code>full_name</code> (separating first and last name by a comma).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>surnames <span class="ot">&lt;-</span> <span class="st">"Álvarez Liébana"</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">glue</span>(<span class="st">"{name}, {surnames}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-4">
<p>📝 Compute the days that have passed from the date of your birth until today (with the date of birth defined in exercise 2).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">today</span>() <span class="sc">-</span> birth_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="vectors-concatenate" class="slide level2">
<h2>Vectors: concatenate</h2>
<p>Working with data usually implies having <span class="hl-yellow"><strong>columns that represent variables</strong></span>: we will call <span class="hl-yellow"><strong>vectors</strong></span> a <span class="hl-purple"><strong>concatenation</strong></span> of cells (values) of the <span class="hl-purple"><strong>same type</strong></span>.</p>
<div class="fragment">
<p>The simplest way is using the <code>c()</code> command (c, <strong>concatenate</strong>), and just introduce its <strong>elements between parentheses, and separated by commas</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">60</span>, <span class="dv">61</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33 27 60 61</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>A single number <code>x &lt;- 1</code> (or <code>x &lt;- c(1)</code>) is actually a vector of length one.</p>
</div>
</div>
</div>
</div>
</section>
<section id="vectors-concatenate-1" class="slide level2">
<h2>Vectors: concatenate</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/edades_environment.jpg"></p>
</div><div class="column" style="width:60%;">
<p>As you can see, in the <code>environment</code> area we have now a <strong>collection of elements</strong> saved</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33 27 60 61</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>The <span class="hl-yellow"><strong>length of a vector</strong></span> can be computed with <code>length()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">length</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>We can also <span class="hl-yellow"><strong>concatenate vectors themselves</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">c</span>(age, age, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33 27 60 61 33 27 60 61  8</code></pre>
</div>
</div>
</div>
</section>
<section id="numerical-sequences" class="slide level2">
<h2>Numerical sequences</h2>
<p>Many times we will want to create <span class="hl-yellow"><strong>numeric sequences</strong></span> (for example, the days of the month). The <code>seq(start, end)</code> command allows us to create a <strong>sequence</strong> from a start element to an end element, <span class="hl-purple"><strong>advance one at a time</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">31</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31</code></pre>
</div>
</div>
<div class="fragment">
<p>The command <code>1:n</code> returns the same as <code>seq(1, n)</code> (if the initial element is greater than the final one, it will understand that the sequence is <span class="hl-purple"><strong>decreasing</strong></span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="dv">7</span><span class="sc">:-</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7  6  5  4  3  2  1  0 -1 -2 -3</code></pre>
</div>
</div>
</div>
</section>
<section id="numerical-sequences-1" class="slide level2">
<h2>Numerical sequences</h2>
<p>We can also define <span class="hl-yellow"><strong>other type of discretization step</strong></span> between consecutives</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.5</span>) <span class="co"># from 1 to 7 by step = 0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0</code></pre>
</div>
</div>
<div class="fragment">
<p>In other cases we will be interested in defining a <span class="hl-yellow"><strong>sequence with a specific length</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="at">l =</span> <span class="dv">7</span>) <span class="co"># length 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.000000  9.166667 17.333333 25.500000 33.666667 41.833333 50.000000</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>We may even want to generate a vector of <span class="hl-yellow"><strong>n repeated elements</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0 0 0 0 0</code></pre>
</div>
</div>
</div>
</section>
<section id="vectors-characters" class="slide level2">
<h2>Vectors: characters</h2>
<p>A vector is a <strong>concatenation</strong> of <span class="hl-yellow"><strong>same type</strong></span> elements, but they do not necessarily have to be numerical types. Let us create an example sentence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>sentence <span class="ot">&lt;-</span> <span class="st">"I am Javi"</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>sentence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I am Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">length</span>(sentence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="fragment">
<p>In the previous case it was not a vector, it was a single text element. To create a vector we must use <code>c()</code> again and separate elements with commas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"I"</span>, <span class="st">"am"</span>, <span class="st">"Javi"</span>)</span>
<span id="cb104-2"><a href="#cb104-2"></a>vector</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I"    "am"   "Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">length</span>(vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</section>
<section id="vectors" class="slide level2">
<h2>Vectors</h2>
<p>What will happen if we <span class="hl-yellow"><strong>concatenate elements of different type</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"javi"</span>, <span class="st">"3"</span>, <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"    "2"    "javi" "3"    "TRUE"</code></pre>
</div>
</div>
<p>Notice that since they are all of the same type, what <code>R</code> does is <span class="hl-yellow"><strong>convert</strong></span> everything to character, <span class="hl-red"><strong>violating data integrity</strong></span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 1 0</code></pre>
</div>
</div>
<p>It is important to understand that the logical values are actually <span class="hl-yellow"><strong>stored internally as 0/1</strong></span></p>
</div>
</section>
<section id="operating-with-vectors" class="slide level2">
<h2>Operating with vectors</h2>
<p>With numeric vectors we can do the same <span class="hl-yellow"><strong>arithmetic operations</strong></span> as with numbers → a <span class="hl-purple"><strong>number is a vector</strong></span> (of length one).</p>
<div class="fragment">
<p>What will happen if we <span class="hl-yellow"><strong>add or subtract a value</strong></span> to a vector?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb112-2"><a href="#cb112-2"></a>x <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 4 6 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>x <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  6 10 14</code></pre>
</div>
</div>
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>Unless we indicate otherwise, in <code>R</code> operations with vectors are always <span class="hl-orange"><strong>element to element</strong></span></p>
</div>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-1" class="slide level2">
<h2>Operating with vectors</h2>
<p>Vectors can also interact with each other, so we can define, for example, <span class="hl-yellow"><strong>sums of vectors</strong></span> (element by element)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb116-2"><a href="#cb116-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb116-3"><a href="#cb116-3"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  7 11</code></pre>
</div>
</div>
<div class="fragment">
<p>Since the operation (e.g., a sum) is performed element by element, what will happen if <span class="hl-yellow"><strong>let’s add two vectors of different length</strong></span>?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb118-2"><a href="#cb118-2"></a>x <span class="sc">+</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  7 11  9</code></pre>
</div>
</div>
<p>What it does is <span class="hl-yellow"><strong>recycle elements</strong></span>: if you have a vector of 4 elements and we add another one of 3 elements, it will recycle from the vector with smaller length.</p>
</div>
</section>
<section id="operating-with-vectors-2" class="slide level2">
<h2>Operating with vectors</h2>
<p>A very common operation is to <span class="hl-yellow"><strong>ask data</strong></span> by using <span class="hl-purple"><strong>logical conditions</strong></span>. For example, if we define a vector of temperatures….</p>
<p><span class="hl-yellow"><strong>What days was it less than 22 degrees</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">15</span>, <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>x <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>It will return a <span class="hl-yellow"><strong>logical vector</strong></span>, depending on whether <strong>each element</strong> fulfills or not the requested condition (of <strong>equal length</strong> to the requested vector).</p>
</div>
<div class="fragment">
<p>If we had a <span class="hl-yellow"><strong>missing data</strong></span> (e.g., due to device error that day), the evaluated condition would also be <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="cn">NA</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">7</span>, <span class="dv">29</span>, <span class="dv">10</span>)</span>
<span id="cb123-2"><a href="#cb123-2"></a>y <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE    NA FALSE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-3" class="slide level2">
<h2>Operating with vectors</h2>
<p>Logical <span class="hl-yellow"><strong>conditions can be combined</strong></span> in two ways:</p>
<ul>
<li><span class="hl-yellow"><strong>Intersection</strong></span>: <span class="hl-purple"><strong>all</strong></span> concatenated conditions must be checked (<span class="hl-purple"><strong>conjunction and</strong></span> with <code>&amp;</code>) to return a <code>TRUE</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Union</strong></span>: it is sufficient that <span class="hl-purple"><strong>at least one</strong></span> is fulfilled (<span class="hl-purple"><strong>conjunction or</strong></span> with <code>|</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
</div>
<div class="fragment">
<p><code>any()</code> and <code>all()</code> allow us to check that <span class="hl-yellow"><strong>all (or any) elements</strong></span> meet the following criteria</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">all</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-4" class="slide level2">
<h2>Operating with vectors</h2>
<p>We can also use <span class="hl-yellow"><strong>statistical operations</strong></span> such as <code>sum()</code> which, given a vector, returns the sum of all its elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>What happens when a single value is missing?</strong></span></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>By default, if we have a missing data, the <span class="hl-yellow"><strong>operation will also be missing</strong></span>. In order to <span class="hl-purple"><strong>remove that data</strong></span>, we use an optional argument <code>na.rm = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-5" class="slide level2">
<h2>Operating with vectors</h2>
<p>As we have mentioned, logical values are stored internally as 0 and 1, so we can use them in arithmetic operations.</p>
<p>For example, if we want to <span class="hl-yellow"><strong>find the number of elements that fulfill a condition</strong></span> (for example, “less than 3”), those that do will be assigned a 1 (<code>TRUE</code>) and those that don’t a 0 (<code>FALSE</code>), so we only need to add this logical vector to obtain the number of elements that fulfill a condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="fu">sum</span>(x <span class="sc">&lt;</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="operating-with-vectors-6" class="slide level2">
<h2>Operating with vectors</h2>
<p>Other common operations are <span class="hl-yellow"><strong>average</strong></span>, <span class="hl-yellow"><strong>median</strong></span>, <span class="hl-yellow"><strong>percentiles</strong></span>, etc.</p>
<ul>
<li><span class="hl-yellow"><strong>Average (mean)</strong></span>: centrality measure that consists of adding all the elements and dividing by the number of elements added. The best known but the <span class="hl-red"><strong>least robust</strong></span>: given a set, if outliers (very large or very small values) are introduced, the mean is strongly perturbed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">181</span>, <span class="dv">191</span>, <span class="dv">150</span>, <span class="dv">155</span>, <span class="dv">167</span>, <span class="cn">NA</span>, <span class="dv">173</span>, <span class="dv">177</span>)</span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 169.8889</code></pre>
</div>
</div>
</section>
<section id="operating-with-vectors-7" class="slide level2">
<h2>Operating with vectors</h2>
<p>Other common operations are <span class="hl-yellow"><strong>average</strong></span>, <span class="hl-yellow"><strong>median</strong></span>, <span class="hl-yellow"><strong>percentiles</strong></span>, etc.</p>
<ul>
<li><span class="hl-yellow"><strong>Median</strong></span>: measure of centrality that consists of ordering the elements and keeping the one that occupies the middle.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">181</span>, <span class="dv">191</span>, <span class="dv">150</span>, <span class="dv">155</span>, <span class="dv">167</span>, <span class="dv">173</span>, <span class="dv">177</span>)</span>
<span id="cb143-2"><a href="#cb143-2"></a><span class="fu">median</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Percentiles</strong></span>: measures of location (they divide the data into equal parts).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">quantile</span>(x) <span class="co"># por defecto percentiles 0-25-50-75-100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 150  165  170  177  191 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  10%   40%   90% 
154.0 167.6 183.0 </code></pre>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-8" class="slide level2">
<h2>Operating with vectors</h2>
<p>Another very common operation is to <span class="hl-yellow"><strong>access elements</strong></span> of it. The simplest way is to use the <code>[i]</code> operator (access the i-th element).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="cn">NA</span>, <span class="dv">61</span>) </span>
<span id="cb149-2"><a href="#cb149-2"></a>age[<span class="dv">3</span>] <span class="co"># third position</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
</div>
<div class="fragment">
<p>Since a number is just a vector of length one, this operation can also be applied using a <span class="hl-yellow"><strong>vector of indexes to select</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Hi"</span>, <span class="st">"how"</span>, <span class="st">"are"</span>, <span class="st">"you"</span>, <span class="st">"?"</span>)</span>
<span id="cb151-2"><a href="#cb151-2"></a>y[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>)] <span class="co"># first, second and fourth elemento</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hi"  "how" "you"</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>To access the last one, without worrying about which one, we can pass as index the length <code>x[length(x)]</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-9" class="slide level2">
<h2>Operating with vectors</h2>
<p>Other times we will not want to select but <span class="hl-yellow"><strong>delete some elements</strong></span>. We will have to repeat the same operation but with the sign <code>-</code> in front: the operator <code>[-i]</code> does not select the i-th element of the vector but discards it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hi"  "how" "are" "you" "?"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>y[<span class="sc">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hi"  "are" "you" "?"  </code></pre>
</div>
</div>
<div class="fragment">
<p>Many times we will want to <span class="hl-yellow"><strong>select or eliminate based on logical conditions</strong></span>, depending on the values, so we will pass as index the condition itself (remember, <code>x &lt; 2</code> returns a logical vector).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">45</span>)</span>
<span id="cb157-2"><a href="#cb157-2"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"maría"</span>, <span class="st">"laura"</span>, <span class="st">"carla"</span>, <span class="st">"luis"</span>)</span>
<span id="cb157-3"><a href="#cb157-3"></a>names[age <span class="sc">&lt;</span> <span class="dv">18</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "carla"</code></pre>
</div>
</div>
</div>
</section>
<section id="operating-with-vectors-10" class="slide level2">
<h2>Operating with vectors</h2>
<p>Finally, a common action is to <span class="hl-yellow"><strong>sort values</strong></span>:</p>
<ul>
<li><code>sort()</code>: returns the <span class="hl-yellow"><strong>sorted vector</strong></span>. By default from smallest to largest but with <code>decreasing = TRUE</code> we can change it.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">7</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">65</span>, <span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">23</span>, <span class="dv">77</span>)</span>
<span id="cb159-2"><a href="#cb159-2"></a><span class="fu">sort</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 20 23 25 33 41 65 77 81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="fu">sort</span>(age, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81 77 65 41 33 25 23 20  7</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>order()</code>: returns the <span class="hl-yellow"><strong>index vector</strong></span> that we would have to use to have the sorted vector.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a><span class="fu">order</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 6 1 7 2 8 9 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>x[<span class="fu">order</span>(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150 155 165 167 170 173 177 181 191</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-1a" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-3-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-3-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-3-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-3-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-3-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p>📝 Define the vector <code>x</code> as the concatenation of the first 5 odd numbers, and calculate their sum.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="co"># Two ways</span></span>
<span id="cb167-2"><a href="#cb167-2"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb167-3"><a href="#cb167-3"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb167-4"><a href="#cb167-4"></a></span>
<span id="cb167-5"><a href="#cb167-5"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2">
<p>📝 Get the elements of <code>x</code> greater than 4. Calculate the number of elements of <code>x</code> greater than 4.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">4</span>]</span>
<span id="cb168-2"><a href="#cb168-2"></a><span class="fu">sum</span>(x <span class="sc">&gt;</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3">
<p>📝 Calculate the vector <code>1/x</code> and obtain the ordered version (from smallest to largest).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb169-2"><a href="#cb169-2"></a><span class="fu">sort</span>(z)</span>
<span id="cb169-3"><a href="#cb169-3"></a>z[<span class="fu">order</span>(z)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4">
<p>📝 Find the maximum and minimum of vector <code>x</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="fu">min</span>(x)</span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="fu">max</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-5">
<p>📝 Find of the vector <code>x</code> the elements greater (strictly) than 1 and less (strictly) than 7. Find a way to find out if all the elements are positive or not.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">7</span>]</span>
<span id="cb171-2"><a href="#cb171-2"></a><span class="fu">all</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-6">
<p>📝 Given the vector <code>x &lt;- c(1, -5, 8, NA, 10, -3, 9)</code>, extract the elements that occupy the places 1, 2, 5, 6. Removes from the vector the second element. After removing it, compute its sum and mean</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="cn">NA</span>, <span class="dv">10</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb172-2"><a href="#cb172-2"></a>x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span>
<span id="cb172-3"><a href="#cb172-3"></a>y <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb172-4"><a href="#cb172-4"></a><span class="fu">sum</span>(y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb172-5"><a href="#cb172-5"></a><span class="fu">mean</span>(y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-práctico-1" class="slide level2">
<h2>🐣 Case study</h2>
<p>In the <code>{datasets}</code> package we have several datasets, and one of them is named as <code>airquality</code>. I have extracted below 3 variables from this dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>temperature <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb173-2"><a href="#cb173-2"></a>month <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb173-3"><a href="#cb173-3"></a>day <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>What <span class="hl-yellow"><strong>represents the data</strong></span>? How to find out?</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>How many <span class="hl-yellow"><strong>records do we have for May</strong></span>? What about April? Construct a new <code>date</code> variable with the <span class="hl-yellow"><strong>date</strong></span> of each record (combining year, month and day).</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Create a new variable <code>temp_celsius</code> with the <span class="hl-yellow"><strong>temperature in ºC</strong></span> (units of the original variable are in Fahrenheit)</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>What was the <span class="hl-yellow"><strong>average temperature</strong></span> for the month of August? Extract the days when the <span class="hl-yellow"><strong>temperature exceeded 30 degrees</strong></span> and determine the number of days when it did.</li>
</ol>
</div>
</section></section>
<section>
<section id="clase-2" class="title-slide slide level1 center">
<h1>Lesson 2: first databases</h1>
<p><span style="color:#444442;"><strong>First databases: tibbles as standard type for databases. R base vs tidyverse. Pipe operator. Principles of tidy data: tidy vs messy data. Pivoting datasets</strong></span></p>
</section>
<section id="first-attempt-matrices" class="slide level2">
<h2>First attempt: matrices</h2>
<p>In data science we usually have <span class="hl-yellow"><strong>several variables</strong></span> for each individual: we need a “table” to collect them. The most immediate option is <span class="hl-yellow"><strong>matrices</strong></span>: a concatenation of variables of <span class="hl-purple"><strong>same type and equal length</strong></span>.</p>
<div class="fragment">
<p>Let us imagine that we have heights and weights of 4 people. How to <span class="hl-yellow"><strong>create a dataset with those variables</strong></span>?</p>
<ul>
<li>Function <code>cbind()</code> allow us to <span class="hl-yellow"><strong>concatenate vectors by columns</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>)</span>
<span id="cb174-2"><a href="#cb174-2"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb174-3"><a href="#cb174-3"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(heights, weights)</span>
<span id="cb174-4"><a href="#cb174-4"></a>data_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     heights weights
[1,]     150      63
[2,]     160      70
[3,]     170      85
[4,]     180      95</code></pre>
</div>
</div>
</div>
</section>
<section id="first-attempt-matrices-1" class="slide level2">
<h2>First attempt: matrices</h2>
<ul>
<li>We can also <span class="hl-yellow"><strong>define a matrix by rows</strong></span> with the <code>rbind()</code> function (although it is recommended to have each variable in column and individuals in row).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a><span class="fu">rbind</span>(heights, weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1] [,2] [,3] [,4]
heights  150  160  170  180
weights   63   70   85   95</code></pre>
</div>
</div>
<ul>
<li>We can <span class="hl-yellow"><strong>view the matrix</strong></span> (in a tabular way) using the function <code>View()</code>.</li>
</ul>
<div class="fragment">
<ul>
<li>We can <span class="hl-yellow"><strong>check dimensions</strong></span> with <code>dim()</code>, <code>nrow()</code> and <code>ncol()</code> (data is now tabulated).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a><span class="fu">dim</span>(data_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="fu">nrow</span>(data_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
</section>
<section id="first-attempt-matrices-2" class="slide level2">
<h2>First attempt: matrices</h2>
<ul>
<li>We can also <span class="hl-yellow"><strong>transpose a matrix</strong></span> with <code>t()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">t</span>(data_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1] [,2] [,3] [,4]
heights  150  160  170  180
weights   63   70   85   95</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Since we now have two dimensions, to <span class="hl-yellow"><strong>access elements</strong></span> we must provide the index of the row and column inside of brackets (if they are free, it implies all of that dimension)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>data_matrix[<span class="dv">2</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>heights 
    160 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a>data_matrix[, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 63 70 85 95</code></pre>
</div>
</div>
</div>
</section>
<section id="first-attempt-matrices-3" class="slide level2">
<h2>First attempt: matrices</h2>
<ul>
<li>We can also define a <span class="hl-yellow"><strong>matrix from a numeric vector</strong></span>, reorganizing the values in the form of a matrix (knowing that the elements are <strong>placed by columns</strong>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a>z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">ncol =</span> <span class="dv">5</span>) </span>
<span id="cb188-2"><a href="#cb188-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    4    7   10   13
[2,]    2    5    8   11   14
[3,]    3    6    9   12   15</code></pre>
</div>
</div>
<div class="fragment">
<p>With matrices it is the same as with vectors: when we apply an <span class="hl-yellow"><strong>arithmetic operation, we do it element by element</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>z<span class="sc">/</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]  0.2  0.8  1.4  2.0  2.6
[2,]  0.4  1.0  1.6  2.2  2.8
[3,]  0.6  1.2  1.8  2.4  3.0</code></pre>
</div>
</div>
</div>
</section>
<section id="first-attempt-matrices-4" class="slide level2">
<h2>First attempt: matrices</h2>
<p>We can also apply <span class="hl-yellow"><strong>apply functions by columns/rows</strong></span> (avoiding loops) with <code>apply()</code>, taking as <strong>input arguments</strong></p>
<ul>
<li>a matrix</li>
<li>the sense (<code>MARGIN = 1</code> by rows, <code>MARGIN = 2</code> by columns)</li>
<li>a function to be applied.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a><span class="co"># Mean by columns (MARGIN = 2)</span></span>
<span id="cb192-2"><a href="#cb192-2"></a><span class="fu">apply</span>(data_matrix, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>heights weights 
 165.00   78.25 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a><span class="co"># (Quasi)var (var) by columns (MARGIN = 2)</span></span>
<span id="cb194-2"><a href="#cb194-2"></a><span class="fu">apply</span>(data_matrix, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"var"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> heights  weights 
166.6667 208.9167 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="hl-red"><strong>We won’t go deeper</strong></span> any further since our goal is to have variables of the same length but <span class="hl-yellow"><strong>different types</strong></span> (but know they exist).</p>
</div>
</section>
<section id="tu-turno-matrices" class="slide level2">
<h2>💻 Your turn (matrices)</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-4-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-4-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-4-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<p>📝 Modify the code below to define an <code>x</code> matrix of ones with 3 rows and 7 columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb196-2"><a href="#cb196-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">7</span>)</span>
<span id="cb197-2"><a href="#cb197-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2">
<p>📝 Add a 1 to each number in the matrix above, and divide the result by 5. After that, calculate its transpose and obtain its dimensions</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>new_matrix <span class="ot">&lt;-</span> (x <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb198-2"><a href="#cb198-2"></a><span class="fu">t</span>(new_matrix)</span>
<span id="cb198-3"><a href="#cb198-3"></a><span class="fu">dim</span>(new_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-3">
<p>📝 Define matrix <code>x &lt;- matrix(1:12, nrow = 4)</code>. Get the first row, the third column, and the element (4, 1).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb199-2"><a href="#cb199-2"></a>x[<span class="dv">1</span>, ] <span class="co"># first row</span></span>
<span id="cb199-3"><a href="#cb199-3"></a>x[, <span class="dv">3</span>] <span class="co"># third column</span></span>
<span id="cb199-4"><a href="#cb199-4"></a>x[<span class="dv">4</span>, <span class="dv">1</span>] <span class="co"># element (4, 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-4">
<p>📝 With the above matrix defined as <code>x &lt;- matrix(1:12, nrow = 4)</code>, calculate the mean of all elements, the mean of each row and the mean of each column. Calculate the sum of each row and each column.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb200-2"><a href="#cb200-2"></a><span class="fu">mean</span>(x) <span class="co"># mean (of all elements)</span></span>
<span id="cb200-3"><a href="#cb200-3"></a><span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>) <span class="co"># mean by rows</span></span>
<span id="cb200-4"><a href="#cb200-4"></a><span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>) <span class="co"># mean by columns</span></span>
<span id="cb200-5"><a href="#cb200-5"></a><span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="st">"sum"</span>) <span class="co"># sum by rows</span></span>
<span id="cb200-6"><a href="#cb200-6"></a><span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"sum"</span>) <span class="co"># sum by columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>Matrices have the same problem as vectors: if we collect data of different types together, <span class="hl-red"><strong>data integrity is compromised</strong></span> as it converts them into.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201" data-code-line-numbers="4-5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">24</span>, <span class="cn">NA</span>)</span>
<span id="cb201-2"><a href="#cb201-2"></a>single <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">NA</span>, <span class="cn">FALSE</span>)</span>
<span id="cb201-3"><a href="#cb201-3"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>, <span class="st">"lucía"</span>)</span>
<span id="cb201-4"><a href="#cb201-4"></a>matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ages, single, names)</span>
<span id="cb201-5"><a href="#cb201-5"></a>matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ages single  names  
[1,] "14" "TRUE"  "javi" 
[2,] "24" NA      "laura"
[3,] NA   "FALSE" "lucía"</code></pre>
</div>
</div>
<div class="fragment">
<p>Since we are no longer numbers, we cannot perform arithmetic operations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a>matrix <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in matrix + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame-1" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>In order to work with <span class="hl-yellow"><strong>variables of different type</strong></span> we have what is known as <span class="hl-yellow"><strong>data.frame</strong></span>: concatenation of variables of equal length but may be of <span class="hl-purple"><strong>different type</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ages, single, names)</span>
<span id="cb205-2"><a href="#cb205-2"></a><span class="fu">class</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ages single names
1   14   TRUE  javi
2   24     NA laura
3   NA  FALSE lucía</code></pre>
</div>
</div>
</section>
<section id="second-attempt-data.frame-2" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>Since a <code>data.frame</code> is already a <code>database</code> the variables are not mere mathematical vectors: <span class="hl-yellow"><strong>they have a meaning</strong></span> and we can (must) <span class="hl-purple"><strong>name them</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb209-2"><a href="#cb209-2"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"ags"</span> <span class="ot">=</span> ages, <span class="st">"single"</span> <span class="ot">=</span> single, <span class="st">"name"</span> <span class="ot">=</span> names,</span>
<span id="cb209-3"><a href="#cb209-3"></a>             <span class="st">"b_date"</span> <span class="ot">=</span> <span class="fu">as_date</span>(<span class="fu">c</span>(<span class="st">"1989-09-10"</span>, <span class="st">"1992-04-01"</span>, <span class="st">"1980-11-27"</span>)))</span>
<span id="cb209-4"><a href="#cb209-4"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ags single  name     b_date
1  14   TRUE  javi 1989-09-10
2  24     NA laura 1992-04-01
3  NA  FALSE lucía 1980-11-27</code></pre>
</div>
</div>
</section>
<section id="second-attempt-data.frame-3" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p><span class="hl-yellow"><strong>We have our first dataset!</strong></span> You can view it by typing its name in the console or with <code>View(table)</code>.</p>

<img data-src="img/view_tabla.jpg" class="r-stretch"></section>
<section id="second-attempt-data.frame-4" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>If we want to access its elements, we can, as in matrices (although it is not recommended): now <span class="hl-yellow"><strong>we have two indexes</strong></span> (rows and columns, leaving free the one we don’t use)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a>table[<span class="dv">2</span>, ]  <span class="co"># second row (all variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ags single  name     b_date
2  24     NA laura 1992-04-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a>table[, <span class="dv">3</span>]  <span class="co"># third column (all individuals)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "laura" "lucía"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># first variable for the second individual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="img/menu_data_frame.jpg"></p>
</div><div class="column" style="width:75%;">
<p>It also has advantages of a <span class="hl-yellow"><strong>database</strong></span> : we can <span class="hl-purple"><strong>access variables by name</strong></span> (<strong>recommendable</strong> since variables can change position), putting the name of the table followed by the symbol <code>$</code> (with the <strong>tab</strong>, a menu of columns to choose from will appear).</p>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame-5" class="slide level2">
<h2>Second attempt: data.frame</h2>
<ul>
<li><code>names()</code>: show us the names of the variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a><span class="fu">names</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ags"    "single" "name"   "b_date"</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>dim()</code>: show us the dimensions (see also <code>nrow()</code> and <code>ncol()</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">dim</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>We can access to variables by name</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a>table[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="st">"name"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "lucía"</code></pre>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame-6" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>If we have one already created and we want to <span class="hl-yellow"><strong>add a column</strong></span> it is as simple as using the <code>data.frame()</code> function we have already seen to concatenate the column. Let’s add for example a new variable, the number of siblings of each individual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="co"># Add new column</span></span>
<span id="cb223-2"><a href="#cb223-2"></a>siblings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb223-3"><a href="#cb223-3"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(table, <span class="st">"n_sib"</span> <span class="ot">=</span> siblings)</span>
<span id="cb223-4"><a href="#cb223-4"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ags single  name     b_date n_sib
1  14   TRUE  javi 1989-09-10     0
2  24     NA laura 1992-04-01     2
3  NA  FALSE lucía 1980-11-27     3</code></pre>
</div>
</div>
</section>
<section id="final-attempt-tibble" class="slide level2">
<h2>Final attempt: tibble</h2>
<p>Tables in <code>data.frame</code> format have some <span class="hl-red"><strong>limitations</strong></span></p>
<p>The main one is that <span class="hl-red"><strong>does not allow recursion</strong></span>: imagine we define a database with heights and weights, and we want a third variable with BMI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="fu">data.frame</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb225-2"><a href="#cb225-2"></a>           <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(height = c(1.7, 1.8, 1.6), weight = c(80, 75, 70), : object 'weight' not found</code></pre>
</div>
</div>
<div class="fragment">
<p>From now on we will use the <code>tibble</code> format (an <span class="hl-yellow"><strong>enhanced data.frame</strong></span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb227-2"><a href="#cb227-2"></a><span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb227-3"><a href="#cb227-3"></a>       <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
</div>
</section>
<section id="final-attempt-tibble-1" class="slide level2">
<h2>Final attempt: tibble</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb229-2"><a href="#cb229-2"></a>                <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb229-3"><a href="#cb229-3"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
<p>Tables in <code>tibble</code> format will allow a <span class="hl-yellow"><strong>more agile, efficient and coherent</strong></span> data management, with 4 main advantages:</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Metainfo</strong></span>: if you look at the header, it automatically tells us the number of rows and columns, and the type of each variable.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Recursivity</strong></span>: allows you to define the variables sequentially (as we have seen).</li>
</ul>
</div>
</section>
<section id="final-attempt-tibble-2" class="slide level2">
<h2>Final attempt: tibble</h2>
<ul>
<li><span class="hl-yellow"><strong>Consistency</strong></span>: if you access a column that does not exist, a warning message is issued.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>table<span class="sc">$</span>invent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `invent`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>By rows</strong></span>: create by rows (copy and paste from a table) with <code>tribble()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a><span class="fu">tribble</span>(<span class="sc">~</span>colA, <span class="sc">~</span>colB,</span>
<span id="cb234-2"><a href="#cb234-2"></a>        <span class="st">"a"</span>,   <span class="dv">1</span>,</span>
<span id="cb234-3"><a href="#cb234-3"></a>        <span class="st">"b"</span>,   <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  colA   colB
  &lt;chr&gt; &lt;dbl&gt;
1 a         1
2 b         2</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>{datapasta}</code> package allows us to <span class="hl-green"><strong>copy and paste</strong></span> tables from web pages and simple documents.</p>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-tibble" class="slide level2">
<h2>💻 Your turn (tibble)</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-5-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-5-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-5-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-5-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-5-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>📝 Load from the <code>{datasets}</code> package the <code>airquality</code> dataset (New York air quality variables from May through September 1973). Is the airquality dataset of type tibble? If not, convert it to tibble (look in the package documentation at <a href="https://tibble.tidyverse.org/index.html" class="uri">https://tibble.tidyverse.org/index.html</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb236-2"><a href="#cb236-2"></a><span class="fu">class</span>(datasets<span class="sc">::</span>airquality)</span>
<span id="cb236-3"><a href="#cb236-3"></a>airquality_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(datasets<span class="sc">::</span>airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2">
<p>📝 Once converted into <code>tibble</code> get the name of the variables and the dimensions of the data set. How many variables are there? How many days have been measured?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a><span class="fu">names</span>(airquality_tb)</span>
<span id="cb237-2"><a href="#cb237-2"></a><span class="fu">ncol</span>(airquality_tb)</span>
<span id="cb237-3"><a href="#cb237-3"></a><span class="fu">nrow</span>(airquality_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-3">
<p>📝 Filters only data for the month of August.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">8</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-4">
<p>📝 Select those data that are not from July or August.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>airquality_tb[<span class="sc">!</span>(airquality_tb<span class="sc">$</span>Month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-5">
<p>📝 Modify the following code to keep only the ozone and temperature variables.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1"></a>airquality_tb[, <span class="fu">c</span>(<span class="st">"Ozone"</span>, <span class="st">"Temp"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-6">
<p>📝 Select the temperature and wind data for August. Translate the name of the columns of the filtered set to your motherlanguage.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">8</span>, <span class="fu">c</span>(<span class="st">"Temp"</span>, <span class="st">"Wind"</span>)]</span>
<span id="cb241-2"><a href="#cb241-2"></a><span class="fu">names</span>(airquality_tb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ozono"</span>, <span class="st">"rad_solar"</span>, <span class="st">"viento"</span>, <span class="st">"temp"</span>, <span class="st">"mes"</span>, <span class="st">"dia"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>Each <span class="hl-yellow"><strong>cell can be of a different type</strong></span>: numbers, text, dates, logical values, etc.</li>
</ul>
<div class="fragment">
<ul>
<li>A <span class="hl-yellow"><strong>vector is a concatenation of cells</strong></span> (columns of our tables) –&gt; In <code>R</code> by default the operations are done <span class="hl-yellow"><strong>element by element</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>A <span class="hl-yellow"><strong>matrix</strong></span> allows us to concatenate <span class="hl-yellow"><strong>variables of the SAME type and SAME length</strong></span> –&gt; two-dimensional object (two indices)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>A <span class="hl-yellow"><strong>data.frame</strong></span> allows us to concatenate <span class="hl-yellow"><strong>variables of DIFFERENT type and SAME length</strong></span> –&gt; we will use <span class="hl-yellow"><strong>tibble</strong></span> as an enhanced database option.</li>
</ul>
</div>
</section>
<section id="caso-práctico-2" class="slide level2">
<h2>🐣 Case study</h2>
<p>From the <code>{Biostatistics}</code> package we will use the <code>pinniped</code> data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1"></a>Biostatistics<span class="sc">::</span>pinniped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>What <span class="hl-yellow"><strong>data type</strong></span> does the data represent? What <span class="hl-yellow"><strong>data type</strong></span> is it? If not, convert the database to a <code>tibble</code> (rename with <code>pinniped_tb</code>).</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>How many records are there, and variables, what type is each one?</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Incorporate an <span class="hl-yellow"><strong>extra variable named phoca</strong></span> that is of logical type and check whether a species is of category <code>Phoca</code> or not.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Which sex is <span class="hl-yellow"><strong>weighted more by brain</strong></span>: females or males? Who is <span class="hl-yellow"><strong>weighted more by body</strong></span>: monogamous or polygamous?</li>
</ol>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>Add a new variable representing the <span class="hl-yellow"><strong>difference in brain weight between males and females</strong></span> (males - females) for each species.</li>
</ol>
</div>
</section>
<section id="r-base-vs-tidyverse" class="slide level2">
<h2>R base vs Tidyverse</h2>
<p>If you know any other programming language, you will be surprised that we have not yet talked about common concepts such as</p>
<ul>
<li><p><span class="hl-yellow"><strong>For loops</strong></span>: repeat a code a fixed number of iterations.</p></li>
<li><p><span class="hl-yellow"><strong>while loops</strong></span>: repeat a code until a condition is verified.</p></li>
<li><p><span class="hl-yellow"><strong>if-else structures</strong></span>: control flow structures to decide where the code walks depending on the value of variables.</p></li>
</ul>
<div class="fragment">
<p>And although knowing these structures can be interesting at some point, in <span class="hl-red"><strong>most of the times we will be able to avoid them</strong></span> (specially loops).</p>
</div>
</section>
<section id="what-about-tidyverse" class="slide level2">
<h2>What about tidyverse?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/flow_tidyverse.jpg"></p>
</div>
</div>
<p><code>{tidyverse}</code> is an <span class="hl-yellow"><strong>“universe” of packages</strong></span> to ensure an efficient, coherent and lexicographically simple to understand workflow based on the idea that <span class="hl-purple"><strong>our data is clean and tidy</strong></span></p>
</section>
<section id="what-about-tidyverse-1" class="slide level2">
<h2>What about tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: optimizing data.frame</li>
<li><code>{tidyr}</code>: data cleaning</li>
<li><code>{readr}</code>: loading rectangular data (.csv)</li>
<li><code>{dplyr}</code>: grammar for debugging</li>
<li><code>{stringr}</code>: text handling</li>
<li><code>{ggplot2}</code>: data visualization</li>
<li><code>{tidymodels}</code>: modeling/prediction</li>
</ul>
</div>
</div>
<p>We also have the <code>{purrr}</code> packages for list management, <code>{forcast}</code> for qualitative variables, <code>{lubridate}</code> for dates, <code>{readxl}</code> for importing .xls and .xlsx files, <code>{rvest}</code> for web scraping and <code>{rmarkdown}</code> for reporting results.</p>
</section>
<section id="what-about-tidyverse-2" class="slide level2">
<h2>What about tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizing data.frame</strong></span></li>
<li><code>{tidyr}</code>: <span class="hl-yellow"><strong>data cleaning</strong></span></li>
<li><code>{readr}</code>: loading rectangular data (.csv)</li>
<li><code>{dplyr}</code>: grammar for debugging</li>
<li><code>{stringr}</code>: text handling</li>
<li><code>{ggplot2}</code>: data visualization</li>
<li><code>{tidymodels}</code>: modeling/prediction</li>
</ul>
</div>
</div>
<p>We also have the <code>{purrr}</code> packages for list management, <code>{forcast}</code> for qualitative variables, <code>{lubridate}</code> for dates, <code>{readxl}</code> for importing .xls and .xlsx files, <code>{rvest}</code> for web scraping and <code>{rmarkdown}</code> for reporting results.</p>
</section>
<section id="idea-tidy-data" class="slide level2">
<h2>Idea: Tidy Data</h2>
<blockquote>
<p>Tidy datasets are all alike, but every messy dataset is messy in its own way (Hadley Wickham, Chief Scientist en RStudio)</p>
</blockquote>
<div style="font-size:120px; text-align: center; color:#F8DF58;">
<p><b>TIDY</b><b><span style="color:#CAB0EE;">VERSE</span></b></p>
</div>
<p>The <span class="hl-purple"><strong>universe</strong></span> of <code>{tidyverse}</code> packages is based on the idea introduced by <strong>Hadley Wickham</strong> (the God I pray to) of <span class="hl-yellow"><strong>standardize</strong></span> formatting data to</p>
<div>
<ul>
<li class="fragment"><span class="hl-green"><strong>systematize</strong></span> debugging</li>
<li class="fragment">make it <span class="hl-green"><strong>simpler</strong></span> to manipulate.</li>
<li class="fragment"><span class="hl-green"><strong>readable</strong></span> code.</li>
</ul>
</div>
</section>
<section id="tidy-data-rules" class="slide level2">
<h2>Tidy data: rules</h2>
<p>The first thing will therefore be to understand what the <span class="hl-yellow"><strong>tidydata sets</strong></span> are, since the whole <code>{tidyverse}</code> is based on the data being standardized.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment fade-in">
<ol type="1">
<li>Each <span class="hl-yellow"><strong>variable</strong></span> in a <span class="hl-purple"><strong>single column</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="2" type="1">
<li>Each <span class="hl-yellow"><strong>individual</strong></span> in a <span class="hl-purple"><strong>different row</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="3" type="1">
<li>Each <span class="hl-yellow"><strong>cell</strong></span> with a <span class="hl-purple"><strong>single value</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="4" type="1">
<li>Each <span class="hl-yellow"><strong>dataset</strong></span> in a <span class="hl-purple"><strong>tibble</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="5" type="1">
<li>If we want to cross <span class="hl-yellow"><strong>multiple tables</strong></span> we must have a <span class="hl-purple"><strong>common (key) column</strong></span></li>
</ol>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
</section>
<section id="pipe-operator" class="slide level2">
<h2>Pipe operator</h2>
<p>In <code>{tidyverse}</code> the <span class="hl-yellow"><strong>pipe operator</strong></span>, defined as <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>), will be key: it will be a <span class="hl-yellow"><strong>pipe that traverses the data</strong></span> and transforms it.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>In R base, if we want to apply three functions <code>first()</code>, <code>second()</code> and <code>third()</code> in order, it would be</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a><span class="fu">third</span>(<span class="fu">second</span>(<span class="fu">first</span>(data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p>In <code>{tidyverse}</code> we can <span class="hl-yellow"><strong>read from left to right</strong></span> and separate the data from the actions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1"></a>data <span class="sc">|&gt;</span> <span class="fu">first</span>() <span class="sc">|&gt;</span> <span class="fu">second</span>() <span class="sc">|&gt;</span> <span class="fu">third</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>Since version 4.1.0 of <code>R</code> we have <code>|&gt;</code>, a <strong>native</strong> pipe available <span class="hl-purple"><strong>outside tidyverse</strong></span>, replacing the <span class="hl-red"><strong>old pipe</strong></span> <code>%&gt;%</code> which depended on the <code>{magrittr}</code> package (quite problematic).</p>
</div>
</div>
</div>
</div>
</section>
<section id="pipe-operator-1" class="slide level2">
<h2>Pipe operator</h2>
<p>The main advantage is that the <span class="hl-yellow"><strong>code is very readable (almost literal)</strong></span> and you can do large operations on the data with very little code.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb245-2"><a href="#cb245-2"></a>  <span class="fu">tidy</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-3"><a href="#cb245-3"></a>  <span class="fu">filter</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-4"><a href="#cb245-4"></a>  <span class="fu">select</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-5"><a href="#cb245-5"></a>  <span class="fu">arrange</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-6"><a href="#cb245-6"></a>  <span class="fu">modify</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-7"><a href="#cb245-7"></a>  <span class="fu">rename</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-8"><a href="#cb245-8"></a>  <span class="fu">group</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-9"><a href="#cb245-9"></a>  <span class="fu">count</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-10"><a href="#cb245-10"></a>  <span class="fu">summary</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb245-11"><a href="#cb245-11"></a>  <span class="fu">plot</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img src="img/logo_pipe.png" width="360px">
</center>
</div>
</div>
</section>
<section id="messy-data" class="slide level2">
<h2>Messy data</h2>
<p>But what does the <span class="hl-yellow"><strong>non-tidy data</strong></span> look like? Let’s load the <code>table4a</code> table from the <code>{tidyr}</code> package (we already have it loaded from the tidyverse environment).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb246-2"><a href="#cb246-2"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="pivoting-pivot_longer" class="slide level2">
<h2>Pivoting: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>❎ Each <span class="hl-red"><strong>row represents two observations</strong></span> (1999 and 2000) → columns <code>1999</code> and <code>2000</code> should actually themselves be <span class="hl-yellow"><strong>values of a variable</strong></span> and not column names.</p>
</div>
</div>
<div class="fragment">
<p>We will include a <span class="hl-yellow"><strong>new column</strong></span> that stores the year and another one that stores the value of the variable of interest in each of those years. And we will do it with the <code>pivot_longer()</code> function: <span class="hl-yellow"><strong>pivot the table</strong></span> to long format</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb250-2"><a href="#cb250-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div>
</section>
<section id="pivoting-pivot_longer-1" class="slide level2">
<h2>Pivoting: pivot_longer()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb252-2"><a href="#cb252-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>),</span>
<span id="cb252-3"><a href="#cb252-3"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb252-4"><a href="#cb252-4"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/table4a.jpg"></p>
</div>
</div>
<ul>
<li><code>cols</code>: <span class="hl-yellow"><strong>name of the variables to be pivoted</strong></span></li>
<li><code>names_to</code>: name of the new variable to which we send the <span class="hl-yellow"><strong>header</strong></span> of the table (the names).</li>
<li><code>values_to</code>: name of the new variable to which we are going to send the <span class="hl-yellow"><strong>data</strong></span>.</li>
</ul>
</section>
<section id="messy-data-1" class="slide level2">
<h2>Messy data</h2>
<p>Let us see another example in <code>table2</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="pivoting-pivot_wider" class="slide level2">
<h2>Pivoting: pivot_wider()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Each <span class="hl-red"><strong>observation is divided into two rows</strong></span> → the <span class="hl-yellow"><strong>records with the same year should be the same</strong></span></p>
</div>
</div>
<div class="fragment">
<p>We will do will be the opposite: with <code>pivot_wider()</code> <span class="hl-yellow"><strong>we will widen the table</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a>table2 <span class="sc">|&gt;</span>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="messy-data-2" class="slide level2">
<h2>Messy data</h2>
<p>Let us see another example in <code>table3</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="separate" class="slide level2">
<h2>separate()</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Each <span class="hl-red"><strong>cell contains several values</strong></span></p>
</div>
</div>
<div class="fragment">
<p>What we will do is make use of the <code>separate()</code> function to send <span class="hl-yellow"><strong>separate each value</strong></span> to a different column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="separate-1" class="slide level2">
<h2>separate()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p>Notice that the data, although it has separated them, <span class="hl-red"><strong>kept them as text</strong></span> when in fact they should be numeric variables. For this we can add the optional argument <code>convert = TRUE</code>. . . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>), <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases        pop
  &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</section>
<section id="messy-data-3" class="slide level2">
<h2>Messy data</h2>
<p>Let us see the last example in <code>table5</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="unite" class="slide level2">
<h2>unite()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>❎ We have <span class="hl-red"><strong>same values divided into two columns</strong></span></p>
</div>
</div>
<div class="fragment">
<p>We will use <code>unite()</code> to <span class="hl-yellow"><strong>unite the values</strong></span> of century and year in the same column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a>table5 <span class="sc">|&gt;</span> <span class="fu">unite</span>(<span class="at">col =</span> year_whole, century, year, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year_whole rate             
  &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;            
1 Afghanistan 1999       745/19987071     
2 Afghanistan 2000       2666/20595360    
3 Brazil      1999       37737/172006362  
4 Brazil      2000       80488/174504898  
5 China       1999       212258/1272915272
6 China       2000       213766/1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-2" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-6-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-6-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p>📝 Take a look at table <code>table4b</code> in package <code>{tidyr}</code>. Is it tidydata? If not, what is wrong, how to convert it to tidy data in case it is not already?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1"></a>table4b <span class="sc">|&gt;</span></span>
<span id="cb275-2"><a href="#cb275-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"1999"</span><span class="sc">:</span><span class="st">"2000"</span>, <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb275-3"><a href="#cb275-3"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2">
<p>📝 Take a look at table <code>relig_income</code> in package <code>{tidyr}</code>. Is it tidydata? If not, what is wrong, how to convert it to tidy data in case it is not already?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>relig_income <span class="sc">|&gt;</span></span>
<span id="cb276-2"><a href="#cb276-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"&lt;$10k"</span><span class="sc">:</span><span class="st">"Don't know/refused"</span>,</span>
<span id="cb276-3"><a href="#cb276-3"></a>               <span class="at">names_to =</span> <span class="st">"income"</span>,</span>
<span id="cb276-4"><a href="#cb276-4"></a>               <span class="at">values_to =</span> <span class="st">"people"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-3">
<p>📝 Take a look at table <code>billboard</code> in package <code>{tidyr}</code>. Is it tidydata? If not, what is wrong, how to convert it to tidy data in case it is not already?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>billboard <span class="sc">|&gt;</span></span>
<span id="cb277-2"><a href="#cb277-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"wk1"</span><span class="sc">:</span><span class="st">"wk76"</span>,</span>
<span id="cb277-3"><a href="#cb277-3"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb277-4"><a href="#cb277-4"></a>               <span class="at">names_prefix =</span> <span class="st">"wk"</span>,</span>
<span id="cb277-5"><a href="#cb277-5"></a>               <span class="at">values_to =</span> <span class="st">"position"</span>,</span>
<span id="cb277-6"><a href="#cb277-6"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-práctico-3" class="slide level2">
<h2>🐣 Case study</h2>
<p>In the <code>{tidyr}</code> package we have the <code>who</code> dataset (World Health Organization dataset).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb278-2"><a href="#cb278-2"></a>who</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>What do <span class="hl-yellow"><strong>data</strong></span> mean? How many <span class="hl-yellow"><strong>variables and observations</strong></span> do we have?</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>How many <span class="hl-yellow"><strong>variable types</strong></span> do we have?</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Are all variables necessary? <span class="hl-yellow"><strong>Remove redundant information</strong></span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="hl-yellow"><strong>Convert to tidydata</strong></span> the database by making all the options you consider (tip: use paper to sketch how the database should look like).</li>
</ol>
</div>
</section></section>
<section>
<section id="clase-3" class="title-slide slide level1 center">
<h1>Lesson 3: tidyverse (rows)</h1>
<p><span style="color:#444442;"><strong>Handling data by rows</strong></span></p>
</section>
<section id="what-about-tidyverse-3" class="slide level2">
<h2>What about tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizing data.frame</strong></span></li>
<li><code>{tidyr}</code>: data cleaning</li>
<li><code>{readr}</code>: loading rectangular data (.csv)</li>
<li><code>{dplyr}</code>: <span class="hl-yellow"><strong>grammar for debugging</strong></span></li>
<li><code>{stringr}</code>: text handling</li>
<li><code>{ggplot2}</code>: data visualization</li>
<li><code>{tidymodels}</code>: modeling/prediction</li>
</ul>
</div>
</div>
<p>We also have the <code>{purrr}</code> packages for list management, <code>{forcast}</code> for qualitative variables, <code>{lubridate}</code> for dates, <code>{readxl}</code> for importing .xls and .xlsx files, <code>{rvest}</code> for web scraping and <code>{rmarkdown}</code> for reporting results.</p>
</section>
<section id="preprocessing-dplyr" class="slide level2">
<h2>Preprocessing: dplyr</h2>
<p>Within <code>{tidyverse}</code>, we will use the <code>{dplyr}</code> package for the <span class="hl-yellow"><strong>preprocessing and debugging</strong></span> of databases.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>All the debugging process that we are going to perform is on the <span class="hl-yellow"><strong>assumption that our data is in tidydata format</strong></span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
<p>Remember that in <code>{tidyverse}</code> the <span class="hl-yellow"><strong>pipe operator</strong></span> defined as <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>) will be crucial: it will be a <span class="hl-yellow"><strong>pipe that traverses the data</strong></span> and transforms it.</p>
<div class="fragment">
<p>Let’s practice with the <code>starwars</code> dataset from the loaded <code>{dplyr}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb279-2"><a href="#cb279-2"></a>starwars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="sampling" class="slide level2">
<h2>Sampling</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>One of the most common operations is what is known in statistics as <span class="hl-yellow"><strong>sampling</strong></span>: a <span class="hl-yellow"><strong>selection or filtering of records</strong></span> (a subsample).</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/muestreo.jpeg" width="500"></p>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Non-random (by quotas)</strong></span>: based on logical conditions on the records (<code>filter()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Non-random (intentional/discretionary)</strong></span>: in terms of position (<code>slice()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Simple random</strong></span> (<code>slice_sample()</code>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Stratified simple sampling</strong></span> (<code>group_by()</code> + <code>slice_sample()</code>)</li>
</ul>
</div>
</section>
<section id="filtering-filter" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb280-2"><a href="#cb280-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb281-2"><a href="#cb281-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The simplest one is when <span class="hl-yellow"><strong>filter records</strong></span> based on some logical condition: with <code>filter()</code> only individuals that verify certain conditions will be selected (non-random sampling by conditions).</p>
<div>
<ul>
<li class="fragment"><code>==</code>, <code>!=</code>: <span class="hl-purple"><strong>equal</strong></span> or <span class="hl-yellow"><strong>different</strong></span> to (<code>|&gt; filter(variable == "a")</code>)</li>
<li class="fragment"><code>&gt;</code>, <code>&lt;</code>: <span class="hl-purple"><strong>greater</strong></span> or <span class="hl-yellow"><strong>less</strong></span> than (<code>|&gt; filter(variable &lt; 3)</code>)</li>
<li class="fragment"><code>&gt;=</code>, <code>&lt;=</code>: <span class="hl-yellow"><strong>greater or equal</strong></span> or <span class="hl-purple"><strong>less or equal</strong></span> to (<code>|&gt; filter(variable &gt;= 5)</code>)</li>
<li class="fragment"><code>%in%</code>: values <span class="hl-yellow"><strong>belong</strong></span> to a valid set of options (<code>|&gt; filter(variable %in% c("blue", "green"))</code>)</li>
<li class="fragment"><code>between(variable, val1, val2)</code>: if continuous numerical values are <span class="hl-yellow"><strong>within a range</strong></span> (<code>|&gt; filter(between(variable, 160, 180))</code>)</li>
</ul>
</div>
</section>
<section id="filtering-filter-1" class="slide level2">
<h2>Filtering: filter()</h2>
<p>These <span class="hl-yellow"><strong>logical conditions</strong></span> can be <span class="hl-yellow"><strong>combined</strong></span> in different ways (and, or, or mutually exclusive).</p>

<img data-src="img/tablas_verdad.png" class="r-stretch"><div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Remember that inside <code>filter()</code> there must always be something that returns a <span class="hl-green"><strong>vector of logical values</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="filtering-filter-2" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb282-2"><a href="#cb282-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb283-2"><a href="#cb283-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters with <span class="hl-purple"><strong>brown eyes</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>What kind of variable is it?</strong></span> –&gt; The variable <code>eye_color</code> is qualitative so it is represented by texts. . . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb284-2"><a href="#cb284-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Leia Or…    150  49   brown      light      brown           19   fema… femin…
 2 Biggs D…    183  84   black      light      brown           24   male  mascu…
 3 Han Solo    180  80   brown      fair       brown           29   male  mascu…
 4 Yoda         66  17   white      green      brown          896   male  mascu…
 5 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…
 6 Lando C…    177  79   black      dark       brown           31   male  mascu…
 7 Arvel C…     NA  NA   brown      fair       brown           NA   male  mascu…
 8 Wicket …     88  20   brown      brown      brown            8   male  mascu…
 9 Quarsh …    183  NA   black      dark       brown           62   &lt;NA&gt;  &lt;NA&gt;  
10 Shmi Sk…    163  NA   black      fair       brown           72   fema… femin…
# ℹ 11 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtering-filter-3" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb286-2"><a href="#cb286-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb287-2"><a href="#cb287-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters without <span class="hl-purple"><strong>brown eyes</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb288-2"><a href="#cb288-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">!=</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 6 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 7 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 8 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
 9 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
10 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
# ℹ 56 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtering-filter-4" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb290-2"><a href="#cb290-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb291-2"><a href="#cb291-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters with <span class="hl-purple"><strong>brown or blue eyes</strong></span>? . . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb292-2"><a href="#cb292-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"brown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   male  mascu…
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="filtering-filter-5" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb294-2"><a href="#cb294-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb295-2"><a href="#cb295-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Note that <code>%in%</code> is equivalent to concatenating several <code>==</code> with a conjunction or (<code>|</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb296-2"><a href="#cb296-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">|</span> eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   male  mascu…
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="filtering-filter-6" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb298-2"><a href="#cb298-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb299-2"><a href="#cb299-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters <span class="hl-purple"><strong>are between 120 and 160 cm</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>What type of variable is it?</strong></span> –&gt; The variable <code>height</code> is a continuous quantitative variable so we must filter by ranges of values (intervals) –&gt; we will use <code>between()</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb300-2"><a href="#cb300-2"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">160</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Leia Org…    150    49 brown      light      brown             19 fema… femin…
2 Mon Moth…    150    NA auburn     fair       blue              48 fema… femin…
3 Nien Nunb    160    68 none       grey       black             NA male  mascu…
4 Watto        137    NA black      blue, grey yellow            NA male  mascu…
5 Gasgano      122    NA none       white, bl… black             NA male  mascu…
6 Cordé        157    NA brown      light      brown             NA fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtering-filter-7" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb302-2"><a href="#cb302-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb303-2"><a href="#cb303-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you… <span class="hl-yellow"><strong>filter</strong></span> characters that <span class="hl-purple"><strong>have brown eyes and are not human</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb304-2"><a href="#cb304-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Human"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yoda          66    17 white      green      brown            896 male  mascu…
2 Wicket S…     88    20 brown      brown      brown              8 male  mascu…
3 Eeth Koth    171    NA black      brown      brown             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filtering-filter-8" class="slide level2">
<h2>Filtering: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb306-2"><a href="#cb306-2"></a>  <span class="fu">filtro</span>(condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb307-2"><a href="#cb307-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you… <span class="hl-yellow"><strong>filter</strong></span> characters that <span class="hl-purple"><strong>have eyes and are not human, or are over 60 years old</strong></span>? Think it through: the <span class="hl-yellow"><strong>parentheses are important</strong></span>: <span class="math inline">\((a+b)*c\)</span> is not the same as <span class="math inline">\(a+(b*c)\)</span>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb308-2"><a href="#cb308-2"></a>  <span class="fu">filter</span>((eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Human"</span>) <span class="sc">|</span> birth_year <span class="sc">&gt;</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 C-3PO       167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
 2 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…
 3 Chewbac…    228   112 brown      unknown    blue             200 male  mascu…
 4 Jabba D…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
 5 Yoda         66    17 white      green      brown            896 male  mascu…
 6 Palpati…    170    75 grey       pale       yellow            82 male  mascu…
 7 Wicket …     88    20 brown      brown      brown              8 male  mascu…
 8 Qui-Gon…    193    89 brown      fair       blue              92 male  mascu…
 9 Finis V…    170    NA blond      fair       blue              91 male  mascu…
10 Quarsh …    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
11 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
12 Mace Wi…    188    84 none       dark       brown             72 male  mascu…
13 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…
14 Eeth Ko…    171    NA black      brown      brown             NA male  mascu…
15 Cliegg …    183    NA brown      fair       blue              82 male  mascu…
16 Dooku       193    80 white      fair       brown            102 male  mascu…
17 Bail Pr…    191    NA black      tan        brown             67 male  mascu…
18 Jango F…    183    79 black      tan        brown             66 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="drop-missing-drop_na" class="slide level2">
<h2>Drop missing: drop_na()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb310-2"><a href="#cb310-2"></a>  <span class="fu">retirar_ausentes</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb311-2"><a href="#cb311-2"></a>  <span class="fu">drop_na</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>There is a special filter for one of the most common operations in debugging: <span class="hl-yellow"><strong>remove absent</strong></span>. For this we can use inside a filter <code>is.na()</code>, which returns <code>TRUE/FALSE</code> depending on whether it is absent, or ….</p>
<div class="fragment">
<p>Use <code>drop_na()</code>: if no variable is specified, it removes records with absent in any variable. Later we will see how to <span class="hl-yellow"><strong>impute those missing ones</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb312-2"><a href="#cb312-2"></a>  <span class="fu">drop_na</span>(mass, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color 
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;      
1 Luke Skywalker        77    172 blond      
2 C-3PO                 75    167 &lt;NA&gt;       
3 R2-D2                 32     96 &lt;NA&gt;       
4 Darth Vader          136    202 none       
5 Leia Organa           49    150 brown      
6 Owen Lars            120    178 brown, grey
7 Beru Whitesun lars    75    165 brown      </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb314-2"><a href="#cb314-2"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color   
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;        
1 Luke Skywalker        77    172 blond        
2 Darth Vader          136    202 none         
3 Leia Organa           49    150 brown        
4 Owen Lars            120    178 brown, grey  
5 Beru Whitesun lars    75    165 brown        
6 Biggs Darklighter     84    183 black        
7 Obi-Wan Kenobi        77    182 auburn, white</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-3" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-7-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-7-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-7-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-7-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<p>📝 Select from the starwars dataset only those characters that are androids or whose <code>species</code> value is unknown.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb316-2"><a href="#cb316-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span> <span class="sc">|</span> <span class="fu">is.na</span>(species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-2">
<p>📝 Select from the starwars dataset only the characters whose weight is between 65 and 90 kg.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">between</span>(mass, <span class="dv">65</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-3">
<p>📝 After clearing missing data in all variables, select from the starwars dataset only the characters that are human and come from Tatooine.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb318-2"><a href="#cb318-2"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb318-3"><a href="#cb318-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> homeworld <span class="sc">==</span> <span class="st">"Tatooine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-4">
<p>📝 Select, from the original starwars dataset, non-human characters, <code>male</code> in sex and measuring between 120 and 170 cm, or characters with brown or red eyes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb319-2"><a href="#cb319-2"></a>  <span class="fu">filter</span>((species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">"male"</span> <span class="sc">&amp;</span></span>
<span id="cb319-3"><a href="#cb319-3"></a>            <span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">170</span>)) <span class="sc">|</span></span>
<span id="cb319-4"><a href="#cb319-4"></a>           eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"brown"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-7-5">
<p>📝 Check information about the <code>str_detect()</code> function (<code>{stringr}</code> package loaded in <code>{tidyverse}</code>). Tip: test the functions you are going to use with some test vector beforehand so that you can check how they work. After you know what it does, filter out only those characters with the last name <code>Skywalker</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">"Skywalker"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="slice-of-data-slice" class="slide level2">
<h2>Slice of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we may be interested in performing a <span class="hl-yellow"><strong>non-random discretionary sampling</strong></span>, or in other words, <span class="hl-yellow"><strong>filter by position</strong></span>: with <code>slice(positions)</code> we can select specific rows by passing as argument a <span class="hl-yellow"><strong>index vector</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a><span class="co"># fila 1</span></span>
<span id="cb323-2"><a href="#cb323-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb323-3"><a href="#cb323-3"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a><span class="co"># filas de la 7 a la 9</span></span>
<span id="cb325-2"><a href="#cb325-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb325-3"><a href="#cb325-3"></a>  <span class="fu">slice</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name               height  mass hair_color
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Beru Whitesun lars    165    75 brown     
2 R5-D4                  97    32 &lt;NA&gt;      
3 Biggs Darklighter     183    84 black     </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1"></a><span class="co"># filas 2, 7, 10 y 31</span></span>
<span id="cb327-2"><a href="#cb327-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb327-3"><a href="#cb327-3"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">31</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  name             height  mass hair_color skin_color eye_color birth_year sex  
  &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1 C-3PO               167    75 &lt;NA&gt;       gold       yellow           112 none 
2 Beru Whitesun l…    165    75 brown      light      blue              47 fema…
3 Obi-Wan Kenobi      182    77 auburn, w… fair       blue-gray         57 male 
4 Qui-Gon Jinn        193    89 brown      fair       blue              92 male </code></pre>
</div>
</div>
</div>
</section>
<section id="slice-of-data-slice-1" class="slide level2">
<h2>Slice of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb329-2"><a href="#cb329-2"></a>  <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb330-2"><a href="#cb330-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have some default options:</p>
<ul>
<li>with <code>slice_head(n = ...)</code> and <code>slice_tail(n = ...)</code> we can get the <span class="hl-yellow"><strong>header and tail</strong></span> of the table.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     
2 C-3PO             167    75 &lt;NA&gt;      </code></pre>
</div>
</div>
</div><div class="column" style="width:&quot;50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Captain Phasma     NA    NA unknown   
2 Padmé Amidala     165    45 brown     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="slice-of-data-slice-2" class="slide level2">
<h2>Slice of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb335-2"><a href="#cb335-2"></a>  <span class="fu">rebanadas</span>(posiciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb336-2"><a href="#cb336-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have some default options:</p>
<ul>
<li>with <code>slice_max()</code> and <code>slice_min()</code> we get the <span class="hl-yellow"><strong>rows with smallest/largest value of a variable</strong></span> (if tie, all unless <code>with_ties = FALSE</code>) that we indicate in <code>order_by = ...</code>.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(mass, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name          height  mass hair_color
  &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Ratts Tyerell     79    15 none      
2 Yoda              66    17 white     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name        height  mass hair_color
  &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Yarael Poof    264    NA none      
2 Tarfful        234   136 brown     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="random-slices-slice_sample" class="slide level2">
<h2>Random slices: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb341-2"><a href="#cb341-2"></a>  <span class="fu">rebanadas_aleatorias</span>(tamaño_muestral)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb342-2"><a href="#cb342-2"></a>  <span class="fu">slice_sample</span>(sample_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The so-called <span class="hl-yellow"><strong>simple random sampling</strong></span> is based on <span class="hl-yellow"><strong>selecting individuals randomly</strong></span>, so that each one has certain <span class="hl-yellow"><strong>probabilities</strong></span> of being selected. With <code>slice_sample(n = ...)</code> we can randomly extract n (a priori equiprobable) records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Lando Ca…    177    79 black      dark       brown             31 male  mascu…
2 Darth Ma…    175    80 none       red        yellow            54 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><span class="hl-yellow"><strong>«Randomness» does not imply equiprobable</strong></span>: a normal die is just as random as a trick die. There are no things “more random” than others, they simply have different underlying probability laws.</p>
</div>
</div>
</div>
</div>
</section>
<section id="random-slices-slice_sample-1" class="slide level2">
<h2>Random slices: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb345-2"><a href="#cb345-2"></a>  <span class="fu">rebanadas_aleatorias</span>(tamaño_muestral)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb346-2"><a href="#cb346-2"></a>  <span class="fu">slice_sample</span>(sample_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also indicate the <span class="hl-yellow"><strong>proportion of data to be sampled</strong></span> (instead of the number) and if we want it to be <span class="hl-yellow"><strong>with replacement (that can be repeated)</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1"></a><span class="co"># 5% de registros aleatorios con reemplazamiento</span></span>
<span id="cb347-2"><a href="#cb347-2"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb347-3"><a href="#cb347-3"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.05</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Wilhuff …    180    NA auburn, g… fair       blue              64 male  mascu…
2 Sebulba      112    40 none       grey, red  orange            NA male  mascu…
3 Ackbar       180    83 none       brown mot… orange            41 male  mascu…
4 Finn          NA    NA black      dark       dark              NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="random-slices-slice_sample-2" class="slide level2">
<h2>Random slices: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb349-2"><a href="#cb349-2"></a>  <span class="fu">rebanadas_aleatorias</span>(tamaño_muestral)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb350-2"><a href="#cb350-2"></a>  <span class="fu">slice_sample</span>(sample_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>As we said, “random” is not the same as “equiprobable”, so we can pass a <span class="hl-yellow"><strong>probability vector</strong></span>. For example, let’s force that it is very improbable to draw a row other than the first two rows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb351-2"><a href="#cb351-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb353-2"><a href="#cb353-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
2 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="a-parenthesis-sample" class="slide level2">
<h2>A parenthesis: sample()</h2>
<p>The <code>slice_sample()</code> function is simply a <code>{tidyverse}</code> integration of the basic <code>R</code> function known as <code>sample()</code> that allows us to <span class="hl-yellow"><strong>sample elements</strong></span></p>
<div class="fragment">
<p>For example, we are going to <span class="hl-yellow"><strong>sample 10 rolls of a die</strong></span>, indicating to it.</p>
<ul>
<li><span class="hl-purple"><strong>support</strong></span> of our random variable (values allowed in <code>x</code>)</li>
<li><span class="hl-purple"><strong>size</strong></span> sample (<code>size</code>)</li>
<li><span class="hl-purple"><strong>replacement</strong></span> (if <code>TRUE</code> then it can come out repeated, as in the case of the die)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 2 6 4 5 1 4 2 5</code></pre>
</div>
</div>
</div>
</section>
<section id="a-parenthesis-sample-1" class="slide level2">
<h2>A parenthesis: sample()</h2>
<p>The previous option generates events of a random variable <span class="hl-yellow"><strong>equiprobable</strong></span> but as before, we can assign a vector of probabilities or <span class="hl-yellow"><strong>mass function</strong></span> to it with the argument <code>prob = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb357-2"><a href="#cb357-2"></a>       <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 5 1 1 1 1 1 1 1 1 5 2 3 1 1 1 2 1 1 3 1 1 6 1 1 2 2 1 1 2 1 1 1 1 1 1 1
[39] 1 2 1 2 1 1 1 1 1 2 5 1</code></pre>
</div>
</div>
</section>
<section id="a-parenthesis-sample-2" class="slide level2">
<h2>A parenthesis: sample()</h2>
<p><strong>How would you make the following statement?</strong></p>
<p>&nbsp;</p>
<p>Supongamos que en una ciudad se han estudiado los perfiles de votantes en parejas heterosexuales. Sean las variables aleatorias <span class="math inline">\(X_m\)</span> y <span class="math inline">\(X_h\)</span> tal que <span class="math inline">\(X_m=1\)</span> si una vota a un partido X, <span class="math inline">\(X_m=0\)</span> si no, <span class="math inline">\(X_h=1\)</span> si un hombre vota a un partido X y <span class="math inline">\(X_p=0\)</span> si no. El modelo teórico asociado a este tipo de electorado indica que la distribución conjunta viene dada por <span class="math inline">\(P(X_m = 1, X_h=1)=0.02\)</span>, <span class="math inline">\(P(X_m = 1, X_h=0)=0.08\)</span>, <span class="math inline">\(P(X_m = 1, X_h=0)=0.1\)</span> y <span class="math inline">\(P(X_m = 0, X_h=0)=0.8\)</span></p>
<p><strong>Generates a sample</strong> of size <span class="math inline">\(n = 1000\)</span> (support <code>"10"</code>, <code>"01"</code>, <code>"00"</code> and <code>"11"</code>) using <code>sample()</code>.</p>
</section>
<section id="tu-turno-3a" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-8-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-8-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-8-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-8-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<p>📝 Select only the characters that are human and brown-eyed, then sort them in descending height and ascending weight.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb359-2"><a href="#cb359-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Human"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb359-3"><a href="#cb359-3"></a>  <span class="fu">arrange</span>(height, <span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2">
<p>📝 Randomly extract 3 rows.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-3">
<p>📝 Sampling (randomly) 10% of data.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-4">
<p>📝 Randomly draws 10 characters but in such a way that the probability of each character being drawn is proportional to its weight (heavier, more likely).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb362-2"><a href="#cb362-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb362-3"><a href="#cb362-3"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">weight_by =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-5">
<p>📝 Select the 3 oldest characters.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(birth_year, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="rearrange-rows-arrange" class="slide level2">
<h2>Rearrange rows: arrange()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">ordenar</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also <span class="hl-yellow"><strong>order rows</strong></span> according to some variable with <code>arrange()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  name                  height  mass hair_color skin_color  eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Ratts Tyerell             79    15 none       grey, blue  unknown  
2 Yoda                      66    17 white      green       brown    
3 Wicket Systri Warrick     88    20 brown      brown       brown    
4 R2-D2                     96    32 &lt;NA&gt;       white, blue red      
5 R5-D4                     97    32 &lt;NA&gt;       white, red  red      </code></pre>
</div>
</div>
<div class="fragment">
<p>By default, arranging is done <span class="hl-yellow"><strong>from lowest to highest</strong></span> but we can <span class="hl-purple"><strong>reverse the order</strong></span> with <code>desc()</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name         height  mass
  &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt;
1 Yarael Poof     264    NA
2 Tarfful         234   136
3 Lama Su         229    88
4 Chewbacca       228   112
5 Roos Tarpals    224    82</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass, <span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name                  height  mass
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt;
1 Ratts Tyerell             79    15
2 Yoda                      66    17
3 Wicket Systri Warrick     88    20
4 R5-D4                     97    32
5 R2-D2                     96    32</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="remove-duplicates-distinct" class="slide level2">
<h2>Remove duplicates: distinct()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">sin_duplicados</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Many times we will need to make sure that there are no duplicates in some variable (DNI) and we can <span class="hl-yellow"><strong>delete duplicate rows</strong></span> with <code>distinct()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  sex           
  &lt;chr&gt;         
1 male          
2 none          
3 female        
4 hermaphroditic
5 &lt;NA&gt;          </code></pre>
</div>
</div>
<div class="fragment">
<p>To keep all variables we will use <code>.keep_all = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
3 Leia Org…    150    49 brown      light      brown             19 fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="add-rows-bind_rows" class="slide level2">
<h2>Add rows: bind_rows()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">encuadernar_filas</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally, we can <span class="hl-yellow"><strong>bind new rows</strong></span> with <code>bind_rows()</code> with <span class="hl-red"><strong>new observations in table</strong></span> (if columns do not match fill with missing data)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1"></a>datos <span class="ot">&lt;-</span></span>
<span id="cb380-2"><a href="#cb380-2"></a>  <span class="fu">tibble</span>(<span class="st">"names"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>), <span class="st">"ages"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">50</span>))</span>
<span id="cb380-3"><a href="#cb380-3"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  names  ages
  &lt;chr&gt; &lt;dbl&gt;
1 javi     33
2 laura    50</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="st">"names"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"carlos"</span>, <span class="cn">NA</span>), <span class="st">"zip"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">28045</span>, <span class="dv">28019</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  names   ages   zip
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 javi      33    NA
2 laura     50    NA
3 carlos    NA 28045
4 &lt;NA&gt;      NA 28019</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-3b" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-9-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<p>📝 To find out what unique values are in the hair color, remove duplicates of the <code>hair_color</code> variable by first removing the missing ones from the <code>hair_color</code> variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb384-2"><a href="#cb384-2"></a>  <span class="fu">drop_na</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb384-3"><a href="#cb384-3"></a>  <span class="fu">distinct</span>(hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2">
<p>📝 Just considering the characters that are human and taller than 160 cm, eliminate duplicates in eye color, eliminate missing data in weight, select the 3 tallest, and order from tallest to shortest in weight. Return the table.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb385-2"><a href="#cb385-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">|&gt;</span> </span>
<span id="cb385-3"><a href="#cb385-3"></a>  <span class="fu">distinct</span>(eye_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb385-4"><a href="#cb385-4"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb385-5"><a href="#cb385-5"></a>  <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb385-6"><a href="#cb385-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="in-summary" class="slide level2">
<h2>In summary</h2>
<p>The key to <code>{tidyverse}</code> is the <span class="hl-yellow"><strong>legibility</strong></span>: it is very important that the code is understood, for our future self but also for the <span class="hl-yellow"><strong>algorithmic transparency</strong></span> towards the others</p>
<p><span class="hl-purple"><strong>For example</strong></span>: we will remove absent from the weight variable, we will filter the human characters and height higher than 140cm, without duplicates in the hair color, extracting the 5 tallest and obtaining 2 random characters finally.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb386-2"><a href="#cb386-2"></a>  <span class="fu">elimino_ausentes</span>(peso) <span class="sc">|&gt;</span> </span>
<span id="cb386-3"><a href="#cb386-3"></a>  <span class="fu">filtro</span>(especie humana Y altura <span class="sc">&gt;</span> <span class="dv">140</span> cm) <span class="sc">|&gt;</span> </span>
<span id="cb386-4"><a href="#cb386-4"></a>  <span class="fu">sin_duplicados</span>(color de pelo) <span class="sc">|&gt;</span></span>
<span id="cb386-5"><a href="#cb386-5"></a>  <span class="fu">rebanadas_max</span>(peso, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb386-6"><a href="#cb386-6"></a>  <span class="fu">rebanadas_aleatorias</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb387-2"><a href="#cb387-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb387-3"><a href="#cb387-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">140</span>) <span class="sc">|&gt;</span> </span>
<span id="cb387-4"><a href="#cb387-4"></a>  <span class="fu">distinct</span>(hair_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb387-5"><a href="#cb387-5"></a>  <span class="fu">slice_max</span>(mass, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb387-6"><a href="#cb387-6"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="caso-práctico-3" class="slide level2">
<h2>🐣 Case study</h2>
<p>We are going to use the <code>biopsy</code> dataset that can be found in the dataset aggregator <a href="https://vincentarelbundock.github.io/Rdatasets/index.html" class="uri">https://vincentarelbundock.github.io/Rdatasets/index.html</a>. The <span class="hl-yellow"><strong>dataset contains data from 699 patients who underwent a breast biopsy</strong></span>, obtaining 11 variables (one id and 10 scales measured from 1 to 10).</p>
<p>You can see the documentation at <a href="https://vincentarelbundock.github.io/Rdatasets/doc/MASS/biopsy.html" class="uri">https://vincentarelbundock.github.io/Rdatasets/doc/MASS/biopsy.html</a> . . .</p>
<ol type="1">
<li><p><span class="hl-yellow"><strong>Load the dataset</strong></span> from the <code>{MASS}</code> package. . . .</p></li>
<li><p>The variable <code>ID</code> should be the identifier of each record: <span class="hl-yellow"><strong>eliminate duplicates</strong></span> for that variable of the previous dataset.</p></li>
</ol>
</section>
<section id="caso-práctico-3a" class="slide level2">
<h2>🐣 Case study</h2>
<ol start="3" type="1">
<li>From the above dataset <span class="hl-yellow"><strong>filter</strong></span> only patients with malignant tumor and the variable <code>V9</code> with value 4 or lower, <span class="hl-yellow"><strong>further deleting any records containing missing data</strong></span> in any of the variables.</li>
</ol>
<div class="fragment">
<ol start="4" type="1">
<li>From the above dataset obtain a <span class="hl-yellow"><strong>sample of 20% of the data</strong></span> (each record can be chosen with the same probability), and <span class="hl-yellow"><strong>sort them</strong></span> from highest to lowest by the variable <code>V1</code> and, in case of a tie, from lowest to highest by the variable <code>V2</code>.</li>
</ol>
</div>
</section></section>
<section>
<section id="clase-4" class="title-slide slide level1 center">
<h1>Lesson 4: tidyverse (columns)</h1>
<p><span style="color:#444442;"><strong>Handling data by columns</strong></span></p>
</section>
<section id="select-columns-select" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The simplest option for <span class="hl-yellow"><strong>selecting variables by name</strong></span> is using <code>select()</code>, as arguments the column names <span class="hl-purple"><strong>without quotes</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name, hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 2
   name               hair_color   
   &lt;chr&gt;              &lt;chr&gt;        
 1 Luke Skywalker     blond        
 2 C-3PO              &lt;NA&gt;         
 3 R2-D2              &lt;NA&gt;         
 4 Darth Vader        none         
 5 Leia Organa        brown        
 6 Owen Lars          brown, grey  
 7 Beru Whitesun lars brown        
 8 R5-D4              &lt;NA&gt;         
 9 Biggs Darklighter  black        
10 Obi-Wan Kenobi     auburn, white
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="select-columns-select-1" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><code>select()</code> allows us to select many variables at once, even <span class="hl-yellow"><strong>concatenating their names as if they were numerical indexes</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>eye_color) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  name           height  mass hair_color skin_color  eye_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Luke Skywalker    172    77 blond      fair        blue     
2 C-3PO             167    75 &lt;NA&gt;       gold        yellow   
3 R2-D2              96    32 &lt;NA&gt;       white, blue red      
4 Darth Vader       202   136 none       white       yellow   </code></pre>
</div>
</div>
<div class="fragment">
<p>And we can <span class="hl-yellow"><strong>remove (unselect) columns</strong></span> using <code>-</code> before</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1"></a>starwars <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="sc">-</span>mass, <span class="sc">-</span>(eye_color<span class="sc">:</span>starships))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  name           height hair_color skin_color 
  &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      
1 Luke Skywalker    172 blond      fair       
2 C-3PO             167 &lt;NA&gt;       gold       
3 R2-D2              96 &lt;NA&gt;       white, blue
4 Darth Vader       202 none       white      </code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-2" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have also <span class="hl-yellow"><strong>reserved selectors</strong></span>: <code>everything()</code> for <span class="hl-purple"><strong>all variables</strong></span>….</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(mass, homeworld, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
   mass homeworld name   height hair_color skin_color eye_color birth_year sex  
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1    77 Tatooine  Luke …    172 blond      fair       blue            19   male 
2    75 Tatooine  C-3PO     167 &lt;NA&gt;       gold       yellow         112   none 
3    32 Naboo     R2-D2      96 &lt;NA&gt;       white, bl… red             33   none 
4   136 Tatooine  Darth…    202 none       white      yellow          41.9 male 
# ℹ 5 more variables: gender &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<p>…and <code>last_col()</code> for <span class="hl-purple"><strong>last column</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>mass, homeworld, <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  name           height  mass homeworld starships
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;list&gt;   
1 Luke Skywalker    172    77 Tatooine  &lt;chr [2]&gt;
2 C-3PO             167    75 Tatooine  &lt;chr [0]&gt;
3 R2-D2              96    32 Naboo     &lt;chr [0]&gt;
4 Darth Vader       202   136 Tatooine  &lt;chr [1]&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-3" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also find <span class="hl-yellow"><strong>patterns</strong></span> in the name, those that <span class="hl-purple"><strong>begin with a prefix</strong></span> (<code>starts_with()</code>), [<strong>end with a suffix</strong>]{. hl-purple} (<code>ends_with()</code>), <span class="hl-purple"><strong>contain text</strong></span> (<code>contains()</code>) or fulfill a <span class="hl-purple"><strong>regular expression</strong></span> (<code>matches()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"color"</span>), <span class="fu">matches</span>(<span class="st">"sex|gender"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 5
   hair_color    skin_color  eye_color sex    gender   
   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;    
 1 blond         fair        blue      male   masculine
 2 &lt;NA&gt;          gold        yellow    none   masculine
 3 &lt;NA&gt;          white, blue red       none   masculine
 4 none          white       yellow    male   masculine
 5 brown         light       brown     female feminine 
 6 brown, grey   light       blue      male   masculine
 7 brown         light       blue      female feminine 
 8 &lt;NA&gt;          white, red  red       none   masculine
 9 black         light       brown     male   masculine
10 auburn, white fair        blue-gray male   masculine
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="select-columns-select-4" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can even <span class="hl-yellow"><strong>select by numeric range</strong></span> if we have variables with a prefix and numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb410-2"><a href="#cb410-2"></a>  <span class="fu">tibble</span>(<span class="st">"wk1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">115</span>, <span class="dv">141</span>, <span class="dv">232</span>), <span class="st">"wk2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="cn">NA</span>, <span class="dv">17</span>),</span>
<span id="cb410-3"><a href="#cb410-3"></a>         <span class="st">"wk3"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">162</span>, <span class="cn">NA</span>), <span class="st">"wk4"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">19</span>, <span class="dv">15</span>),</span>
<span id="cb410-4"><a href="#cb410-4"></a>         <span class="st">"wk5"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">262</span>, <span class="dv">190</span>), <span class="st">"wk6"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">23</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><code>num_range()</code> allows us to select by prefix and a numeric sequence</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">"wk"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
    wk1   wk2   wk3   wk4
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1   115     7    95    11
2   141    NA   162    19
3   232    17    NA    15</code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-5" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">selecciono</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally, we can select columns by <span class="hl-yellow"><strong>datatatype</strong></span> using <code>where()</code> and inside a function that returns a logical value of datatype.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1"></a><span class="co"># Just numeric or string columns</span></span>
<span id="cb415-2"><a href="#cb415-2"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 11
   height  mass birth_year name     hair_color skin_color eye_color sex   gender
    &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; 
 1    172    77       19   Luke Sk… blond      fair       blue      male  mascu…
 2    167    75      112   C-3PO    &lt;NA&gt;       gold       yellow    none  mascu…
 3     96    32       33   R2-D2    &lt;NA&gt;       white, bl… red       none  mascu…
 4    202   136       41.9 Darth V… none       white      yellow    male  mascu…
 5    150    49       19   Leia Or… brown      light      brown     fema… femin…
 6    178   120       52   Owen La… brown, gr… light      blue      male  mascu…
 7    165    75       47   Beru Wh… brown      light      blue      fema… femin…
 8     97    32       NA   R5-D4    &lt;NA&gt;       white, red red       none  mascu…
 9    183    84       24   Biggs D… black      light      brown     male  mascu…
10    182    77       57   Obi-Wan… auburn, w… fair       blue-gray male  mascu…
# ℹ 77 more rows
# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="relocate-columns-relocate" class="slide level2">
<h2>Relocate columns: relocate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb417-2"><a href="#cb417-2"></a>  <span class="fu">recolocar</span>(var1, <span class="at">despues_de =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb418-2"><a href="#cb418-2"></a>  <span class="fu">relocate</span>(var1, <span class="at">.after =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>To facilitate the <span class="hl-yellow"><strong>relocation of variables</strong></span> we have a function for it, <code>relocate()</code>, indicating in <code>.after</code> or <code>.before</code> <span class="hl-purple"><strong>behind</strong></span> or <span class="hl-purple"><strong>in front</strong></span> of which columns we want to move them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">relocate</span>(species, <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   species name    height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 Human   Luke S…    172    77 blond      fair       blue            19   male 
 2 Droid   C-3PO      167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 Droid   R2-D2       96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 Human   Darth …    202   136 none       white      yellow          41.9 male 
 5 Human   Leia O…    150    49 brown      light      brown           19   fema…
 6 Human   Owen L…    178   120 brown, gr… light      blue            52   male 
 7 Human   Beru W…    165    75 brown      light      blue            47   fema…
 8 Droid   R5-D4       97    32 &lt;NA&gt;       white, red red             NA   none 
 9 Human   Biggs …    183    84 black      light      brown           24   male 
10 Human   Obi-Wa…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="rename-columns-rename" class="slide level2">
<h2>Rename columns: rename()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">renombrar</span>(<span class="at">nuevo =</span> antiguo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">new =</span> old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we may also want to <span class="hl-yellow"><strong>modify the “meta-information”</strong></span> of the data, <span class="hl-yellow"><strong>renaming columns</strong></span>. To do this we will use <code>rename()</code> by putting <span class="hl-purple"><strong>first the new name</strong></span> and then the <span class="hl-purple"><strong>old</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height, <span class="at">peso =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   nombre   altura  peso hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="extract-columns-pull" class="slide level2">
<h2>Extract columns: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">retirar</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>If you look at the output of the <code>select()</code> <span class="hl-yellow"><strong>it is still a tibble</strong></span> table, as it preserves the nature of our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 1
   name              
   &lt;chr&gt;             
 1 Luke Skywalker    
 2 C-3PO             
 3 R2-D2             
 4 Darth Vader       
 5 Leia Organa       
 6 Owen Lars         
 7 Beru Whitesun lars
 8 R5-D4             
 9 Biggs Darklighter 
10 Obi-Wan Kenobi    
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="extract-columns-pull-1" class="slide level2">
<h2>Extract columns: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">retirar</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we will not want such a structure but <span class="hl-yellow"><strong>literally extract the column into a vector</strong></span>, and we can do it with <code>pull()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Luke Skywalker"        "C-3PO"                 "R2-D2"                
 [4] "Darth Vader"           "Leia Organa"           "Owen Lars"            
 [7] "Beru Whitesun lars"    "R5-D4"                 "Biggs Darklighter"    
[10] "Obi-Wan Kenobi"        "Anakin Skywalker"      "Wilhuff Tarkin"       
[13] "Chewbacca"             "Han Solo"              "Greedo"               
[16] "Jabba Desilijic Tiure" "Wedge Antilles"        "Jek Tono Porkins"     
[19] "Yoda"                  "Palpatine"             "Boba Fett"            
[22] "IG-88"                 "Bossk"                 "Lando Calrissian"     
[25] "Lobot"                 "Ackbar"                "Mon Mothma"           
[28] "Arvel Crynyd"          "Wicket Systri Warrick" "Nien Nunb"            
[31] "Qui-Gon Jinn"          "Nute Gunray"           "Finis Valorum"        
[34] "Jar Jar Binks"         "Roos Tarpals"          "Rugor Nass"           
[37] "Ric Olié"              "Watto"                 "Sebulba"              
[40] "Quarsh Panaka"         "Shmi Skywalker"        "Darth Maul"           
[43] "Bib Fortuna"           "Ayla Secura"           "Dud Bolt"             
[46] "Gasgano"               "Ben Quadinaros"        "Mace Windu"           
[49] "Ki-Adi-Mundi"          "Kit Fisto"             "Eeth Koth"            
[52] "Adi Gallia"            "Saesee Tiin"           "Yarael Poof"          
[55] "Plo Koon"              "Mas Amedda"            "Gregar Typho"         
[58] "Cordé"                 "Cliegg Lars"           "Poggle the Lesser"    
[61] "Luminara Unduli"       "Barriss Offee"         "Dormé"                
[64] "Dooku"                 "Bail Prestor Organa"   "Jango Fett"           
[67] "Zam Wesell"            "Dexter Jettster"       "Lama Su"              
[70] "Taun We"               "Jocasta Nu"            "Ratts Tyerell"        
[73] "R4-P17"                "Wat Tambor"            "San Hill"             
[76] "Shaak Ti"              "Grievous"              "Tarfful"              
[79] "Raymus Antilles"       "Sly Moore"             "Tion Medon"           
[82] "Finn"                  "Rey"                   "Poe Dameron"          
[85] "BB8"                   "Captain Phasma"        "Padmé Amidala"        </code></pre>
</div>
</div>
</section>
<section id="tu-turno-4a" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-10-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-10-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-10-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-10-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<p>📝 Filter the set of characters and keep only those that in the <code>height</code> variable do not have a missing data. With the data obtained from the previous filter, select only the variables name, height, as well as all those variables that CONTAIN the word color in their name.</p>
</div>
<div id="tabset-10-2">
<p>📝 With the data obtained from the previous exercise, translate the names of the columns into English.</p>
</div>
<div id="tabset-10-3">
<p>📝 With the data obtained from the previous exercise, place the hair color variable just behind the name variable.</p>
</div>
<div id="tabset-10-4">
<p>📝 With the data obtained from the previous exercise, check how many unique modes there are in the hair color variable (without using <code>unique()</code>).</p>
</div>
<div id="tabset-10-5">
<p>📝 From the original data set, it removes the list type columns, and then removes duplicates in the <code>eye_color</code> variable. After removing duplicates it extracts that column into a vector.</p>
</div>
</div>
</div>
</section>
<section id="modify-columns-mutate" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In many occasions we will want to <span class="hl-yellow"><strong>modify or create variables</strong></span> with <code>mutate()</code>.</p>
<div class="fragment">
<p>Let’s create for example a new variable <code>height_m</code> with the height in meters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;, height_m &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="modify-columns-mutate-1" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In addition, with optional arguments as <code>.before</code> or <code>.after</code> we can <span class="hl-yellow"><strong>relocate the modified column</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb439-2"><a href="#cb439-2"></a>  <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb439-3"><a href="#cb439-3"></a>         <span class="at">IMC =</span> mass <span class="sc">/</span> (height_m<span class="sc">^</span><span class="dv">2</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 16
   height_m   IMC name   height  mass hair_color skin_color eye_color birth_year
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
 1     1.72  26.0 Luke …    172    77 blond      fair       blue            19  
 2     1.67  26.9 C-3PO     167    75 &lt;NA&gt;       gold       yellow         112  
 3     0.96  34.7 R2-D2      96    32 &lt;NA&gt;       white, bl… red             33  
 4     2.02  33.3 Darth…    202   136 none       white      yellow          41.9
 5     1.5   21.8 Leia …    150    49 brown      light      brown           19  
 6     1.78  37.9 Owen …    178   120 brown, gr… light      blue            52  
 7     1.65  27.5 Beru …    165    75 brown      light      blue            47  
 8     0.97  34.0 R5-D4      97    32 &lt;NA&gt;       white, red red             NA  
 9     1.83  25.1 Biggs…    183    84 black      light      brown           24  
10     1.82  23.2 Obi-W…    182    77 auburn, w… fair       blue-gray       57  
# ℹ 77 more rows
# ℹ 7 more variables: sex &lt;chr&gt;, gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="modify-columns-mutate-2" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">modificar</span>(<span class="at">nueva =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important…</strong></p>
</div>
<div class="callout-content">
<p>When we apply <code>mutate()</code>, we must remember that the <span class="hl-yellow"><strong>operations are performed in a vectorial way</strong></span>, element by element, so the function we use inside must return a vector of equal length. Otherwise, <span class="hl-red"><strong>it will return a constant</strong></span></p>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb443-2"><a href="#cb443-2"></a>  <span class="fu">mutate</span>(<span class="at">cte =</span> <span class="fu">mean</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
     cte name      height  mass hair_color skin_color eye_color birth_year sex  
   &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1  97.3 Luke Sky…    172    77 blond      fair       blue            19   male 
 2  97.3 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none 
 3  97.3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none 
 4  97.3 Darth Va…    202   136 none       white      yellow          41.9 male 
 5  97.3 Leia Org…    150    49 brown      light      brown           19   fema…
 6  97.3 Owen Lars    178   120 brown, gr… light      blue            52   male 
 7  97.3 Beru Whi…    165    75 brown      light      blue            47   fema…
 8  97.3 R5-D4         97    32 &lt;NA&gt;       white, red red             NA   none 
 9  97.3 Biggs Da…    183    84 black      light      brown           24   male 
10  97.3 Obi-Wan …    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="recat-if_else" class="slide level2">
<h2>Recat: if_else()</h2>
<p>We can also combine <code>mutate()</code> with the <code>if_else()</code> control expression to <span class="hl-yellow"><strong>recategorize the variable</strong></span>: if <span class="hl-purple"><strong>a condition is verified</strong></span>, it does the first option, otherwise the second one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb445-2"><a href="#cb445-2"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">if_else</span>(species <span class="sc">==</span> <span class="st">"Human"</span>, <span class="st">"Human"</span>, <span class="st">"Not Human"</span>),</span>
<span id="cb445-3"><a href="#cb445-3"></a>         <span class="at">.after =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb445-4"><a href="#cb445-4"></a>  <span class="fu">select</span>(name<span class="sc">:</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 4
   name               human     height  mass
   &lt;chr&gt;              &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Luke Skywalker     Human        172    77
 2 C-3PO              Not Human    167    75
 3 R2-D2              Not Human     96    32
 4 Darth Vader        Human        202   136
 5 Leia Organa        Human        150    49
 6 Owen Lars          Human        178   120
 7 Beru Whitesun lars Human        165    75
 8 R5-D4              Not Human     97    32
 9 Biggs Darklighter  Human        183    84
10 Obi-Wan Kenobi     Human        182    77
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="recat-case_when" class="slide level2">
<h2>Recat: case_when()</h2>
<p>For <span class="hl-yellow"><strong>more complex categorizations</strong></span> we have <code>case_when()</code>, for example, to create a category of characters based on their height.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb447-2"><a href="#cb447-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb447-3"><a href="#cb447-3"></a>  <span class="fu">mutate</span>(<span class="at">altura =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(height) <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb447-4"><a href="#cb447-4"></a>                            height <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"tiny"</span>,</span>
<span id="cb447-5"><a href="#cb447-5"></a>                            height <span class="sc">&lt;</span> <span class="dv">160</span> <span class="sc">~</span> <span class="st">"short"</span>,</span>
<span id="cb447-6"><a href="#cb447-6"></a>                            height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb447-7"><a href="#cb447-7"></a>                            height <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"tall"</span>,</span>
<span id="cb447-8"><a href="#cb447-8"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"gigant"</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 15
   altura name     height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 normal Luke Sk…    172    77 blond      fair       blue            19   male 
 2 normal C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 tiny   R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 gigant Darth V…    202   136 none       white      yellow          41.9 male 
 5 short  Leia Or…    150    49 brown      light      brown           19   fema…
 6 normal Owen La…    178   120 brown, gr… light      blue            52   male 
 7 normal Beru Wh…    165    75 brown      light      blue            47   fema…
 8 tiny   R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none 
 9 tall   Biggs D…    183    84 black      light      brown           24   male 
10 tall   Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 71 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="tu-turno-4b" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-11-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-11-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-11-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-11-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-11-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<p>📝 Select just variables <code>name</code>, <code>height</code> and as well as all those variables related to color properties, while keeping only those that are not absent in the height.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb449-2"><a href="#cb449-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb449-3"><a href="#cb449-3"></a>  <span class="fu">drop_na</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2">
<p>📝 With the data obtained from the previous exercise, translate the names of the columns into English.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb450-2"><a href="#cb450-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb450-3"><a href="#cb450-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb450-4"><a href="#cb450-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb450-5"><a href="#cb450-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb450-6"><a href="#cb450-6"></a>         <span class="at">color_pelo =</span> hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-3">
<p>📝 With the data obtained from the previous exercise, relocate the hair color variable just behind the name variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb451-2"><a href="#cb451-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb451-3"><a href="#cb451-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb451-4"><a href="#cb451-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb451-5"><a href="#cb451-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb451-6"><a href="#cb451-6"></a>         <span class="at">color_pelo =</span> hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb451-7"><a href="#cb451-7"></a>  <span class="fu">relocate</span>(color_pelo, <span class="at">.after =</span> nombre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-4">
<p>📝 Using the original data, check how many unique modes there are in the hair color variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb452-2"><a href="#cb452-2"></a>  <span class="fu">distinct</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb452-3"><a href="#cb452-3"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-5">
<p>📝 From the original dataset, select only the numeric and text variables. Then define a new variable called <code>under_18</code> to recategorize the age variable: <code>TRUE</code> if it is under age and <code>FALSE</code> otherwise.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb453-2"><a href="#cb453-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character)) <span class="sc">|&gt;</span> </span>
<span id="cb453-3"><a href="#cb453-3"></a>  <span class="fu">mutate</span>(<span class="at">under_18 =</span> birth_year <span class="sc">&lt;</span> <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-6">
<p>📝 From the original dataset, create a new column named <code>auburn</code> that tells us TRUE if the hair color contains that word and FALSE otherwise (reminder <code>str_detect()</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb454-2"><a href="#cb454-2"></a>  <span class="fu">mutate</span>(<span class="at">auburn =</span> <span class="fu">str_detect</span>(hair_color, <span class="st">"auburn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso4" class="slide level2">
<h2>🐣 Case study I</h2>
<p>From the original dataset, include a column that calculates the BMI. After that, create a new variable that values <code>NA</code> if not human, <code>thin</code> below 18, <code>normal</code> between 18 and 30, <code>overweight</code> above 30.</p>
</section>
<section id="caso4a" class="slide level2">
<h2>🐣 Case study II</h2>
<p>Let’s proceed to <span class="hl-yellow"><strong>create a table with data of voters</strong></span> of size <code>n = 30</code> where <span class="hl-yellow"><strong>simulate the voting intention and their incomes</strong></span></p>
<div class="fragment">
<ol type="1">
<li><p>Create a <code>tibble</code> with two columns, one named <code>id_voter</code> and one named <code>party</code>. In the first case it should go from 1 to 30. In the second case, it simulates its voting intention so that there is a 0.5 chance of <code>PP</code> and 0.5 chance of <code>SUMAR</code> (Spanish political parties). . . .</p></li>
<li><p>After knowing the voting intention, create a third column called <code>income</code> in which you simulate their gross annual income. We will assume that for PP’s voterts, incomes follows a distribution <span class="math inline">\(N(\mu = 37000€, sigma = 800)\)</span> and that for SUMAR’s voters it follows a distribution <span class="math inline">\(N(\mu = 26000€, sigma = 1200)\)</span>.</p></li>
</ol>
</div>
</section></section>
<section>
<section id="clase-5" class="title-slide slide level1 center">
<h1>Lesson 5: tidyverse (summary)</h1>
<p><span style="color:#444442;"><strong>Summarizing data</strong></span></p>
</section>
<section id="count-count" class="slide level2">
<h2>Count: count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">contar</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>So far we have only transformed or queried the data but have not generated statistics. Let’s start with the simple: <span class="hl-yellow"><strong>how to count (frequencies)?</strong></span></p>
<div class="fragment">
<p>When used alone <code>count()</code> will simply return the number of records, but when used with <code>count()</code> variables it calculates what is known as <span class="hl-yellow"><strong>frequencies</strong></span>: <span class="hl-purple"><strong>number of elements of each modality</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</div>
</section>
<section id="count-count-1" class="slide level2">
<h2>Count: count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">contar</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Also if we include several variables it calculates what is known as a <span class="hl-yellow"><strong>contiguity table</strong></span>. With <code>sort = TRUE</code> it will return the <span class="hl-purple"><strong>ordered count</strong></span> (most frequent first).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex, gender, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sex            gender        n
  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;
1 male           masculine    60
2 female         feminine     16
3 none           masculine     5
4 &lt;NA&gt;           &lt;NA&gt;          4
5 hermaphroditic masculine     1
6 none           feminine      1</code></pre>
</div>
</div>
</section>
<section id="groups-group_by" class="slide level2">
<h2>Groups: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb463-2"><a href="#cb463-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb463-3"><a href="#cb463-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb463-4"><a href="#cb463-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb464-2"><a href="#cb464-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb464-3"><a href="#cb464-3"></a>  <span class="fu">action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb464-4"><a href="#cb464-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>One of the most powerful <span class="hl-yellow"><strong>functions</strong></span> to combine with the actions seen is <code>group_by()</code>, which will allow us to <span class="hl-yellow"><strong>group our records</strong></span> beforehand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb465-2"><a href="#cb465-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb465-3"><a href="#cb465-3"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb465-4"><a href="#cb465-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="groups-group_by-1" class="slide level2">
<h2>Groups: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb467-2"><a href="#cb467-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb467-3"><a href="#cb467-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb467-4"><a href="#cb467-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb468-2"><a href="#cb468-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb468-3"><a href="#cb468-3"></a>  <span class="fu">action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb468-4"><a href="#cb468-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>When applying <code>group_by()</code> it is important to understand that it <span class="hl-yellow"><strong>DOES NOT MODIFY the data</strong></span>, but creates a <span class="hl-yellow"><strong>group variable</strong></span> (sub-tables for each group) that will modify future actions: the <span class="hl-purple"><strong>operations will be applied to each sub-table separately</strong></span></p>
<div class="fragment">
<p>For example, let us imagine that we want to extract the highest character with <code>slice_max()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="groups-group_by-2" class="slide level2">
<h2>Groups: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb471-2"><a href="#cb471-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb471-3"><a href="#cb471-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb471-4"><a href="#cb471-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb472-2"><a href="#cb472-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb472-3"><a href="#cb472-3"></a>  <span class="fu">action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb472-4"><a href="#cb472-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>What if we want to <span class="hl-yellow"><strong>extract the tallest character but…of each of the sexes</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb473-2"><a href="#cb473-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb473-3"><a href="#cb473-3"></a>  <span class="fu">slice_max</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb473-4"><a href="#cb473-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Taun We      213    NA none       grey       black             NA fema… femin…
2 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
3 Yarael P…    264    NA none       white      yellow            NA male  mascu…
4 IG-88        200   140 none       metal      red               15 none  mascu…
5 Ric Olié     183    NA brown      fair       blue              NA &lt;NA&gt;  &lt;NA&gt;  
6 Quarsh P…    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="groups-group_by-3" class="slide level2">
<h2>Groups: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb475-2"><a href="#cb475-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb475-3"><a href="#cb475-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span> </span>
<span id="cb475-4"><a href="#cb475-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb476-2"><a href="#cb476-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb476-3"><a href="#cb476-3"></a>  <span class="fu">action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb476-4"><a href="#cb476-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_1.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_2.jpg"></p>
</div>
</div>
<p>The website <a href="https://tidydatatutor.com/" class="uri">https://tidydatatutor.com/</a> allows to visualize the operations of <code>{tidyverse}</code> (with the old pipe)</p>
</section>
<section id="groups-group_by-4" class="slide level2">
<h2>Groups: group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb477-2"><a href="#cb477-2"></a>  <span class="fu">agrupar</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb477-3"><a href="#cb477-3"></a>  <span class="fu">accion</span>() <span class="sc">|&gt;</span></span>
<span id="cb477-4"><a href="#cb477-4"></a>  <span class="fu">desagrupar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb478-2"><a href="#cb478-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb478-3"><a href="#cb478-3"></a>  <span class="fu">action</span>() <span class="sc">|&gt;</span></span>
<span id="cb478-4"><a href="#cb478-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Reminder: <span class="hl-red"><strong>make ungroup</strong></span> to remove the created group variable</p>
</div>
</div>
</div>
<div class="fragment">
<p>The new version of <code>{dplyr}</code> package now <span class="hl-yellow"><strong>allows to include the group variable</strong></span> in the call to many functions with the argument <code>by = ...</code> or <code>.by = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  name                  height  mass hair_color skin_color       eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;    
1 Yarael Poof              264    NA none       white            yellow   
2 IG-88                    200   140 none       metal            red      
3 Taun We                  213    NA none       grey             black    
4 Jabba Desilijic Tiure    175  1358 &lt;NA&gt;       green-tan, brown orange   
5 Ric Olié                 183    NA brown      fair             blue     
6 Quarsh Panaka            183    NA black      dark             brown    </code></pre>
</div>
</div>
</div>
</section>
<section id="row-by-row-rowwise" class="slide level2">
<h2>Row-by-row: rowwise()</h2>
<p>A very useful option used before an operation is also <code>rowwise()</code>: every <span class="hl-yellow"><strong>operation that comes afterwards will be applied on each row separately</strong></span>. For example, let’s define a dummy set of notes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1"></a>marks <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"maths"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="fl">9.1</span>, <span class="dv">3</span>),</span>
<span id="cb481-2"><a href="#cb481-2"></a>                <span class="st">"lang"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">6</span>, <span class="fl">6.5</span>, <span class="fl">9.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>If we apply the average directly the value will be identical since it has done the global average, but we would like to get an <span class="hl-yellow"><strong>average per row</strong></span>. For that we will use <code>rowwise()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1"></a>marks <span class="sc">|&gt;</span> </span>
<span id="cb482-2"><a href="#cb482-2"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb482-3"><a href="#cb482-3"></a>  <span class="fu">mutate</span>(<span class="at">avg_mark =</span> <span class="fu">mean</span>(<span class="fu">c</span>(maths, lang)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Rowwise: 
  maths  lang avg_mark
  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1   7.5   8       7.75
2   8     6       7   
3   9.1   6.5     7.8 
4   3     9.2     6.1 </code></pre>
</div>
</div>
</div>
</section>
<section id="summary-summarise" class="slide level2">
<h2>Summary: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally we have <code>summarise()</code>, which will allow us to get statistical summaries. For example, let’s <span class="hl-yellow"><strong>calculate the average of the heights</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb486-2"><a href="#cb486-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb486-3"><a href="#cb486-3"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  media_altura
         &lt;dbl&gt;
1         174.</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful…</strong></p>
</div>
<div class="callout-content">
<p>Notice that <code>mutate()</code> returns <span class="hl-yellow"><strong>as many rows as original records</strong></span>, while with <code>summarise()</code> it calculates a <span class="hl-purple"><strong>new summary dataset</strong></span>, only including what is indicated.</p>
</div>
</div>
</div>
</div>
</section>
<section id="summary-summarise-1" class="slide level2">
<h2>Summary: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>If we also <span class="hl-yellow"><strong>combine this with the grouping action</strong></span> of <code>group_by()</code> or <code>.by = ...</code>, in a few lines of code you can get <span class="hl-purple"><strong>disaggregated statistics</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb490-2"><a href="#cb490-2"></a>  <span class="fu">drop_na</span>(sex, height, mass) <span class="sc">|&gt;</span> </span>
<span id="cb490-3"><a href="#cb490-3"></a>  <span class="fu">summarise</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(height),</span>
<span id="cb490-4"><a href="#cb490-4"></a>            <span class="at">mean_mass =</span> <span class="fu">mean</span>(mass),</span>
<span id="cb490-5"><a href="#cb490-5"></a>            <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  sex            mean_height mean_mass
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;
1 male                  178.      81.0
2 none                  140       69.8
3 female                169.      54.7
4 hermaphroditic        175     1358  </code></pre>
</div>
</div>
</section>
<section id="summary-summarise-2" class="slide level2">
<h2>Summary: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1"></a>datos <span class="sc">|&gt;</span> <span class="fu">resumir</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">reframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In the new <code>{dplyr}</code> version, they have included <code>reframe()</code> to avoid problems with <code>summarise()</code> when <span class="hl-yellow"><strong>we return more than one value per variable</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb494-2"><a href="#cb494-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb494-3"><a href="#cb494-3"></a>  <span class="fu">summarise</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb497-2"><a href="#cb497-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb497-3"><a href="#cb497-3"></a>  <span class="fu">reframe</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="selectors-across" class="slide level2">
<h2>Selectors: across()</h2>
<p>One trick is to <span class="hl-yellow"><strong>make use of selectors</strong></span> <code>across()</code> and <code>where()</code>. The former allows us to <span class="hl-purple"><strong>act on several columns by name</strong></span> (with <code>mutate()</code> or <code>summarise()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">means =</span> <span class="fu">across</span>(height<span class="sc">:</span>mass, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex            means$height  $mass
  &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;
1 male                   179.   81.0
2 none                   131.   69.8
3 female                 169.   54.7
4 hermaphroditic         175  1358  
5 &lt;NA&gt;                   181.   48  </code></pre>
</div>
</div>
<div class="fragment">
<p>The second one, <code>where()</code>, allows us to do the same but <span class="hl-yellow"><strong>selecting by type</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb501-2"><a href="#cb501-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> <span class="fu">c</span>(sex, gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  sex            gender    height   mass birth_year
  &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 male           masculine   179.   81.0       85.5
2 none           masculine   140    69.8       53.3
3 female         feminine    169.   54.7       47.2
4 hermaphroditic masculine   175  1358        600  
5 &lt;NA&gt;           &lt;NA&gt;        181.   48         62  
6 none           feminine     96   NaN        NaN  </code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-5a" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-12-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-12-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-12-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<p>📝 Compute how many characters there are of each species, ordered from most to least frequent.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(species, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2">
<p>📝 After removing missing variables for weight and height, add a new variable to calculate the BMI of each character, and determine the average BMI of our characters disaggregated by gender.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb504-2"><a href="#cb504-2"></a>  <span class="fu">drop_na</span>(mass, height) <span class="sc">|&gt;</span> </span>
<span id="cb504-3"><a href="#cb504-3"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> mass <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb504-4"><a href="#cb504-4"></a>  <span class="fu">summarise</span>(<span class="at">mean_BMI =</span> <span class="fu">mean</span>(BMI), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-3">
<p>📝 Obtain the youngest character for each gender.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb505-2"><a href="#cb505-2"></a>  <span class="fu">slice_min</span>(birth_year, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-4">
<p>📝 Get the age of the youngest and oldest character, in general and for each of sex modalities.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb506-2"><a href="#cb506-2"></a>  <span class="fu">drop_na</span>(birth_year) <span class="sc">|&gt;</span></span>
<span id="cb506-3"><a href="#cb506-3"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(birth_year), <span class="fu">max</span>(birth_year))</span>
<span id="cb506-4"><a href="#cb506-4"></a></span>
<span id="cb506-5"><a href="#cb506-5"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb506-6"><a href="#cb506-6"></a>  <span class="fu">drop_na</span>(birth_year) <span class="sc">|&gt;</span></span>
<span id="cb506-7"><a href="#cb506-7"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(birth_year), <span class="fu">max</span>(birth_year), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso5a" class="slide level2">
<h2>🐣 Case study I</h2>
<p>Let us randomly select 50% of the data, keeping the original distribution (in proportions) between humans and non-humans (we should remove first missing values).</p>
<div class="fragment">
<p>Then keep only the variables name, height, those representing a color characteristic and the variable films. Calculate the average heights in humans and non-humans. Finally calculate the frequencies of eye color and human/non-human.</p>
</div>
</section>
<section id="report-rmd-y-quarto" class="slide level2">
<h2>Report: rmd y Quarto</h2>
<p>One of the <span class="hl-yellow"><strong>main strengths</strong></span> of <code>R</code> is the <span class="hl-yellow"><strong>easiness to generate reports, books, webs, notes and even slides</strong></span> (this material for example). To do this, <span class="hl-purple"><strong>install</strong></span> before</p>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>package <code>{rmarkdown}</code> (allows us to generate <code>.rmd</code> files)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1"></a><span class="fu">install.packages</span>(<span class="st">"rmarkdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>install <a href="https://quarto.org/docs/get-started/"><strong>Quarto</strong></a> (the «new» <code>.rmd</code> files, names as <code>.qmd</code>)</li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="img/quarto.png"></p>
</div>
</div>
</section>
<section id="report-rmd-y-quarto-1" class="slide level2">
<h2>Report: rmd y Quarto</h2>
<p>So far we have only programmed in scripts (<code>.R</code> files) within projects, but in many occasions <span class="hl-yellow"><strong>we will not work alone</strong></span> and we will need to <span class="hl-yellow"><strong>communicate the results</strong></span> in different formats:</p>
<ul>
<li>notes (for ourselves)</li>
<li>slides</li>
<li>web</li>
<li>reports</li>
</ul>
<div class="fragment">
<p>For all of this we will use <span class="hl-yellow"><strong>Quarto (new rmarkdown)</strong></span></p>
</div>
</section>
<section id="report-rmd-y-quarto-2" class="slide level2">
<h2>Report: rmd y Quarto</h2>
<p>The <code>.qmd</code> (or <code>.rmd</code>) extension files will allow us to easily combine:</p>
<ul>
<li><span class="hl-yellow"><strong>Markdown</strong></span>: <span class="hl-purple"><strong>typed language</strong></span> which allows us to create simple content (wordpress type, with text, <strong>bold</strong>, <em>cursives</em>, etc) with a readable layout.</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Math (latex)</strong></span>: language for writing mathematical notation such as <span class="math inline">\(x^2\)</span> or <span class="math display">\[sqrt{y}$ or \]</span>int_{a}^{b} f(x) dx$.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Code and outputs</strong></span>: we will be able to show not only the final step but also the code you have been doing (not only in <code>R</code>), with <span class="hl-purple"><strong>code boxes called chunks</strong></span> .</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Images, <span class="hl-yellow"><strong>graphics</strong></span>, tables, styles (css, js), etc.</li>
</ul>
</div>
</section>
<section id="report-rmd-y-quarto-3" class="slide level2">
<h2>Report: rmd y Quarto</h2>
<p>The main advantage of making this type of material in Quarto/Rmarkdown is that, by doing it from <code>RStudio</code>, you can generate a <span class="hl-yellow"><strong>report or presentation without leaving the programming environment</strong></span> in which you are working.</p>
<p>This way you can analyze the data, summarize it and at the same time report it with the same tool.</p>
<div class="fragment">
<p>Recently the <code>RStudio</code> team developed <span class="hl-yellow"><strong>Quarto</strong></span>, an improved version of Rmarkdown (<code>.qmd</code> files), with a slightly more aesthetic and simple format. You have all the documentation and examples at <a href="https://quarto.org/"><strong>https://quarto.org/</strong></a></p>
</div>
</section>
<section id="our-first-report" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/quarto-create.png"></p>
</div><div class="column" style="width:45%;">
<p>We are going to create the <span class="hl-yellow"><strong>first rmarkdown file with Quarto</strong></span> with extension <code>.qmd</code>. For this we will only need to click on</p>
<p><code>File &lt;&lt; New File &lt;&lt; Quarto Document</code></p>
</div>
</div>
</section>
<section id="our-first-report-1" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-format.png"></p>
</div><div class="column" style="width:55%;">
<p>After doing so we will be presented with several <span class="hl-yellow"><strong>output format options</strong></span>:</p>
<ul>
<li><code>.pdf</code> file</li>
<li>file <code>.html</code> (<span class="hl-yellow"><strong>recommendable</strong></span>): dynamic document, allows interaction with the user, like a “web page”.</li>
<li><code>.doc</code> file (not recommended)</li>
</ul>
</div>
</div>
<div class="fragment">
<p>For the moment we will leave the <span class="hl-yellow"><strong>default HTML format</strong></span> checked, and we will write the <span class="hl-yellow"><strong>title</strong></span> of our document. After that we will have our <span class="hl-yellow"><strong>file .qmd</strong></span> (it is no longer an .R script like the ones we have opened so far).</p>
</div>
</section>
<section id="our-first-report-2" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:40%;">
<p>You should have something similar to the image capture with <span class="hl-yellow"><strong>two editing modes</strong></span>: <code>Source</code> (with code, the recommended option until you master it) and <code>Visual</code> (more like a blog).</p>
</div>
</div>
<p>To <span class="hl-yellow"><strong>run the ENTIRE document</strong></span> you must click <code>Render on Save</code> and hit save.</p>
<p><img data-src="img/quarto-prueba-html.png"></p>
<p>You should have obtained an <span class="hl-yellow"><strong>html output similar to this</strong></span> (and a <span class="hl-yellow"><strong>html file</strong></span> has been generated on your pc).</p>
</section>
<section id="our-first-report-3" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:50%;">
<p>A <code>.qmd</code> file is <span class="hl-yellow"><strong>basically divided into three parts</strong></span>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Header</strong></span>: the part you have at the beginning between <code>---</code>.</p></li>
<li><p><span class="hl-yellow"><strong>Text</strong></span>: that we can format and enhance with bold (written as <strong>bold</strong>, with double asterisk at the beginning and end), italics (<em>cursive</em>, with underscore at the beginning and end) or highlight function names or variables of R. You can add equations like <span class="math inline">\(x^2\)</span> (I have written <code>$x^2$</code>, between dollars).</p></li>
<li><p><span class="hl-yellow"><strong>R code</strong></span></p></li>
</ul>
</div>
</div>
</section>
<section id="qmd-header" class="slide level2">
<h2>qmd header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document:</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/quarto-cabecera.png"></p>
</div><div class="column" style="width:70%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: document title/subtitle</li>
<li><code>author</code>: author of the document</li>
<li><code>date</code>: date</li>
<li>`<code>format</code>: output format (we can customize it)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
<li><code>toc-depth</code>: index depth</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div>
</div>
</section>
<section id="text" class="slide level2">
<h2>Text</h2>
<p>As for writing there is only one <span class="hl-yellow"><strong>important thing</strong></span>: unless we indicate otherwise, <span class="hl-yellow"><strong>EVERYTHING we are going to write is (normal)</strong> text</span>. No R code.</p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/quarto-prueba-qmd2.png" width="350"> <img data-src="img/quarto-prueba-html2.png" width="320"></p>
</div><div class="column" style="width:65%;">
<p>We are going to start by writing a section at the beginning (<code># Intro</code> and behind it e.g.&nbsp;the phrase</p>
<blockquote>
<p>This material has been designed by Javier Álvarez Liébana, professor at the Complutense University of Madrid.</p>
</blockquote>
<p>In addition to the <code>Running Code</code> we will add a <code>#</code>: the <span class="hl-yellow"><strong>OUT OF CHUNKS</strong></span> <code>#</code> will be used to create <span class="hl-yellow"><strong>epigraphs (sections)</strong></span> in the document.</p>
</div>
</div>
</section>
<section id="table-of-contents" class="slide level2">
<h2>Table of contents</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-indice-qmd-2.png" width="370"> <img data-src="img/quarto-indice-html2.png" width="370"></p>
</div><div class="column" style="width:60%;">
<p>To make the <span class="hl-yellow"><strong>index capture those sections</strong></span> we will modify the header of the file as shown in the image (you can change the location of the index and the title if you want to test).</p>
</div>
</div>
</section>
<section id="text-1" class="slide level2">
<h2>Text</h2>
<p>Let’s <span class="hl-yellow"><strong>customize the text</strong></span> by doing the following:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-texto-mejorado-qmd.png" width="370"> <img data-src="img/quarto-texto-mejorado-html.png" width="370"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Let’s add <span class="hl-yellow"><strong>bold to the name</strong></span> (putting ** at the beginning and at the end).</p></li>
<li><p>Let’s add <span class="hl-yellow"><strong>cursive</strong></span> to the word material (putting _ at the beginning and at the end).</p></li>
<li><p>Let’s add a <span class="hl-yellow"><strong>link</strong></span> <a href="https://www.ucm.es" class="uri">https://www.ucm.es</a>, associating it to the name of the University. To do this we put the title in square brackets and just behind the link in brackets <code>["Universidad Complutense de Madrid"](https://www.ucm.es)</code>.</p></li>
</ul>
</div>
</div>
</section>
<section id="code" class="slide level2">
<h2>Code</h2>
<p>To <span class="hl-yellow"><strong>add R code</strong></span> we must create our <span class="hl-yellow"><strong>code boxes called chunks</strong></span>: high in the path in our markdown text where we can include code from almost any language (and its outputs).</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-qmd.png" width="470"></p>
</div><div class="column" style="width:50%;">
<p>To include one you must go <span class="hl-yellow"><strong>header</strong></span> as follows you have a shortcut <code>Command + Option + I</code> (Mac) or <code>Ctrl + Shift + I</code> (Windows)</p>
</div>
</div>
</section>
<section id="code-1" class="slide level2">
<h2>Code</h2>
<p>Inside this box (which now has a different color in the document) <span class="hl-yellow"><strong>write code R</strong></span> as we have been doing so far in the scripts.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-1-qmd.png" width="410"> <img data-src="img/quarto-chunk-1-html.png" width="410"></p>
</div><div class="column" style="width:50%;">
<p>Let’s for example define two variables and their sum in the following way, writing this code in our <code>.qmd</code> (inside that chunk).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1"></a><span class="co"># R code</span></span>
<span id="cb508-2"><a href="#cb508-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb508-3"><a href="#cb508-3"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb508-4"><a href="#cb508-4"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="labelling-chunks" class="slide level2">
<h2>Labelling chunks</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-tag-chunks-qmd.png" width="400"> <img data-src="img/quarto-tag-chunks-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Chunks can have a <span class="hl-yellow"><strong>name or tag</strong></span>, so that we can reference them again to avoid repeating code.</p>
</div>
</div>
</section>
<section id="running-chunks" class="slide level2">
<h2>Running chunks</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-inline-qmd.png" width="400"> <img data-src="img/quarto-inline-html.png" width="380"></p>
</div><div class="column" style="width:60%;">
<p>In each chunk there are <span class="hl-yellow"><strong>two buttons</strong></span>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>play</strong></span> button: activates the <span class="hl-yellow"><strong>run and exit of that particular chunk</strong></span> (you can view it within your own <code>RStudio</code>)</p></li>
<li><p><span class="hl-yellow"><strong>rewind</strong></span> button: triggers <span class="hl-yellow"><strong>execute and exit all chunks up to that one</strong></span> (without getting to it)</p></li>
</ul>
<p>&nbsp;</p>
<p>In addition we can <span class="hl-yellow"><strong>include R code inside the text line</strong></span> (instead of displaying the text x execute the R code displaying the variable).</p>
</div>
</div>
</section>
<section id="customizing-chunks" class="slide level2">
<h2>Customizing chunks</h2>
<p>The <span class="hl-yellow"><strong>chunks can be customized</strong></span> with options at the beginning of the chunk preceded by <code>#|</code>:</p>
<ul>
<li><p><code></code>#| echo: false`: <span class="hl-green"><strong>execute code</strong></span> and it <span class="hl-green"><strong>shows result</strong></span> but <span class="hl-red"><strong>does not display code</strong></span> in the output.</p></li>
<li><p><code>#| include: false</code>: <span class="hl-green"><strong>executes code</strong></span> but <span class="hl-red"><strong>does not display result</strong></span> and <span class="hl-red"><strong>does not display code</strong></span> in the output.</p></li>
<li><p><code>#| eval: false</code>: <span class="hl-red"><strong>does not execute code</strong></span>, <span class="hl-red"><strong>does not display result</strong></span> but <span class="hl-green"><strong>does display code</strong></span> on output.</p></li>
<li><p><code>#| message: false</code>: <span class="hl-green"><strong>executes code</strong></span> but <span class="hl-red"><strong>does not display output messages</strong></span>.</p></li>
<li><p><code>#| warning: false</code>: <span class="hl-green"><strong>executes code</strong></span> but <span class="hl-red"><strong>does not display warning messages</strong></span>.</p></li>
<li><p><code>#| error: true</code>: <span class="hl-green"><strong>executes code</strong></span> and <span class="hl-green"><strong>allows errors</strong></span> showing the error message in the output.</p></li>
</ul>

<img data-src="img/quarto-options-chunk.png" width="380" class="r-stretch"><p>These options can be applied chunk by chunk or set globally with <code>knitr::opts_chunk$set()</code> at the beginning of the document (within a chunk).</p>
</section>
<section id="organizing-qmd" class="slide level2">
<h2>Organizing qmd</h2>
<p>In addition to text and code we can enter the following:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Equations</strong></span>: you can additionally add equations such as <span class="math inline">\(x^2\)</span> (I have written <code>$x^2$</code>, the equation between dollars).</p></li>
<li><p><span class="hl-yellow"><strong>Lists</strong></span>: you can itemize elements by putting <code>*</code></p></li>
</ul>
<p><code>* Step 1: ...</code></p>
<p><code>* Step 2: ...</code></p>
<ul>
<li><span class="hl-yellow"><strong>Cross-references</strong></span>: you can tag parts of the document (the tag is constructed with <code>{#section-name}</code>) and then call them with <code>[Section](@section-name)</code>).</li>
</ul>
</section>
<section id="graphicsimages" class="slide level2">
<h2>Graphics/images</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-fig-qmd.png" width="340"> <img data-src="img/quarto-fig-html.png" width="390"></p>
</div><div class="column" style="width:50%;">
<p>Por último, también podemos <span class="hl-yellow"><strong>añadir pies de gráficas o imágenes</strong></span> añadiendo <code>#| fig-cap: "..."</code></p>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:65%;">
<p>Finally, we can also <span class="hl-yellow"><strong>add captions to graphics or images</strong></span> by adding <code>#| fig-cap: "..."</code>.</p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/quarto-cabecera-desplegable.png" width="400"></p>
</div>
</div>
</div>
</section>
<section id="theme-and-styles" class="slide level2">
<h2>Theme and styles</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-estilos-qmd.png" width="400"> <img data-src="img/quarto-estilos-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Finally, you can add a <span class="hl-yellow"><strong>custom theme</strong></span> including a <span class="hl-yellow"><strong>style file</strong></span> (<code>.scss</code> or <code>.css</code> file). I have left one for you at <a href="https://github.com/dadosdelaplace/mucss-data-programming/tree/main/material" class="uri">https://github.com/dadosdelaplace/mucss-data-programming/tree/main/material</a>.</p>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The style file must be in the same folder as the <code>.qmd</code> file.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="caso5b" class="slide level2">
<h2>🐣 Case study</h2>
<p>Produce a <code>.qmd</code> report such that.</p>
<ul>
<li><p>Create a file make <span class="hl-yellow"><strong>one section per exercise</strong></span> (see the following slides)</p></li>
<li><p><span class="hl-yellow"><strong>Detail all the steps</strong></span> you consider mixing text, code and outputs .</p></li>
<li><p>If statistical measures such as the mean appear, <span class="hl-yellow"><strong>try entering formulas</strong></span> with <code>$$</code> (look for information on how to enter equations in latex).</p></li>
</ul>
</section>
<section id="case-study" class="slide level2">
<h2>🐣 Case study</h2>
<ol type="1">
<li>Loads the billboard datatable from the <code>{tidyr}</code> package.</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>First of all, select only the <span class="hl-yellow"><strong>first 52 weeks</strong></span> (but also artist, track and date variables). After that convert the dataset to <span class="hl-yellow"><strong>tidydata</strong></span> with the appropriate formats and types for each variable</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Extracts the <span class="hl-yellow"><strong>list of distinct artists</strong></span> appearing in the table, including <span class="hl-yellow"><strong>how many times</strong></span> each appears.</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Determines <span class="hl-yellow"><strong>how many songs each artist</strong></span> has</li>
</ol>
</div>
</section>
<section id="case-study-1" class="slide level2">
<h2>🐣 Case study</h2>
<ol start="5" type="1">
<li>Determines the <span class="hl-yellow"><strong>5 songs that appear in the charts the most weeks</strong></span>.</li>
</ol>
<div class="fragment">
<ol start="6" type="1">
<li>Determines <span class="hl-yellow"><strong>for each artist the song that appears the most weeks</strong></span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="7" type="1">
<li>Determines the <span class="hl-yellow"><strong>artist with the most songs</strong></span> in the list</li>
</ol>
</div>
<div class="fragment">
<ol start="8" type="1">
<li>Calculates the <span class="hl-yellow"><strong>highest position</strong></span> that each song has been on. Calculates the highest position an artist has been in.</li>
</ol>
</div>
</section>
<section id="case-study-2" class="slide level2">
<h2>🐣 Case study</h2>
<ol start="9" type="1">
<li>Get a <span class="hl-yellow"><strong>summary table</strong></span> with the average ranking of each artist (counting only the highest ranking achieved by their songs), as well as the number of (different) songs they have placed in the top 100.</li>
</ol>
<div class="fragment">
<ol start="10" type="1">
<li>Perform stratified random sampling, extracting 50% of the data but maintaining the proportion of data among the different quarters.</li>
</ol>
</div>
</section></section>
<section>
<section id="clase-6" class="title-slide slide level1 center">
<h1>Lesson 6: import/export</h1>
<p><span style="color:#444442;"><strong>Import/export and functions</strong></span></p>
</section>
<section id="case-study-3" class="slide level2">
<h2>🐣 Case study 3</h2>
<p>We are going to use the <code>biopsy</code> dataset that can be found in the dataset aggregator <a href="https://vincentarelbundock.github.io/Rdatasets/index.html" class="uri">https://vincentarelbundock.github.io/Rdatasets/index.html</a>. The <span class="hl-yellow"><strong>dataset contains data from 699 patients who underwent a breast biopsy</strong></span>, obtaining 11 variables (one id and 10 scales measured from 1 to 10).</p>
<p>You can see the documentation at <a href="https://vincentarelbundock.github.io/Rdatasets/doc/MASS/biopsy.html" class="uri">https://vincentarelbundock.github.io/Rdatasets/doc/MASS/biopsy.html</a> . . .</p>
<ol type="1">
<li><span class="hl-yellow"><strong>Load the dataset</strong></span> from the <code>{MASS}</code> package as a tibble</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb510-2"><a href="#cb510-2"></a>biopsy <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MASS<span class="sc">::</span>biopsy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="case-study-3-1" class="slide level2">
<h2>🐣 Case study 3</h2>
<ol start="2" type="1">
<li>The variable <code>ID</code> should be the identifier of each record: <span class="hl-yellow"><strong>eliminate duplicates</strong></span> for that variable of the previous dataset.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1"></a>biopsy <span class="ot">&lt;-</span></span>
<span id="cb511-2"><a href="#cb511-2"></a>  biopsy <span class="sc">|&gt;</span> </span>
<span id="cb511-3"><a href="#cb511-3"></a>  <span class="fu">distinct</span>(ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="case-study-3-2" class="slide level2">
<h2>🐣 Case study 3</h2>
<ol start="3" type="1">
<li>From the above dataset <span class="hl-yellow"><strong>filter</strong></span> only patients with malignant tumor and the variable <code>V9</code> with value 4 or lower, <span class="hl-yellow"><strong>further deleting any records containing missing data</strong></span> in any of the variables.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1"></a>biopsy <span class="sc">|&gt;</span> </span>
<span id="cb512-2"><a href="#cb512-2"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb512-3"><a href="#cb512-3"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"malignant"</span> <span class="sc">&amp;</span> V9 <span class="sc">&lt;=</span> <span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 194 × 11
   ID         V1    V2    V3    V4    V5    V6    V7    V8    V9 class    
   &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt;    
 1 1017122     8    10    10     8     7    10     9     7     1 malignant
 2 1041801     5     3     3     3     2     3     4     4     1 malignant
 3 1044572     8     7     5    10     7     9     5     5     4 malignant
 4 1047630     7     4     6     4     6     1     4     3     1 malignant
 5 1050670    10     7     7     6     4    10     4     1     2 malignant
 6 1054590     7     3     2    10     5    10     5     4     4 malignant
 7 1054593    10     5     5     3     6     7     7    10     1 malignant
 8 1065726     5     2     3     4     2     7     3     6     1 malignant
 9 1072179    10     7     7     3     8     5     7     4     3 malignant
10 1080185    10    10    10     8     6     1     8     9     1 malignant
# ℹ 184 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-3-3" class="slide level2">
<h2>🐣 Case study 3</h2>
<ol start="4" type="1">
<li>From the above dataset obtain a <span class="hl-yellow"><strong>sample of 20% of the data</strong></span> (each record can be chosen with the same probability), and <span class="hl-yellow"><strong>sort them</strong></span> from highest to lowest by the variable <code>V1</code> and, in case of a tie, from lowest to highest by the variable <code>V2</code>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb514-2"><a href="#cb514-2"></a>biopsy <span class="sc">|&gt;</span> </span>
<span id="cb514-3"><a href="#cb514-3"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb514-4"><a href="#cb514-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(V1), V2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 129 × 11
   ID         V1    V2    V3    V4    V5    V6    V7    V8    V9 class    
   &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt;    
 1 752904     10     1     1     1     2    10     5     4     1 malignant
 2 1116998    10     4     2     1     3     2     4     3    10 malignant
 3 1206841    10     5     6    10     6    10     7     7    10 malignant
 4 846423     10     6     3     6     4    10     7     8     4 malignant
 5 659642     10     8     4     4     4    10     3    10     4 malignant
 6 1189286    10    10     8     6     4     5     8    10     1 malignant
 7 1257200    10    10    10     7    10    10     8     2     1 malignant
 8 529329     10    10    10    10    10    10     4    10    10 malignant
 9 1165926     9     6     9     2    10     6     2     9    10 malignant
10 1258549     9    10    10    10    10    10    10    10     1 malignant
# ℹ 119 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-4a" class="slide level2">
<h2>🐣 Case study 4a</h2>
<p>From the original starwars dataset, include a column that calculates the BMI. After that, create a new variable that values <code>NA</code> if not human, <code>thin</code> below 18, <code>normal</code> between 18 and 30, <code>overweight</code> above 30.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb516-2"><a href="#cb516-2"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> height <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb516-3"><a href="#cb516-3"></a>         <span class="at">BMI =</span> mass <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb516-4"><a href="#cb516-4"></a>         <span class="st">"human"</span> <span class="ot">=</span> <span class="fu">case_when</span>(species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb516-5"><a href="#cb516-5"></a>                             BMI <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="st">"thin"</span>,</span>
<span id="cb516-6"><a href="#cb516-6"></a>                             BMI <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb516-7"><a href="#cb516-7"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"overweight"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 16
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…   1.72    77 blond      fair       blue            19   male  mascu…
 2 C-3PO      1.67    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2      0.96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…   2.02   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…   1.5     49 brown      light      brown           19   fema… femin…
 6 Owen La…   1.78   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…   1.65    75 brown      light      blue            47   fema… femin…
 8 R5-D4      0.97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…   1.83    84 black      light      brown           24   male  mascu…
10 Obi-Wan…   1.82    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 7 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;, BMI &lt;dbl&gt;, human &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="case-study-4b" class="slide level2">
<h2>🐣 Case study 4b</h2>
<p>Let’s proceed to <span class="hl-yellow"><strong>create a table with data of voters</strong></span> of size <code>n = 30</code> where <span class="hl-yellow"><strong>simulate the voting intention and their incomes</strong></span></p>
<ol type="1">
<li>Create a <code>tibble</code> with two columns, one named <code>id_voter</code> and one named <code>party</code>. In the first case it should go from 1 to 30. In the second case, it simulates its voting intention so that there is a 0.5 chance of <code>PP</code> and 0.5 chance of <code>SUMAR</code> (Spanish political parties).</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb518-2"><a href="#cb518-2"></a>  <span class="fu">tibble</span>(<span class="st">"id_voter"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb518-3"><a href="#cb518-3"></a>         <span class="st">"party"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"PP"</span>, <span class="st">"SUMAR"</span>), <span class="at">size =</span> <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="case-study-4b-1" class="slide level2">
<h2>🐣 Case study 4b</h2>
<ol start="2" type="1">
<li>After knowing the voting intention, create a third column called <code>income</code> in which you simulate their gross annual income. We will assume that for PP’s voters, incomes follows a distribution <span class="math inline">\(N(\mu = 37000€, sigma = 800)\)</span> and that for SUMAR’s voters it follows a distribution <span class="math inline">\(N(\mu = 26000€, sigma = 1200)\)</span>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb519-2"><a href="#cb519-2"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb519-3"><a href="#cb519-3"></a>  <span class="fu">mutate</span>(<span class="st">"income"</span> <span class="ot">=</span></span>
<span id="cb519-4"><a href="#cb519-4"></a>           <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="fu">if_else</span>(party <span class="sc">==</span> <span class="st">"PP"</span>, <span class="dv">37000</span>, <span class="dv">26000</span>),</span>
<span id="cb519-5"><a href="#cb519-5"></a>                 <span class="at">sd =</span> <span class="fu">if_else</span>(party <span class="sc">==</span> <span class="st">"PP"</span>, <span class="dv">800</span>, <span class="dv">1200</span>)))</span>
<span id="cb519-6"><a href="#cb519-6"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
   id_voter party income
      &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
 1        1 PP    36594.
 2        2 PP    35928.
 3        3 PP    37742.
 4        4 SUMAR 27402.
 5        5 SUMAR 25858.
 6        6 PP    36699.
 7        7 PP    37654.
 8        8 PP    37619.
 9        9 SUMAR 26000.
10       10 SUMAR 23940.
# ℹ 20 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-5" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol type="1">
<li>Loads the billboard datatable from the <code>{tidyr}</code> package.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1"></a>billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 317 × 79
   artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8
   &lt;chr&gt;      &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA
 2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA
 3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53
 4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59
 5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49
 6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2
 7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA
 8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38
 9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14
10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58
# ℹ 307 more rows
# ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,
#   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,
#   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,
#   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,
#   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,
#   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="case-study-5-1" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="2" type="1">
<li>First of all, select only the <span class="hl-yellow"><strong>first 52 weeks</strong></span> (but also artist, track and date variables). After that convert the dataset to <span class="hl-yellow"><strong>tidydata</strong></span> with the appropriate formats and types for each variable</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1"></a>billboard_1 <span class="ot">&lt;-</span></span>
<span id="cb523-2"><a href="#cb523-2"></a>  billboard <span class="sc">|&gt;</span> </span>
<span id="cb523-3"><a href="#cb523-3"></a>  <span class="fu">select</span>(artist<span class="sc">:</span>date.entered, <span class="fu">num_range</span>(<span class="st">"wk"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb523-4"><a href="#cb523-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"wk1"</span><span class="sc">:</span><span class="st">"wk52"</span>, <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb523-5"><a href="#cb523-5"></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>, <span class="at">names_prefix =</span> <span class="st">"wk"</span>,</span>
<span id="cb523-6"><a href="#cb523-6"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb523-7"><a href="#cb523-7"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">as.numeric</span>(week))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Extracts the <span class="hl-yellow"><strong>list of distinct artists</strong></span> appearing in the table, including <span class="hl-yellow"><strong>how many times</strong></span> each appears.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb524-2"><a href="#cb524-2"></a>  <span class="fu">count</span>(artist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 228 × 2
   artist                  n
   &lt;chr&gt;               &lt;int&gt;
 1 2 Pac                   7
 2 2Ge+her                 3
 3 3 Doors Down           72
 4 504 Boyz               18
 5 98^0                   20
 6 A*Teens                 5
 7 Aaliyah                52
 8 Adams, Yolanda         20
 9 Adkins, Trace          11
10 Aguilera, Christina    67
# ℹ 218 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="case-study-5-2" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="4" type="1">
<li>Determines <span class="hl-yellow"><strong>how many songs each artist</strong></span> has</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb526-2"><a href="#cb526-2"></a>  <span class="fu">distinct</span>(artist, track) <span class="sc">|&gt;</span> </span>
<span id="cb526-3"><a href="#cb526-3"></a>  <span class="fu">count</span>(artist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 228 × 2
   artist                  n
   &lt;chr&gt;               &lt;int&gt;
 1 2 Pac                   1
 2 2Ge+her                 1
 3 3 Doors Down            2
 4 504 Boyz                1
 5 98^0                    1
 6 A*Teens                 1
 7 Aaliyah                 2
 8 Adams, Yolanda          1
 9 Adkins, Trace           1
10 Aguilera, Christina     3
# ℹ 218 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-5-3" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="5" type="1">
<li>Determines the <span class="hl-yellow"><strong>5 songs that appear in the charts the most weeks</strong></span>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb528-2"><a href="#cb528-2"></a>  <span class="fu">count</span>(track) <span class="sc">|&gt;</span></span>
<span id="cb528-3"><a href="#cb528-3"></a>  <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">5</span>, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  track                   n
  &lt;chr&gt;               &lt;int&gt;
1 Breathe                52
2 Kryptonite             52
3 With Arms Wide Open    47
4 Higher                 44
5 I Wanna Know           44</code></pre>
</div>
</div>
</section>
<section id="case-study-5-4" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="6" type="1">
<li>Determines <span class="hl-yellow"><strong>for each artist the song that appears the most weeks</strong></span>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb530-2"><a href="#cb530-2"></a>  <span class="fu">count</span>(artist, track) <span class="sc">|&gt;</span></span>
<span id="cb530-3"><a href="#cb530-3"></a>  <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">1</span>, n, <span class="at">by =</span> artist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 237 × 3
   artist              track                       n
   &lt;chr&gt;               &lt;chr&gt;                   &lt;int&gt;
 1 2 Pac               Baby Don't Cry (Keep...     7
 2 2Ge+her             The Hardest Part Of ...     3
 3 3 Doors Down        Kryptonite                 52
 4 504 Boyz            Wobble Wobble              18
 5 98^0                Give Me Just One Nig...    20
 6 A*Teens             Dancing Queen               5
 7 Aaliyah             Try Again                  32
 8 Adams, Yolanda      Open My Heart              20
 9 Adkins, Trace       More                       11
10 Aguilera, Christina What A Girl Wants          24
# ℹ 227 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-5-5" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="7" type="1">
<li>Determines the <span class="hl-yellow"><strong>artist with the most songs</strong></span> in the list</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb532-2"><a href="#cb532-2"></a>  <span class="fu">distinct</span>(artist, track) <span class="sc">|&gt;</span></span>
<span id="cb532-3"><a href="#cb532-3"></a>  <span class="fu">count</span>(artist) <span class="sc">|&gt;</span> </span>
<span id="cb532-4"><a href="#cb532-4"></a>  <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">1</span>, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  artist     n
  &lt;chr&gt;  &lt;int&gt;
1 Jay-Z      5</code></pre>
</div>
</div>
</section>
<section id="case-study-5-6" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="8" type="1">
<li>Calculates the <span class="hl-yellow"><strong>highest position</strong></span> that each song has been on. Calculates the highest position an artist has been in.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb534-2"><a href="#cb534-2"></a>  <span class="fu">slice_min</span>(rank, <span class="at">by =</span> track, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 316 × 5
   artist         track                   date.entered  week  rank
   &lt;chr&gt;          &lt;chr&gt;                   &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac          Baby Don't Cry (Keep... 2000-02-26       3    72
 2 2Ge+her        The Hardest Part Of ... 2000-09-02       2    87
 3 3 Doors Down   Kryptonite              2000-04-08      32     3
 4 3 Doors Down   Loser                   2000-10-21       7    55
 5 504 Boyz       Wobble Wobble           2000-04-15       4    17
 6 98^0           Give Me Just One Nig... 2000-08-19       7     2
 7 A*Teens        Dancing Queen           2000-07-08       4    95
 8 Aaliyah        I Don't Wanna           2000-01-29       6    35
 9 Aaliyah        Try Again               2000-03-18      14     1
10 Adams, Yolanda Open My Heart           2000-08-26       9    57
# ℹ 306 more rows</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb536-2"><a href="#cb536-2"></a>  <span class="fu">slice_min</span>(rank, <span class="at">by =</span> artist, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 228 × 5
   artist              track                   date.entered  week  rank
   &lt;chr&gt;               &lt;chr&gt;                   &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac               Baby Don't Cry (Keep... 2000-02-26       3    72
 2 2Ge+her             The Hardest Part Of ... 2000-09-02       2    87
 3 3 Doors Down        Kryptonite              2000-04-08      32     3
 4 504 Boyz            Wobble Wobble           2000-04-15       4    17
 5 98^0                Give Me Just One Nig... 2000-08-19       7     2
 6 A*Teens             Dancing Queen           2000-07-08       4    95
 7 Aaliyah             Try Again               2000-03-18      14     1
 8 Adams, Yolanda      Open My Heart           2000-08-26       9    57
 9 Adkins, Trace       More                    2000-04-29       8    65
10 Aguilera, Christina Come On Over Baby (A... 2000-08-05      11     1
# ℹ 218 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-5-7" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="9" type="1">
<li>Get a <span class="hl-yellow"><strong>summary table</strong></span> with the average ranking of each artist (counting only the highest ranking achieved by their songs), as well as the number of (different) songs they have placed in the top 100.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb538-2"><a href="#cb538-2"></a>  <span class="fu">slice_min</span>(rank, <span class="at">by =</span> track, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb538-3"><a href="#cb538-3"></a>  <span class="fu">summarise</span>(<span class="at">avg_rank =</span> <span class="fu">mean</span>(rank), <span class="at">n_songs =</span> <span class="fu">n</span>(), <span class="at">.by =</span> artist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 227 × 3
   artist              avg_rank n_songs
   &lt;chr&gt;                  &lt;dbl&gt;   &lt;int&gt;
 1 2 Pac                  72          1
 2 2Ge+her                87          1
 3 3 Doors Down           29          2
 4 504 Boyz               17          1
 5 98^0                    2          1
 6 A*Teens                95          1
 7 Aaliyah                18          2
 8 Adams, Yolanda         57          1
 9 Adkins, Trace          65          1
10 Aguilera, Christina     1.67       3
# ℹ 217 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-5-8" class="slide level2">
<h2>🐣 Case study 5</h2>
<ol start="10" type="1">
<li>Perform stratified random sampling, extracting 50% of the data but maintaining the proportion of data among the different quarters.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1"></a>billboard_1 <span class="sc">|&gt;</span> </span>
<span id="cb540-2"><a href="#cb540-2"></a>  <span class="fu">mutate</span>(<span class="at">q =</span> lubridate<span class="sc">::</span><span class="fu">quarter</span>(date.entered)) <span class="sc">|&gt;</span> </span>
<span id="cb540-3"><a href="#cb540-3"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.5</span>, <span class="at">by =</span> q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,639 × 6
   artist        track                   date.entered  week  rank     q
   &lt;chr&gt;         &lt;chr&gt;                   &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
 1 Kumbia Kings  U Don't Love Me         2000-03-04       9    89     1
 2 Braxton, Toni He Wasn't Man Enough    2000-03-18      23    13     1
 3 Jay-Z         Do It Again (Put Ya ... 2000-01-15       9    95     1
 4 Raye, Collin  Couldn't Last A Mome... 2000-03-18      12    46     1
 5 Thomas, Carl  I Wish                  2000-03-25      10    21     1
 6 Ginuwine      The Best Man I Can B... 2000-01-08       2    97     1
 7 Kid Rock      Only God Knows Why      2000-02-19       4    39     1
 8 Bega, Lou     Tricky Tricky           2000-01-29       3    87     1
 9 Aaliyah       I Don't Wanna           2000-01-29      14    49     1
10 Pink          There U Go              2000-03-04      25    20     1
# ℹ 2,629 more rows</code></pre>
</div>
</div>
</section>
<section id="importexport" class="slide level2">
<h2>Import/export</h2>
<p>So far we have only used data already loaded in packages but many times <span class="hl-yellow"><strong>we will need to import data externally</strong></span>. One of the main <span class="hl-yellow"><strong>strengths</strong></span> of <code>R</code> is that we can import data very easily in different formats:</p>
<ul>
<li><p><span class="hl-yellow"><strong>R native formats</strong></span>: <code>.rda</code>, <code>.RData</code> and <code>.rds</code> formats.</p></li>
<li><p><span class="hl-yellow"><strong>Rectangular (tabular) data</strong></span>: <code>.csv</code> and <code>.tsv</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Untabulated data</strong></span>: <code>.txt</code> format.</p></li>
<li><p><span class="hl-yellow"><strong>Data in excel</strong></span>: <code>.xls</code> and <code>.xlsx</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Data from SAS/Stata/SPSS</strong></span>: <code>.sas7bdat</code>, <code>.sav</code> and <code>.dat</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Data from Google Drive</strong></span></p></li>
<li><p><span class="hl-yellow"><strong>Data from API’s</strong></span>: aemet, catastro, twitter, spotify, etc.</p></li>
</ul>
</section>
<section id="r-native-formats" class="slide level2">
<h2>R native formats</h2>
<p>The <span class="hl-yellow"><strong>simplest</strong></span> files to import into <code>R</code> (and which usually take up less disk space) are its own <span class="hl-yellow"><strong>native extensions</strong></span>: files in <code>.RData</code>, <code>.rda</code> and <code>.rds</code> formats. To load the former we simply need to <span class="hl-yellow"><strong>use the native</strong></span> function <code>load()</code> by providing it the file path.</p>
<ul>
<li><code>RData</code> file: we are going to import a dataset with the different characteristics of the <span class="hl-purple"><strong>Titanic voyagers</strong></span>, including who survived and who died.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1"></a><span class="fu">load</span>(<span class="st">"./data/titanic.RData"</span>)</span>
<span id="cb542-2"><a href="#cb542-2"></a><span class="fu">as_tibble</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 12
  PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
        &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;fct&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;
1           1        0      3 Braund… male     22     1     0 A/5 2…  7.25 ""   
2           2        1      1 Cuming… fema…    38     1     0 PC 17… 71.3  "C85"
3           3        1      3 Heikki… fema…    26     0     0 STON/…  7.92 ""   
4           4        1      1 Futrel… fema…    35     1     0 113803 53.1  "C12…
5           5        0      3 Allen,… male     35     0     0 373450  8.05 ""   
# ℹ 1 more variable: Embarked &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="r-native-formats-1" class="slide level2">
<h2>R native formats</h2>
<ul>
<li><code>.rda</code> file: we will import a dataset with <span class="hl-purple"><strong>breast cancer data</strong></span> from <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-13-33"><strong>Royston and Altman (2013)</strong></a>, including 2982 patients and their characteristics.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1"></a><span class="fu">load</span>(<span class="st">"./data/rotterdam_breast_cancer.rda"</span>)</span>
<span id="cb544-2"><a href="#cb544-2"></a><span class="fu">as_tibble</span>(rotterdam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 15
    pid  year   age  meno size  grade nodes   pgr    er hormon chemo rtime recur
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
1     1  1992    74     1 &lt;=20      3     0    35   291      0     0  1799     0
2     2  1984    79     1 20-50     3     0    36   611      0     0  2828     0
3     3  1983    44     0 &lt;=20      2     0   138     0      0     0  6012     0
4     4  1985    70     1 20-50     3     0     0    12      0     0  2624     0
5     5  1983    75     1 &lt;=20      3     0   260   409      0     0  4915     0
6     6  1983    52     0 &lt;=20      3     0   139   303      0     0  5888     0
7     7  1993    40     0 &lt;=20      2     0    13     4      0     0  2491     0
# ℹ 2 more variables: dtime &lt;dbl&gt;, death &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="r-native-formats-2" class="slide level2">
<h2>R native formats</h2>
<ul>
<li><code>.rds</code> files: for this type we must use <code>readRDS()</code>, and we need to incorporate a <span class="hl-yellow"><strong>argument <code>file</code></strong></span> with the path. In this case we are going to import <span class="hl-purple"><strong>lung cancer data</strong></span> from the North Central Cancer Treatment Group.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1"></a>lung_cancer <span class="ot">&lt;-</span></span>
<span id="cb546-2"><a href="#cb546-2"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"./data/NCCTG_lung_cancer.rds"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 10
   inst  time status   age   sex ph.ecog ph.karno pat.karno meal.cal wt.loss
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1     3   306      2    74     1       1       90       100     1175      NA
2     3   455      2    68     1       0       90        90     1225      15
3     3  1010      1    56     1       0       90        90       NA      15
4     5   210      2    57     1       1       90        60     1150      11
5     1   883      2    60     1       0      100        90       NA       0</code></pre>
</div>
</div>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The <span class="hl-yellow"><strong>paths</strong></span> must always be <span class="hl-yellow"><strong>without spaces, ñ, or accents</strong></span>. And note that files loaded with <code>load()</code> are automatically loaded into the environment (with the originally saved name), but <code>read()</code> functions are only loaded locally (if not saved, they do not exist in the future).</p>
</div>
</div>
</div>
</section>
<section id="tabular-data-readr" class="slide level2">
<h2>Tabular data: readr</h2>
<p>The <code>{readr}</code> package within the <code>{tidyverse}</code> environment contains several useful functions for <span class="hl-yellow"><strong>loading rectangular data (without formatting)</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>read_csv()</code>: <code>.csv</code> files whose <span class="hl-purple"><strong>separator is comma</strong></span></li>
<li><code>read_csv2()</code>: <span class="hl-purple"><strong>semicolon</strong></span></li>
<li><code>read_tsv()</code>: <span class="hl-purple"><strong>tabulator</strong></span>.</li>
<li><code>read_table()</code>: <span class="hl-purple"><strong>space</strong></span>.</li>
<li><code>read_delim()</code>: generic function for <span class="hl-purple"><strong>character delimited files</strong></span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/data-import-readr.png"></p>
</div>
</div>
<p>All of them need as <strong>argument the file path</strong> plus <strong>other optional</strong> (skip header or not, decimals, etc). See more at <a href="https://readr.tidyverse.org/" class="uri">https://readr.tidyverse.org/</a></p>
</section>
<section id="tabular-data-.csv-.tsv" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>The main advantage of <code>{readr}</code> is that it <span class="hl-yellow"><strong>automates formatting</strong></span> to go from a flat (unformatted) file to a tibble (in rows and columns, with formatting).</p>
<div class="fragment">
<ul>
<li>File <code>.csv</code>: with <code>read_csv()</code> we will load <span class="hl-purple"><strong>comma separated</strong></span> files, passing as <span class="hl-yellow"><strong>argument the path</strong></span> in <code>file = ...</code>. Let’s import the <code>chickens.csv</code> dataset (about cartoon chickens, why not). If you look at the output it gives us the type of variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb548-2"><a href="#cb548-2"></a>chickens <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/chickens.csv"</span>)</span>
<span id="cb548-3"><a href="#cb548-3"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                               
1 Foghorn Leghorn         rooster         0 That's a joke, ah say, that's a jok…
2 Chicken Little          hen             3 The sky is falling!                 
3 Ginger                  hen            12 Listen. We'll either die free chick…
4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</div>
</section>
<section id="tabular-data-.csv-.tsv-1" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>The <span class="hl-yellow"><strong>variable format</strong></span> will normally be done <span class="hl-yellow"><strong>automatically</strong></span> by <code>read_csv()</code>, and we can query it with <code>spec()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1"></a><span class="fu">spec</span>(chickens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  chicken = col_character(),
  sex = col_character(),
  eggs_laid = col_double(),
  motto = col_character()
)</code></pre>
</div>
</div>
</section>
<section id="tabular-data-.csv-.tsv-2" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>Although it usually does it well automatically we can <span class="hl-yellow"><strong>specify the format explicitly</strong></span> in <code>col_types = list()</code> (in list format, with <code>col_xxx()</code> for each type of variable, for example one we will put it as qualitative or factor). We can even indicate that <span class="hl-yellow"><strong>variables we want to select</strong></span> (without occupying memory), by indicating it in <code>col_select = ...</code> (in list format, with <code>col_select = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb552"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb552-2"><a href="#cb552-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/chickens.csv"</span>,</span>
<span id="cb552-3"><a href="#cb552-3"></a>           <span class="at">col_types =</span> <span class="fu">list</span>(<span class="fu">col_character</span>(), <span class="fu">col_factor</span>(), <span class="fu">col_double</span>(), <span class="fu">col_character</span>()),</span>
<span id="cb552-4"><a href="#cb552-4"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(chicken, sex, eggs_laid))</span>
<span id="cb552-5"><a href="#cb552-5"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  chicken                 sex     eggs_laid
  &lt;chr&gt;                   &lt;fct&gt;       &lt;dbl&gt;
1 Foghorn Leghorn         rooster         0
2 Chicken Little          hen             3
3 Ginger                  hen            12
4 Camilla the Chicken     hen             7
5 Ernie The Giant Chicken rooster         0</code></pre>
</div>
</div>
</section>
<section id="untabulated-data-.txt" class="slide level2">
<h2>Untabulated data (.txt)</h2>
<p>What happens when the <span class="hl-red"><strong>separator is not correct</strong></span>?</p>
<div class="fragment">
<p>If we use <code>read_csv()</code> it expects the separator between columns to be a comma but, as you can see with the following <code>.txt</code>, it interprets everything as a single column: <span class="hl-yellow"><strong>has no comma and does not know where to separate</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/massey-rating.txt"</span>)</span>
<span id="cb554-2"><a href="#cb554-2"></a><span class="fu">dim</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   `UCC PAY LAZ KPK  RT   COF BIH DII ENG ACU Rank Team            Conf`
   &lt;chr&gt;                                                                
 1 1   1   1   1   1     1   1   1   1   1    1 Ohio St          B10    
 2 2   2   2   2   2     2   2   2   4   2    2 Oregon           P12    
 3 3   4   3   4   3     4   3   4   2   3    3 Alabama          SEC    
 4 4   3   4   3   4     3   5   3   3   4    4 TCU              B12    
 5 6   6   6   5   5     7   6   5   6  11    5 Michigan St      B10    
 6 7   7   7   6   7     6  11   8   7   8    6 Georgia          SEC    
 7 5   5   5   7   6     8   4   6   5   5    7 Florida St       ACC    
 8 8   8   9   9  10     5   7   7  10   7    8 Baylor           B12    
 9 9  11   8  13  11    11  12   9  14   9    9 Georgia Tech     ACC    
10 13  10  13  11   8     9  10  11   9  10   10 Mississippi      SEC   </code></pre>
</div>
</div>
</div>
</section>
<section id="untabulated-data-.txt-1" class="slide level2">
<h2>Untabulated data (.txt)</h2>
<p>To do this we have.</p>
<ul>
<li><p><code>read_csv2()</code> when the <span class="hl-yellow"><strong>separator is semicolon</strong></span>, <code>read_tsv()</code> when the <span class="hl-yellow"><strong>is a tab</strong></span> and <code>read_table()</code> when the <span class="hl-yellow"><strong>is a space</strong></span>.</p></li>
<li><p><code>read_delim()</code> in general.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">"./data/massey-rating.txt"</span>)</span>
<span id="cb558-2"><a href="#cb558-2"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
     UCC   PAY   LAZ   KPK    RT   COF   BIH   DII   ENG   ACU  Rank Team  Conf 
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1     1     1     1     1     1     1     1     1     1     1     1 Ohio  St   
 2     2     2     2     2     2     2     2     2     4     2     2 Oreg… P12  
 3     3     4     3     4     3     4     3     4     2     3     3 Alab… SEC  
 4     4     3     4     3     4     3     5     3     3     4     4 TCU   B12  
 5     6     6     6     5     5     7     6     5     6    11     5 Mich… St   
 6     7     7     7     6     7     6    11     8     7     8     6 Geor… SEC  
 7     5     5     5     7     6     8     4     6     5     5     7 Flor… St   
 8     8     8     9     9    10     5     7     7    10     7     8 Bayl… B12  
 9     9    11     8    13    11    11    12     9    14     9     9 Geor… Tech 
10    13    10    13    11     8     9    10    11     9    10    10 Miss… SEC  </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>Another key import package will be the <code>{readxl}</code> package for <span class="hl-yellow"><strong>importing data from Excel</strong></span>. Three functions will be key:</p>
<ul>
<li><code>read_xls()</code> specific to <code>.xls</code>, <code>read_xlsx()</code> specific to <code>.xlsx</code>.</li>
<li><code>read_excel()</code>: for both <code>.xls</code> and <code>.xlsx</code>.</li>
</ul>
<div class="fragment">
<p>We are going to import <code>deaths.xlsx</code> with celebrity death records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb560-2"><a href="#cb560-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>)</span>
<span id="cb560-3"><a href="#cb560-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    
7 Chuck Berry                  musician   90    TRUE     9788          42812    
8 Bill Paxton                  actor      61    TRUE     20226         42791    </code></pre>
</div>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-1" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    
7 Chuck Berry                  musician   90    TRUE     9788          42812    
8 Bill Paxton                  actor      61    TRUE     20226         42791    </code></pre>
</div>
</div>
<p>One thing that is <span class="hl-yellow"><strong>very common misfortune</strong></span> is that there is some kind of comment or text at the beginning of the file, having to <span class="hl-yellow"><strong>skip those rows</strong></span>.</p>
</section>
<section id="excel-data-.xls-.xlsx-2" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>We can <span class="hl-yellow"><strong>skip these rows</strong></span> directly in the load with <code>skip = ...</code> (indicating the number of rows to skip).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb564-2"><a href="#cb564-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb564-3"><a href="#cb564-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  Name          Profession Age   `Has kids` `Date of birth`     `Date of death`
  &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;chr&gt;          
1 David Bowie   musician   69    TRUE       1947-01-08 00:00:00 42379          
2 Carrie Fisher actor      60    TRUE       1956-10-21 00:00:00 42731          
3 Chuck Berry   musician   90    TRUE       1926-10-18 00:00:00 42812          
4 Bill Paxton   actor      61    TRUE       1955-05-17 00:00:00 42791          
5 Prince        musician   57    TRUE       1958-06-07 00:00:00 42481          </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-3" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>In addition with <code>col_names = ...</code> we can already rename the columns in the import (if <span class="hl-yellow"><strong>provide names assumes 1st line already as a data</strong></span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb566" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1"></a>deaths <span class="ot">&lt;-</span></span>
<span id="cb566-2"><a href="#cb566-2"></a>  <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>,</span>
<span id="cb566-3"><a href="#cb566-3"></a>            <span class="at">skip =</span> <span class="dv">5</span>,</span>
<span id="cb566-4"><a href="#cb566-4"></a>            <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"profession"</span>, <span class="st">"age"</span>, <span class="st">"kids"</span>, <span class="st">"birth"</span>, <span class="st">"death"</span>))</span>
<span id="cb566-5"><a href="#cb566-5"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  name               profession age   kids  birth               death
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;
1 David Bowie        musician   69    TRUE  1947-01-08 00:00:00 42379
2 Carrie Fisher      actor      60    TRUE  1956-10-21 00:00:00 42731
3 Chuck Berry        musician   90    TRUE  1926-10-18 00:00:00 42812
4 Bill Paxton        actor      61    TRUE  1955-05-17 00:00:00 42791
5 Prince             musician   57    TRUE  1958-06-07 00:00:00 42481
6 Alan Rickman       actor      69    FALSE 1946-02-21 00:00:00 42383
7 Florence Henderson actor      82    TRUE  1934-02-14 00:00:00 42698</code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-4" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>Sometimes <span class="hl-red"><strong>Excel dates are incorrectly formatted</strong></span> (surprise): we can use <code>convertToDate()</code> from the <code>{openxlsx}</code> package to convert it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb568-2"><a href="#cb568-2"></a>deaths<span class="sc">$</span>death <span class="ot">&lt;-</span> <span class="fu">convertToDate</span>(deaths<span class="sc">$</span>death)</span>
<span id="cb568-3"><a href="#cb568-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  name               profession age   kids  birth               death     
  &lt;chr&gt;              &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;date&gt;    
1 David Bowie        musician   69    TRUE  1947-01-08 00:00:00 2016-01-10
2 Carrie Fisher      actor      60    TRUE  1956-10-21 00:00:00 2016-12-27
3 Chuck Berry        musician   90    TRUE  1926-10-18 00:00:00 2017-03-18
4 Bill Paxton        actor      61    TRUE  1955-05-17 00:00:00 2017-02-25
5 Prince             musician   57    TRUE  1958-06-07 00:00:00 2016-04-21
6 Alan Rickman       actor      69    FALSE 1946-02-21 00:00:00 2016-01-14
7 Florence Henderson actor      82    TRUE  1934-02-14 00:00:00 2016-11-24</code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-5" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>We can also <span class="hl-yellow"><strong>load an Excel with several sheets</strong></span>: to <span class="hl-yellow"><strong>indicate the sheet</strong></span> (either by its name or by its number) we will use the argument <code>sheet = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1"></a>mtcars <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mtcars"</span>)</span>
<span id="cb570-2"><a href="#cb570-2"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</code></pre>
</div>
</div>
<div class="fragment">
<p>We can even indicate the <span class="hl-yellow"><strong>range of cells</strong></span> to load with <code>range = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"iris"</span>, <span class="at">range =</span> <span class="st">"C1:E4"</span>)</span>
<span id="cb572-2"><a href="#cb572-2"></a>iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          1.4         0.2 setosa 
2          1.4         0.2 setosa 
3          1.3         0.2 setosa </code></pre>
</div>
</div>
</div>
</section>
<section id="importing-from-sasstataspss" class="slide level2">
<h2>Importing from SAS/STATA/SPSS</h2>
<p>The <code>{haven}</code> package within the tidyverse orbit will allow us to <span class="hl-yellow"><strong>import files from the 3 most important payment software</strong></span>: SAS, SPSS and Stata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb574-2"><a href="#cb574-2"></a></span>
<span id="cb574-3"><a href="#cb574-3"></a><span class="co"># SAS</span></span>
<span id="cb574-4"><a href="#cb574-4"></a>iris_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="at">data_file =</span> <span class="st">"./data/iris.sas7bdat"</span>)</span>
<span id="cb574-5"><a href="#cb574-5"></a></span>
<span id="cb574-6"><a href="#cb574-6"></a><span class="co"># SPSS</span></span>
<span id="cb574-7"><a href="#cb574-7"></a>iris_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="at">file =</span> <span class="st">"./data/iris.sav"</span>)</span>
<span id="cb574-8"><a href="#cb574-8"></a></span>
<span id="cb574-9"><a href="#cb574-9"></a><span class="co"># Stata</span></span>
<span id="cb574-10"><a href="#cb574-10"></a>iris_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file =</span> <span class="st">"./data/iris.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="export" class="slide level2">
<h2>Export</h2>
<p>In the same way that we can import we can also <span class="hl-yellow"><strong>export</strong></span></p>
<ul>
<li>exported in <code>.RData</code> (recommended option for variables stored in <code>R</code>). Remember that this extension <span class="hl-yellow"><strong>can only be used in <code>R</code></strong></span>. To do so, just use <code>save(object, file = path)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb575-2"><a href="#cb575-2"></a><span class="fu">save</span>(table, <span class="at">file =</span> <span class="st">"./data/table.RData"</span>)</span>
<span id="cb575-3"><a href="#cb575-3"></a><span class="fu">rm</span>(table) <span class="co"># eliminar</span></span>
<span id="cb575-4"><a href="#cb575-4"></a><span class="fu">load</span>(<span class="st">"./data/table.RData"</span>)</span>
<span id="cb575-5"><a href="#cb575-5"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="export-1" class="slide level2">
<h2>Export</h2>
<p>In the same way that we can import we can also <span class="hl-yellow"><strong>export</strong></span></p>
<ul>
<li>exported in <code>.csv</code>. To do this we simply use <code>write_csv(object, file = path)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb577"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1"></a><span class="fu">write_csv</span>(table, <span class="at">file =</span> <span class="st">"./data/table.csv"</span>)</span>
<span id="cb577-2"><a href="#cb577-2"></a><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/table.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="directly-from-website" class="slide level2">
<h2>Directly from website</h2>
<p>One of the main advantages of <code>R</code> is that we can make use of all the previous functions of <span class="hl-yellow"><strong>import but directly from a web</strong></span>, without the need to perform the manual download: instead of passing it the local path we will indicate the <span class="hl-yellow"><strong>link</strong></span>. For example, we are going to download the covid data from ISCIII (<a href="https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos" class="uri">https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1"></a>covid_data <span class="ot">&lt;-</span></span>
<span id="cb579-2"><a href="#cb579-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>, <span class="at">n_max =</span> <span class="dv">700</span>)</span>
<span id="cb579-3"><a href="#cb579-3"></a>covid_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-from-google-drive" class="slide level2">
<h2>Importing from google drive</h2>
<p>Another option available (especially if we work with other people working) is to <span class="hl-yellow"><strong>import from a Google Drive spreadsheet</strong></span>, making use of <code>read_sheet()</code> from the <code>{googlesheets4}</code> package.</p>
<p>The first time you will be asked for a tidyverse permission to interact with your drive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb580"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb580-2"><a href="#cb580-2"></a>google_sheet <span class="ot">&lt;-</span></span>
<span id="cb580-3"><a href="#cb580-3"></a>  <span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1n_UTbD93-oDJR2r-rsMNff5ro147NL_ZN_vYIA2eJ3Q/edit?usp=sharing"</span>)</span>
<span id="cb580-4"><a href="#cb580-4"></a>google_sheet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-from-api-owid" class="slide level2">
<h2>Importing from API (owid)</h2>
<p>Another interesting option is the <span class="hl-yellow"><strong>data download from an API</strong></span>: an intermediary between an app or data provider and our <code>R</code>. For example, let’s load the <code>{owidR}</code> library, which allows us to download data from the web <a href="https://ourworldindata.org/" class="uri">https://ourworldindata.org/</a>. The <code>owid_covid()</code> function loads without realizing it more than 300 000 records with more than 50 variables from 238 countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1"></a><span class="fu">library</span>(owidR)</span>
<span id="cb581-2"><a href="#cb581-2"></a><span class="fu">owid_covid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="importing-from-owid" class="slide level2">
<h2>Importing from (owid)</h2>
<p>This package has the <code>owid_search()</code> function to search datasets by keywords, for example, <code>emissions</code>, giving us a dataset with the title of the database and its id for later use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1"></a><span class="fu">as_tibble</span>(<span class="fu">owid_search</span>(<span class="st">"emissions"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="fragment">
<p>Let’s ask you for example for the <span class="hl-yellow"><strong>oecd emissions</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb583"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1"></a><span class="fu">owid</span>(<span class="st">"emissions-of-air-pollutants-oecd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</div>
</section>
<section id="importing-from-api-aemet" class="slide level2">
<h2>Importing from API (aemet)</h2>
<p>In many occasions to connect to the API we will first have to <span class="hl-yellow"><strong>register and obtain a key</strong></span>, this is the case of the <code>{climaemet}</code> package to access meteorological data (<a href="https://opendata.aemet.es/centrodedescargas/inicio" class="uri">https://opendata.aemet.es/centrodedescargas/inicio</a>).</p>
<p>Once we have the API key we register it in our RStudio to be able to use it in the future.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1"></a><span class="fu">library</span>(climaemet)</span>
<span id="cb584-2"><a href="#cb584-2"></a></span>
<span id="cb584-3"><a href="#cb584-3"></a><span class="co"># Api key</span></span>
<span id="cb584-4"><a href="#cb584-4"></a>apikey <span class="ot">&lt;-</span> <span class="st">"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJqYXZhbHYwOUB1Y20uZXMiLCJqdGkiOiI4YTU1ODUxMS01MTE3LTQ4MTYtYmM4OS1hYmVkNDhiODBkYzkiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTY2NjQ2OTcxNSwidXNlcklkIjoiOGE1NTg1MTEtNTExNy00ODE2LWJjODktYWJlZDQ4YjgwZGM5Iiwicm9sZSI6IiJ9.HEMR77lZy2ASjmOxJa8ppx2J8Za1IViurMX3p1reVBU"</span></span>
<span id="cb584-5"><a href="#cb584-5"></a></span>
<span id="cb584-6"><a href="#cb584-6"></a><span class="fu">aemet_api_key</span>(apikey, <span class="at">install =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="importing-from-aemet" class="slide level2">
<h2>Importing from (aemet)</h2>
<p>With this package we can do a <span class="hl-yellow"><strong>search for stations</strong></span> to know both its postal code and its identifier code within the AEMET network (for example, the station of the airport of El Prat, Barcelona, is the code <code>"0076"</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">aemet_stations</span>()</span>
<span id="cb585-2"><a href="#cb585-2"></a>stations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb586"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1"></a><span class="fu">aemet_last_obs</span>(<span class="st">"0076"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="tu-turno-6" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-13-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-13-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-13-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<p>📝 The <code>who</code> dataset we have used in previous exercises, export it to a native <code>R</code> format in the <code>data</code> folder of the project</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb587-2"><a href="#cb587-2"></a><span class="fu">save</span>(who, <span class="at">file =</span> <span class="st">"./data/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-2">
<p>📝 Loads the <code>who</code> dataset but from the data folder (import the file created in the previous exercise)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb588"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1"></a><span class="fu">load</span>(<span class="st">"./data/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-3">
<p>📝 Repeats the same (export and import) in 4 formats: <code>.csv</code>, <code>.xlsx</code>, <code>.sav</code> (spss) and <code>.dta</code> (stata)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb589"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1"></a><span class="co"># csv</span></span>
<span id="cb589-2"><a href="#cb589-2"></a><span class="fu">library</span>(readr)</span>
<span id="cb589-3"><a href="#cb589-3"></a><span class="fu">write_csv</span>(who, <span class="at">file =</span> <span class="st">"./data/who.csv"</span>)</span>
<span id="cb589-4"><a href="#cb589-4"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/who.csv"</span>)</span>
<span id="cb589-5"><a href="#cb589-5"></a></span>
<span id="cb589-6"><a href="#cb589-6"></a><span class="co"># excel</span></span>
<span id="cb589-7"><a href="#cb589-7"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb589-8"><a href="#cb589-8"></a><span class="fu">write.xlsx</span>(who, <span class="at">file =</span> <span class="st">"./data/who.xlsx"</span>)</span>
<span id="cb589-9"><a href="#cb589-9"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/who.xlsx"</span>)</span>
<span id="cb589-10"><a href="#cb589-10"></a></span>
<span id="cb589-11"><a href="#cb589-11"></a><span class="co"># sas y stata</span></span>
<span id="cb589-12"><a href="#cb589-12"></a><span class="fu">library</span>(haven)</span>
<span id="cb589-13"><a href="#cb589-13"></a><span class="fu">write_sav</span>(who, <span class="at">path =</span> <span class="st">"./data/who.sav"</span>)</span>
<span id="cb589-14"><a href="#cb589-14"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="at">path =</span> <span class="st">"./data/who.sav"</span>)</span>
<span id="cb589-15"><a href="#cb589-15"></a></span>
<span id="cb589-16"><a href="#cb589-16"></a><span class="fu">write_dta</span>(who, <span class="at">path =</span> <span class="st">"./data/who.dta"</span>)</span>
<span id="cb589-17"><a href="#cb589-17"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">path =</span> <span class="st">"./data/who.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-4">
<p>📝 Repeat the loading of <code>who.csv</code> but only select the first 4 columns already in the load.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1"></a>who_select <span class="ot">&lt;-</span></span>
<span id="cb590-2"><a href="#cb590-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/who.csv"</span>,</span>
<span id="cb590-3"><a href="#cb590-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"iso2"</span>, <span class="st">"iso3"</span>, <span class="st">"year"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="case-6" class="slide level2">
<h2>🐣 Case study 6</h2>
<p>In the data folder you have the dataset <code>breast-cancer-wisconsin-data.csv</code>. Create a <code>.qmd</code> file and customize it to include the following:</p>
<ol type="1">
<li>Import the csv file into a <code>tibble</code>. Is it tidydata? How many patients and variables do we have?</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>The dataset represents breast cancer data (<code>id</code> identifier, <code>diagnosis</code> the malignant/benign diagnosis and all other tumor properties). What % had a malignant tumor and what % a benign one?</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Which of the two types of tumors have, on average, a higher radius?</li>
</ol>
</div>
</section>
<section id="case-study-6" class="slide level2">
<h2>🐣 Case study 6</h2>
<ol start="4" type="1">
<li>Seek the help of the <code>t.test()</code> function. This function allows us to test whether or not the means of two distributions are equal. Can we reject the null hypothesis that the radius means are the same, under a significance of <span class="math inline">\(alpha = 0.05\)</span>?</li>
</ol>
</section></section>
<section>
<section id="clase-7" class="title-slide slide level1 center">
<h1>Lesson 7: functions</h1>
<p><span style="color:#444442;"><strong>Functions</strong></span></p>
</section>
<section id="summary-1" class="slide level2">
<h2>Summary</h2>
<p>Let’s make a brief summary of what we have learned up to now</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 1</strong></span>: main concepts about how R works (operating with vectors)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 2</strong></span>: how to store data (first databases and tidy data)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 3</strong></span>: first operations by rows with tidyverse (filter, slice_max, slice_min, slice, slice_sample, drop_na, arrange, distinct)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 4</strong></span>: first operations by columns with tidyverse (select, relocate, mutate)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 5</strong></span>: generating first summaries (count, group_by, summarise) and reports (Quarto)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Lesson 6</strong></span>: import/export files (load, read_csv, read_xlsx, save, write_csv, write_xls, write_xlsx)</li>
</ul>
</div>
</section>
<section id="functions" class="slide level2">
<h2>Functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>.</p>
<p>How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s take a look at its <strong>basic scheme</strong>:</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Name</strong></span>: for example <code>name_fun</code> (no spaces or strange characters). To the name we <span class="hl-yellow"><strong>assign the reserved word</strong></span> <code>function()</code> .</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Define <span class="hl-yellow"><strong>input arguments</strong></span> (inside <code>function()</code>).</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(input1, input2, ...) {</span>
<span id="cb591-2"><a href="#cb591-2"></a>  </span>
<span id="cb591-3"><a href="#cb591-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="functions-1" class="slide level2">
<h2>Functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>.</p>
<p>How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s look at its <strong>basic scheme</strong>:</p>
<ul>
<li><span class="hl-yellow"><strong>Body</strong></span> function inside <code>{ }</code>.</li>
</ul>
<div class="fragment">
<ul>
<li>We end the function with the <span class="hl-yellow"><strong>output</strong></span> arguments with <code>return()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(input1, input2, ...) {</span>
<span id="cb592-2"><a href="#cb592-2"></a>  </span>
<span id="cb592-3"><a href="#cb592-3"></a>  <span class="co"># Code</span></span>
<span id="cb592-4"><a href="#cb592-4"></a>  code</span>
<span id="cb592-5"><a href="#cb592-5"></a>  </span>
<span id="cb592-6"><a href="#cb592-6"></a>  <span class="co"># Output</span></span>
<span id="cb592-7"><a href="#cb592-7"></a>  <span class="fu">return</span>(var_output)</span>
<span id="cb592-8"><a href="#cb592-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="functions-2" class="slide level2">
<h2>Functions</h2>
<ul>
<li><p><code>input1, input2, ...</code>: will be the <span class="hl-yellow"><strong>input arguments</strong></span>, the arguments that the function takes to execute the code inside it.</p></li>
<li><p><code>code</code>: lines of code that we want to <span class="hl-yellow"><strong>execute the function</strong></span>.</p></li>
<li><p><code>return(var_output)</code>: the <span class="hl-yellow"><strong>output arguments</strong></span> will be entered.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb593"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(input1, input2, ...) {</span>
<span id="cb593-2"><a href="#cb593-2"></a>  </span>
<span id="cb593-3"><a href="#cb593-3"></a>  <span class="co"># Code</span></span>
<span id="cb593-4"><a href="#cb593-4"></a>  code</span>
<span id="cb593-5"><a href="#cb593-5"></a>  </span>
<span id="cb593-6"><a href="#cb593-6"></a>  <span class="co"># Output</span></span>
<span id="cb593-7"><a href="#cb593-7"></a>  <span class="fu">return</span>(var_output)</span>
<span id="cb593-8"><a href="#cb593-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>All variables that we define inside the function are <span class="hl-yellow"><strong>local variables: they will only exist inside the function</strong></span> unless we specify otherwise.</p>
</div>
</div>
</div>
</section>
<section id="functions-3" class="slide level2">
<h2>Functions</h2>
<p>Let’s look at a very simple example of a function for <span class="hl-yellow"><strong>calculate the area of a rectangle</strong></span>.</p>
<div class="fragment">
<p>Since the area of a rectangle is calculated as the <strong>product of its sides</strong>, we will need just that, its sides: those will be the <span class="hl-yellow"><strong>input arguments</strong></span> and the <span class="hl-purple"><strong>value to return</strong></span> will be just its <strong>area</strong> (<span class="math inline">\(side_1 * side_2\)</span>).</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb594"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1"></a><span class="co"># Definition</span></span>
<span id="cb594-2"><a href="#cb594-2"></a>calc_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb594-3"><a href="#cb594-3"></a>  </span>
<span id="cb594-4"><a href="#cb594-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb594-5"><a href="#cb594-5"></a>  <span class="fu">return</span>(area)</span>
<span id="cb594-6"><a href="#cb594-6"></a>  </span>
<span id="cb594-7"><a href="#cb594-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="functions-4" class="slide level2">
<h2>Functions</h2>
<p>We can also do a direct definition, <strong>without storing variables along the way</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1"></a><span class="co"># Definition</span></span>
<span id="cb595-2"><a href="#cb595-2"></a>calc_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb595-3"><a href="#cb595-3"></a>  </span>
<span id="cb595-4"><a href="#cb595-4"></a>  <span class="fu">return</span>(side_1 <span class="sc">*</span> side_2)</span>
<span id="cb595-5"><a href="#cb595-5"></a>  </span>
<span id="cb595-6"><a href="#cb595-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="hl-yellow"><strong>How to apply the function?</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb596"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1"></a><span class="fu">calc_area</span>(<span class="dv">5</span>, <span class="dv">3</span>) <span class="co"># rectangle 5 x 3 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb598"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1"></a><span class="fu">calc_area</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="co"># rectangle 1 x 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</section>
<section id="default-inputs" class="slide level2">
<h2>Default inputs</h2>
<p>Imagine now that we realize that 90% of the time we use this function to <span class="hl-yellow"><strong>default calculate the area of a square</strong></span> (i.e.&nbsp;we only need one side). To do this, we can define <span class="hl-yellow"><strong>default arguments</strong></span> in the function: they will take that value unless we assign another one.</p>
<p>Why not assign <code>side_2 = side_1</code> by default, to save lines of code and time?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1"></a>calc_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb600-2"><a href="#cb600-2"></a>  </span>
<span id="cb600-3"><a href="#cb600-3"></a>  <span class="co"># Code</span></span>
<span id="cb600-4"><a href="#cb600-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb600-5"><a href="#cb600-5"></a>  </span>
<span id="cb600-6"><a href="#cb600-6"></a>  <span class="co"># Result</span></span>
<span id="cb600-7"><a href="#cb600-7"></a>  <span class="fu">return</span>(area)</span>
<span id="cb600-8"><a href="#cb600-8"></a>  </span>
<span id="cb600-9"><a href="#cb600-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="default-inputs-1" class="slide level2">
<h2>Default inputs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb601"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1"></a>calc_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb601-2"><a href="#cb601-2"></a>  </span>
<span id="cb601-3"><a href="#cb601-3"></a>  <span class="co"># Code</span></span>
<span id="cb601-4"><a href="#cb601-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb601-5"><a href="#cb601-5"></a>  </span>
<span id="cb601-6"><a href="#cb601-6"></a>  <span class="co"># Result</span></span>
<span id="cb601-7"><a href="#cb601-7"></a>  <span class="fu">return</span>(area)</span>
<span id="cb601-8"><a href="#cb601-8"></a>  </span>
<span id="cb601-9"><a href="#cb601-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now <span class="hl-yellow"><strong>default</strong></span> the second side will be equal to the first (if added it will use both).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb602"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1"></a><span class="fu">calc_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>) <span class="co"># square</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb604"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1"></a><span class="fu">calc_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>, <span class="at">side_2 =</span> <span class="dv">7</span>) <span class="co"># rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35</code></pre>
</div>
</div>
</section>
<section id="multiple-output" class="slide level2">
<h2>Multiple output</h2>
<p>Let’s complicate the function a bit and add in the output the values of each side, labeled <code>side_1</code> and <code>side_2</code>, <span class="hl-yellow"><strong>packing the output in a list</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1"></a><span class="co"># Definition</span></span>
<span id="cb606-2"><a href="#cb606-2"></a>calc_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb606-3"><a href="#cb606-3"></a>  </span>
<span id="cb606-4"><a href="#cb606-4"></a>  <span class="co"># Code</span></span>
<span id="cb606-5"><a href="#cb606-5"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb606-6"><a href="#cb606-6"></a>  <span class="co"># Result</span></span>
<span id="cb606-7"><a href="#cb606-7"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"area"</span> <span class="ot">=</span> area, <span class="st">"side_1"</span> <span class="ot">=</span> side_1, <span class="st">"side_2"</span> <span class="ot">=</span> side_2))</span>
<span id="cb606-8"><a href="#cb606-8"></a>  </span>
<span id="cb606-9"><a href="#cb606-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>All the variables that we define inside the function are <span class="hl-yellow"><strong>local variables: they will only exist inside</strong></span></p>
</div>
</div>
</div>
</section>
<section id="introduction-to-lists" class="slide level2">
<h2>Introduction to lists</h2>
<p>Let’s see a small summary of the data we already know:</p>
<ul>
<li><p><span class="hl-yellow"><strong>vectors</strong></span>: collection of elements of the same type. They can be numbers, characters or logical values, among others.</p></li>
<li><p><span class="hl-yellow"><strong>matrices</strong></span>: BIDIMENSIONAL collection of elements of equal type and equal length.</p></li>
<li><p><span class="hl-yellow"><strong>data.frame / tibble</strong></span>: BIDIMENSIONAL collection of elements of equal length but of any type.</p></li>
</ul>
<div class="fragment">
<p>The <span class="hl-yellow"><strong>lists</strong></span> will be <span class="hl-purple"><strong>collections of variables of different type and different length</strong></span>, with totally heterogeneous structures (even a list can have inside it another list).</p>
</div>
</section>
<section id="introduction-to-lists-1" class="slide level2">
<h2>Introduction to lists</h2>
<p>Let’s create <span class="hl-yellow"><strong>our first list</strong></span> with <code>list()</code> with three elements: our parents’ names, our place of birth and our siblings’ ages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb607"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1"></a>var_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Paloma"</span>, <span class="st">"Gregorio"</span>)</span>
<span id="cb607-2"><a href="#cb607-2"></a>var_2 <span class="ot">&lt;-</span> <span class="st">"Madrid"</span></span>
<span id="cb607-3"><a href="#cb607-3"></a>var_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">26</span>)</span>
<span id="cb607-4"><a href="#cb607-4"></a></span>
<span id="cb607-5"><a href="#cb607-5"></a>list_example <span class="ot">&lt;-</span></span>
<span id="cb607-6"><a href="#cb607-6"></a>  <span class="fu">list</span>(<span class="st">"parents"</span> <span class="ot">=</span> var_1, <span class="st">"birth_place"</span> <span class="ot">=</span> var_2,</span>
<span id="cb607-7"><a href="#cb607-7"></a>       <span class="st">"siblings_ages"</span> <span class="ot">=</span> var_3)</span>
<span id="cb607-8"><a href="#cb607-8"></a>list_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$parents
[1] "Paloma"   "Gregorio"

$birth_place
[1] "Madrid"

$siblings_ages
[1] 25 30 26</code></pre>
</div>
</div>
</section>
<section id="introduction-to-lists-2" class="slide level2">
<h2>Introduction to lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb609"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb609-1"><a href="#cb609-1"></a><span class="fu">length</span>(list_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>If you look at the object we have defined as a list, its <span class="hl-yellow"><strong>length</strong></span> is 3 because we have <strong>stored three elements</strong>: a vector of characters (of length 2), a character (vector of length 1), and a vector of numbers (of length 3).</p>
<div class="fragment">
<p>We have stored elements of <span class="hl-yellow"><strong>different type</strong></span> (something we could already do) but, in addition, of <strong>different lengths</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb611"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1"></a><span class="fu">dim</span>(list_example) <span class="co"># NULL since we do not have a bidim object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1"></a><span class="fu">class</span>(list_example) <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
</div>
</section>
<section id="introduction-to-lists-3" class="slide level2">
<h2>Introduction to lists</h2>
<p>If we put them together with a <code>tibble()</code>, since they have different lengths, we would get an <span class="hl-red"><strong>error</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb615"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb615-2"><a href="#cb615-2"></a><span class="fu">tibble</span>(<span class="st">"parents"</span> <span class="ot">=</span> var_1,</span>
<span id="cb615-3"><a href="#cb615-3"></a>       <span class="st">"birth_place"</span> <span class="ot">=</span> var_2,</span>
<span id="cb615-4"><a href="#cb615-4"></a>       <span class="st">"siblings_ages"</span> <span class="ot">=</span> var_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `tibble()`:
! Tibble columns must have compatible sizes.
• Size 2: Existing data.
• Size 3: Column `siblings_ages`.
ℹ Only values of size one are recycled.</code></pre>
</div>
</div>
</section>
<section id="introduction-to-lists-4" class="slide level2">
<h2>Introduction to lists</h2>
<ul>
<li><span class="hl-yellow"><strong>Access by index</strong></span>: with the operator <code>[[i]]</code> we access the <strong>i-th element</strong> of the list.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb617"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1"></a>list_example[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Paloma"   "Gregorio"</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Access by name</strong></span>: with the operator <code>$element_name</code> we access by its name.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb619"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1"></a>list_example<span class="sc">$</span>parents</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Paloma"   "Gregorio"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>In contrast, the <span class="hl-yellow"><strong>single bracket</strong></span> allows us to access <span class="hl-yellow"><strong>several elements</strong></span> at a time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1"></a><span class="co"># Many elements</span></span>
<span id="cb621-2"><a href="#cb621-2"></a>list_example[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$parents
[1] "Paloma"   "Gregorio"

$birth_place
[1] "Madrid"</code></pre>
</div>
</div>
</div>
</section>
<section id="multiple-output-1" class="slide level2">
<h2>Multiple output</h2>
<p>Before, we did not care about the order of the arguments, but now the <span class="hl-yellow"><strong>order of the input arguments matters</strong></span>, since we include <code>side_1</code> and <code>side_2</code> in the output.</p>
<div class="fragment">
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>It is highly recommended to make the function call <span class="hl-yellow"><strong>explicitly stating the arguments</strong></span> to improve <strong>legibility and interpretability</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1"></a><span class="co"># Same as calc_area(5, 3)</span></span>
<span id="cb623-2"><a href="#cb623-2"></a><span class="fu">calc_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>, <span class="at">side_2 =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$area
[1] 15

$side_1
[1] 5

$side_2
[1] 3</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="own-functions-knowledge" class="slide level2">
<h2>Own functions: knowledge</h2>
<p>It seems silly what we have done, but we have crossed an important frontier: we have gone from <span class="hl-yellow"><strong>consuming knowledge</strong></span> (code from other packages, elaborated by others), to <span class="hl-purple"><strong>generating knowledge</strong></span>, creating our own functions.</p>
</section>
<section id="local-vs-global-variables" class="slide level2">
<h2>Local vs global variables</h2>
<p>An important aspect to think about with functions: what happens if we <span class="hl-yellow"><strong>name a variable inside</strong></span> a function to which we have <strong>forgotten to assign</strong> a value inside?</p>
<div class="fragment">
<p>We must be cautious when using functions in <code>R</code>, since due to the <span class="hl-yellow"><strong>“lexicographic rule”</strong></span>, if a variable is not defined inside the function, <code>R</code> will <span class="hl-purple"><strong>look for such a variable in the environment</strong></span> of variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb625-2"><a href="#cb625-2"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb625-3"><a href="#cb625-3"></a>    </span>
<span id="cb625-4"><a href="#cb625-4"></a>  <span class="fu">print</span>(x) <span class="co"># No output</span></span>
<span id="cb625-5"><a href="#cb625-5"></a>}</span>
<span id="cb625-6"><a href="#cb625-6"></a><span class="fu">fun_example</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section>
<section id="local-vs-global-variables-1" class="slide level2">
<h2>Local vs global variables</h2>
<p>If a variable <span class="hl-yellow"><strong>is already defined outside the function (global environment)</strong></span>, and is also used inside changing its value, the value <span class="hl-yellow"><strong>only changes inside</strong></span> but <span class="hl-red"><strong>not in the global environment</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb627-2"><a href="#cb627-2"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb627-3"><a href="#cb627-3"></a>    </span>
<span id="cb627-4"><a href="#cb627-4"></a>  x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb627-5"><a href="#cb627-5"></a>  <span class="fu">print</span>(x) <span class="co"># what is assigned inside</span></span>
<span id="cb627-6"><a href="#cb627-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb628"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1"></a><span class="co"># what is assigned inside</span></span>
<span id="cb628-2"><a href="#cb628-2"></a><span class="fu">fun_example</span>() <span class="co">#&lt;&lt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1"></a><span class="co"># what is assigned outside</span></span>
<span id="cb630-2"><a href="#cb630-2"></a><span class="fu">print</span>(x) <span class="co">#&lt;&lt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="local-vs-global-variables-2" class="slide level2">
<h2>Local vs global variables</h2>
<p>If we want it to change locally as well as <span class="hl-yellow"><strong>globally</strong></span> we must use the <span class="hl-yellow"><strong>double assignment</strong></span> (<code>&lt;&lt;-</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb632"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb632-2"><a href="#cb632-2"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb632-3"><a href="#cb632-3"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb632-4"><a href="#cb632-4"></a>  </span>
<span id="cb632-5"><a href="#cb632-5"></a>  <span class="co"># change locally</span></span>
<span id="cb632-6"><a href="#cb632-6"></a>  x <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb632-7"><a href="#cb632-7"></a>  <span class="co"># change globally</span></span>
<span id="cb632-8"><a href="#cb632-8"></a>  y <span class="ot">&lt;&lt;-</span> <span class="dv">0</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb632-9"><a href="#cb632-9"></a>  </span>
<span id="cb632-10"><a href="#cb632-10"></a>  <span class="fu">print</span>(x)</span>
<span id="cb632-11"><a href="#cb632-11"></a>  <span class="fu">print</span>(y)</span>
<span id="cb632-12"><a href="#cb632-12"></a>}</span>
<span id="cb632-13"><a href="#cb632-13"></a></span>
<span id="cb632-14"><a href="#cb632-14"></a><span class="fu">fun_example</span>() <span class="co"># what is assigned inside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3
[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb634"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1"></a>x <span class="co"># what is assigned outside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb636"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1"></a>y <span class="co"># what is assigned outside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="tu-turno-7b" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-14-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-14-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-14-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-14-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-14-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<p>📝 Modify the code below to define a function called <code>sum_fun</code>, so that given two elements, it returns their sum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb638"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb638-2"><a href="#cb638-2"></a>  sum <span class="ot">&lt;-</span> <span class="co"># código a ejecutar</span></span>
<span id="cb638-3"><a href="#cb638-3"></a>  <span class="fu">return</span>()</span>
<span id="cb638-4"><a href="#cb638-4"></a>}</span>
<span id="cb638-5"><a href="#cb638-5"></a><span class="fu">sum_fun</span>(<span class="dv">3</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb639"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1"></a>sum_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb639-2"><a href="#cb639-2"></a>  sum <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb639-3"><a href="#cb639-3"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb639-4"><a href="#cb639-4"></a>}</span>
<span id="cb639-5"><a href="#cb639-5"></a><span class="fu">sum_fun</span>(<span class="dv">3</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-2">
<p>📝 Modify the code below to define a function called <code>product_fun</code>, so that given two elements, it returns their product, but by default it calculates the square</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb640"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb640-2"><a href="#cb640-2"></a>  product <span class="ot">&lt;-</span> <span class="co"># code</span></span>
<span id="cb640-3"><a href="#cb640-3"></a>  <span class="fu">return</span>()</span>
<span id="cb640-4"><a href="#cb640-4"></a>}</span>
<span id="cb640-5"><a href="#cb640-5"></a><span class="fu">product_fun</span>(<span class="dv">3</span>)</span>
<span id="cb640-6"><a href="#cb640-6"></a><span class="fu">product_fun</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb641"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1"></a>product_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">y =</span> x) {</span>
<span id="cb641-2"><a href="#cb641-2"></a>  product <span class="ot">&lt;-</span> x <span class="sc">*</span> y</span>
<span id="cb641-3"><a href="#cb641-3"></a>  <span class="fu">return</span>(product)</span>
<span id="cb641-4"><a href="#cb641-4"></a>}</span>
<span id="cb641-5"><a href="#cb641-5"></a><span class="fu">product_fun</span>(<span class="dv">3</span>)</span>
<span id="cb641-6"><a href="#cb641-6"></a><span class="fu">product_fun</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-3">
<p>📝 Define a function called <code>equal_names</code> that, given two names, tells us if they are equal or not. Do this by considering case-sensitive, and case-insensitive. Take a look at the <code>{stringr}</code> package.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1"></a><span class="co"># Case-sensitive</span></span>
<span id="cb642-2"><a href="#cb642-2"></a>equal_names <span class="ot">&lt;-</span> <span class="cf">function</span>(p_1, p_2) {</span>
<span id="cb642-3"><a href="#cb642-3"></a>  <span class="fu">return</span>(p_1 <span class="sc">==</span> p_2)</span>
<span id="cb642-4"><a href="#cb642-4"></a>}</span>
<span id="cb642-5"><a href="#cb642-5"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"javi"</span>)</span>
<span id="cb642-6"><a href="#cb642-6"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"Lucía"</span>)</span>
<span id="cb642-7"><a href="#cb642-7"></a></span>
<span id="cb642-8"><a href="#cb642-8"></a>equal_names <span class="ot">&lt;-</span> <span class="cf">function</span>(p_1, p_2) {</span>
<span id="cb642-9"><a href="#cb642-9"></a>  <span class="fu">return</span>(<span class="fu">toupper</span>(p_1) <span class="sc">==</span> <span class="fu">toupper</span>(p_2))</span>
<span id="cb642-10"><a href="#cb642-10"></a>}</span>
<span id="cb642-11"><a href="#cb642-11"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"javi"</span>)</span>
<span id="cb642-12"><a href="#cb642-12"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"Lucía"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-4">
<p>📝 Create a function called <code>BMI_calc</code> that, given two arguments (weight and height in meters) and a name, returns a list with the BMI and the name.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb643"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1"></a>BMI_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(names, w, h) {</span>
<span id="cb643-2"><a href="#cb643-2"></a>  </span>
<span id="cb643-3"><a href="#cb643-3"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"names"</span> <span class="ot">=</span> names, <span class="st">"BMI"</span> <span class="ot">=</span> w<span class="sc">/</span>(h<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb643-4"><a href="#cb643-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-5">
<p>📝 Repeat the above exercise but with another optional argument called units (by default, <code>units = "m"</code>). Develop the function so that it does the right thing if <code>units = "m"</code> and if <code>units = "cm"</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb644"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1"></a>BMI_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(names, w, h, <span class="at">units =</span> <span class="st">"m"</span>) {</span>
<span id="cb644-2"><a href="#cb644-2"></a>  </span>
<span id="cb644-3"><a href="#cb644-3"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"names"</span> <span class="ot">=</span> names,</span>
<span id="cb644-4"><a href="#cb644-4"></a>              <span class="st">"BMI"</span> <span class="ot">=</span> w<span class="sc">/</span>(<span class="fu">if_else</span>(units <span class="sc">==</span> <span class="st">"m"</span>, h, h<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb644-5"><a href="#cb644-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-6">
<p>📝 Create a tibble of 7 persons, with three variables (invent name, and simulate weight, height in centimeters), and apply the defined function so that we obtain a fourth column with their BMI.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb645"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb645-2"><a href="#cb645-2"></a>  <span class="fu">tibble</span>(<span class="st">"names"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>, <span class="st">"laura"</span>,</span>
<span id="cb645-3"><a href="#cb645-3"></a>                       <span class="st">"ana"</span>, <span class="st">"carlos"</span>, <span class="st">"leo"</span>, <span class="cn">NA</span>),</span>
<span id="cb645-4"><a href="#cb645-4"></a>         <span class="st">"w"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb645-5"><a href="#cb645-5"></a>         <span class="st">"h"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">168</span>, <span class="at">sd =</span> <span class="dv">5</span>))</span>
<span id="cb645-6"><a href="#cb645-6"></a></span>
<span id="cb645-7"><a href="#cb645-7"></a>BMI <span class="sc">|&gt;</span> </span>
<span id="cb645-8"><a href="#cb645-8"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> <span class="fu">BMI_calc</span>(names, w, h, <span class="at">units =</span> <span class="st">"cm"</span>)<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="case-7-b" class="slide level2">
<h2>🐣 Case study 7: functions</h2>
<p>Define a function called <code>temperature_converter</code> that, given a temperature in Fahrenheit, Celsius or Kelvin, converts it to any of the others (think what arguments the user needs). Apply the function to the <code>Temp</code> column of the <code>airquality</code> set, and incorporate it into the file in a new <code>Temp_Celsius</code> column.</p>
</section></section>
<section>
<section id="clase-8" class="title-slide slide level1 center">
<h1>Lesson 8: flow control structures</h1>
<p><span style="color:#444442;"><strong>Flow control structures</strong></span></p>
</section>
<section id="flow-control-structures" class="slide level2">
<h2>Flow control structures</h2>
<p>A <span class="hl-yellow"><strong>control expression</strong></span> will be a set of commands that allow us to <span class="hl-yellow"><strong>decide the path</strong></span> along which we want our code to progress:</p>
<ul>
<li><p>What do we do if A happens?</p></li>
<li><p>What if B happens?</p></li>
<li><p>Do I have to program X times the same thing if you want it to repeat?</p></li>
</ul>
<div class="fragment">
<p>If you have programmed in any other language, you will be familiar with <span class="hl-yellow"><strong>conditional structures</strong></span> such as an <code>if (blabla) {...} else {...}</code> (which we will sometimes use) or <span class="hl-yellow"><strong>loops</strong></span> <code>for/while</code> (which we will try to avoid as much as possible).</p>
</div>
</section>
<section id="if-structures" class="slide level2">
<h2>If structures</h2>
<p>One of the most famous control structures of any programming language is the <span class="hl-yellow"><strong>conditional structure</strong></span> <code>if</code>.</p>
<blockquote>
<p>IF the imposed conditions are fulfilled (TRUE), it executes the commands we have inside it.</p>
</blockquote>
<p>For example, the structure <code>if (x == 1) { code A }</code> will <span class="hl-yellow"><strong>execute the code between braces</strong></span> but <span class="hl-purple"><strong>IF AND ONLY IF</strong></span> the <span class="hl-purple"><strong>condition is true</strong></span> (in this case, only if <code>x</code> equals 1). Otherwise, it does nothing.</p>
<div class="fragment">
<p>Let’s define for example a simple variable, the ages of 8 people and let’s check which of them are minors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb646"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">56</span>, <span class="dv">31</span>, <span class="dv">20</span>, <span class="dv">87</span>, <span class="dv">73</span>)</span>
<span id="cb646-2"><a href="#cb646-2"></a>ages <span class="sc">&lt;</span> <span class="dv">18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="if-structures-1" class="slide level2">
<h2>If structures</h2>
<p>Remember that with the <code>any()</code> and <code>all()</code> functions we can know if <span class="hl-yellow"><strong>all or any of the elements</strong></span> of a vector fulfill a condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb648"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1"></a><span class="fu">any</span>(ages <span class="sc">&lt;</span> <span class="dv">18</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="fragment">
<p>We are going to build our first conditional structure: we want that, <span class="hl-yellow"><strong>If there is a minor, print us a message</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1"></a><span class="cf">if</span> (<span class="fu">any</span>(ages <span class="sc">&lt;</span> <span class="dv">18</span>)) { </span>
<span id="cb650-2"><a href="#cb650-2"></a>  </span>
<span id="cb650-3"><a href="#cb650-3"></a>  <span class="fu">print</span>(<span class="st">"There is any person of legal age"</span>)</span>
<span id="cb650-4"><a href="#cb650-4"></a>  </span>
<span id="cb650-5"><a href="#cb650-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There is any person of legal age"</code></pre>
</div>
</div>
</div>
</section>
<section id="if-structures-2" class="slide level2">
<h2>If structures</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb652"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1"></a><span class="cf">if</span> (<span class="fu">any</span>(ages <span class="sc">&lt;</span> <span class="dv">18</span>)) { </span>
<span id="cb652-2"><a href="#cb652-2"></a>  </span>
<span id="cb652-3"><a href="#cb652-3"></a>  <span class="fu">print</span>(<span class="st">"There is any person of legal age"</span>)</span>
<span id="cb652-4"><a href="#cb652-4"></a>  </span>
<span id="cb652-5"><a href="#cb652-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In case <span class="hl-yellow"><strong>conditions are not verified</strong></span> inside the <code>if()</code> (return <code>FALSE</code>), nothing will happen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb653"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb653-2"><a href="#cb653-2"></a>  </span>
<span id="cb653-3"><a href="#cb653-3"></a>  <span class="fu">print</span>(<span class="st">"Everyone is of legal age"</span>)</span>
<span id="cb653-4"><a href="#cb653-4"></a>  </span>
<span id="cb653-5"><a href="#cb653-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that in this case <strong>we have not obtained any message</strong> because the condition <code>all(ages &gt;= 18)</code> is not <code>TRUE</code> (they are not all older than 18), so <strong>it has not executed the code</strong>.</p>
</section>
<section id="if-else-structures" class="slide level2">
<h2>If-else structures</h2>
<p>The <code>if (condition) { }</code> structure can be combined with an <code>else { }</code>: when the <span class="hl-yellow"><strong>condition is not verified</strong></span> (as before), it will <span class="hl-yellow"><strong>execute the alternative code</strong></span> inside the <code>else { }</code>, allowing us to decide what happens when it IS verified and when it IS NOT.</p>
<div class="fragment">
<p>For example, the structure <code>if (x == 1) { code A } else { code B }</code> will execute A if <code>x</code> is 1 and B in any other case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb654"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb654-2"><a href="#cb654-2"></a>  </span>
<span id="cb654-3"><a href="#cb654-3"></a>  <span class="fu">print</span>(<span class="st">"Everyone is of legal age"</span>)</span>
<span id="cb654-4"><a href="#cb654-4"></a>  </span>
<span id="cb654-5"><a href="#cb654-5"></a>} <span class="cf">else</span> {</span>
<span id="cb654-6"><a href="#cb654-6"></a>  </span>
<span id="cb654-7"><a href="#cb654-7"></a>  <span class="fu">print</span>(<span class="st">"There is any person under legal age"</span>)</span>
<span id="cb654-8"><a href="#cb654-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There is any person under legal age"</code></pre>
</div>
</div>
</div>
</section>
<section id="if-else-structures-1" class="slide level2">
<h2>If-else structures</h2>
<p>This <code>if - else</code> structure can be <span class="hl-yellow"><strong>nested</strong></span>: imagine that we want to perform an action if all were of legal age; otherwise, but if all minors are 16 or older, perform another action; otherwise, another action.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb656"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb656-2"><a href="#cb656-2"></a>  </span>
<span id="cb656-3"><a href="#cb656-3"></a>  <span class="fu">print</span>(<span class="st">"Everyone is of legal age"</span>)</span>
<span id="cb656-4"><a href="#cb656-4"></a>  </span>
<span id="cb656-5"><a href="#cb656-5"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">16</span>)) {</span>
<span id="cb656-6"><a href="#cb656-6"></a>  </span>
<span id="cb656-7"><a href="#cb656-7"></a>  <span class="fu">print</span>(<span class="st">"There are some minors but all are 16 years of age or older"</span>)</span>
<span id="cb656-8"><a href="#cb656-8"></a>  </span>
<span id="cb656-9"><a href="#cb656-9"></a>} <span class="cf">else</span> { <span class="fu">print</span>(<span class="st">"There is any person under 16 years of age"</span>) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There is any person under 16 years of age"</code></pre>
</div>
</div>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>You can <strong>collapse the control structures</strong> by clicking on the arrow to the left of them in your script.</p>
</div>
</div>
</div>
</section>
<section id="if-else-vectorized-structures" class="slide level2">
<h2>If-else vectorized structures</h2>
<p>This conditional structure can be <span class="hl-yellow"><strong>vectorized</strong></span>: gather in a single row a large number of comparison structures with the function <code>if_else()</code> (<code>{dplyr}</code> package), whose input arguments will be</p>
<ul>
<li>the condition to evaluate</li>
<li>what happens when it is met</li>
<li>what happens when it is not met</li>
</ul>
<p>With the example of the ages, we are going to leave the data absent if they are under age, and if they are over age it stays as it is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb658"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb658-2"><a href="#cb658-2"></a><span class="fu">if_else</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>, ages, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA NA 24 56 31 20 87 73</code></pre>
</div>
</div>
</section>
<section id="if-else-vectorized-structures-1" class="slide level2">
<h2>If-else vectorized structures</h2>
<p>All these structures <span class="hl-yellow"><strong>not only for numeric data</strong></span>. We are going to define a vector of names with some absent ones, and we are going to replace the absent ones by the text <code>"unknown_name"</code> (the ones that are not absent, that is to say the ones that <code>is.na()</code> returns FALSE, stay as they are).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb660"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Juan"</span>, <span class="st">"María"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Lucía"</span>,</span>
<span id="cb660-2"><a href="#cb660-2"></a>           <span class="st">"Carmen"</span>, <span class="st">"Javier"</span>, <span class="cn">NA</span>, <span class="st">"Carlos"</span>, </span>
<span id="cb660-3"><a href="#cb660-3"></a>           <span class="cn">NA</span>, <span class="st">"Gregorio"</span>, <span class="st">"Paloma"</span>)</span>
<span id="cb660-4"><a href="#cb660-4"></a></span>
<span id="cb660-5"><a href="#cb660-5"></a><span class="fu">if_else</span>(<span class="fu">is.na</span>(names), <span class="st">"unknown_name"</span>, names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Juan"         "María"        "unknown_name" "unknown_name" "Lucía"       
 [6] "Carmen"       "Javier"       "unknown_name" "Carlos"       "unknown_name"
[11] "Gregorio"     "Paloma"      </code></pre>
</div>
</div>
</section>
<section id="if-else-vectorized-structures-2" class="slide level2">
<h2>If-else vectorized structures</h2>
<p>It is important to remember that a logical condition actually has <span class="hl-yellow"><strong>three possible outcomes</strong></span>: <code>TRUE</code>, <code>FALSE</code> and <code>NA</code> (missing values). What happens when the <span class="hl-purple"><strong>evaluated condition produces a missing data</strong></span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb662"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, ages, <span class="cn">NA</span>)</span>
<span id="cb662-2"><a href="#cb662-2"></a><span class="fu">if_else</span>(ages <span class="sc">&gt;</span> <span class="dv">18</span>, <span class="st">"greater than 18"</span>, <span class="st">"otherwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA                "otherwise"       "otherwise"       "greater than 18"
 [5] "greater than 18" "greater than 18" "greater than 18" "greater than 18"
 [9] "greater than 18" NA               </code></pre>
</div>
</div>
<div class="fragment">
<p>The <code>if_else()</code> function provides us with an extra argument <code>missing = ...</code> to decide the value to be assigned for missing values (by default, it returns <code>NA</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb664"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1"></a><span class="fu">if_else</span>(ages <span class="sc">&gt;</span> <span class="dv">18</span>, <span class="st">"greater than 18"</span>, <span class="st">"otherwise"</span>, <span class="at">missing =</span> <span class="st">"unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "unknown"         "otherwise"       "otherwise"       "greater than 18"
 [5] "greater than 18" "greater than 18" "greater than 18" "greater than 18"
 [9] "greater than 18" "unknown"        </code></pre>
</div>
</div>
</div>
</section>
<section id="loops" class="slide level2">
<h2>Loops</h2>
<p>Although most of the time they can be replaced by other more readable and efficient expressions, it is important to know another well-known control expression: <span class="hl-yellow"><strong>loops</strong></span>.</p>
<ul>
<li><p><code>for { }</code>: allows <span class="hl-yellow"><strong>repeating the same code</strong></span> a <span class="hl-purple"><strong>fixed and known number</strong></span> of times (usually based on an index).</p></li>
<li><p><code>while { }</code>: allows <span class="hl-yellow"><strong>repeating the same code</strong></span> a <span class="hl-purple"><strong>indeterminate number of times</strong></span>, until a given <strong>condition</strong> is no longer met.</p></li>
</ul>
</section>
<section id="for-loops" class="slide level2">
<h2>For loops</h2>
<p>A <span class="hl-yellow"><strong>for-loop</strong></span> is a structure that allows us to <span class="hl-yellow"><strong>repeat</strong></span> a set of commands a <span class="hl-purple"><strong>finite and known number</strong></span> of times: given a <strong>set of indices</strong>, the loop will loop through each of them.</p>
<div class="fragment">
<p>We are going to define a vector <code>x</code> any and print each element squared: if we wanted the first element squared we would write <code>x[1]^2</code>, if we wanted to do it in general, for the i-th element, <code>x[i]^2</code>. What we will do inside the <code>for (indices) { code }</code> is to indicate which values <code>i</code> will take (<span class="hl-yellow"><strong>index vector</strong></span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb666"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb666-2"><a href="#cb666-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb666-3"><a href="#cb666-3"></a>  </span>
<span id="cb666-4"><a href="#cb666-4"></a>  <span class="fu">print</span>(x[i]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb666-5"><a href="#cb666-5"></a>  </span>
<span id="cb666-6"><a href="#cb666-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0
[1] 49
[1] 1
[1] 16</code></pre>
</div>
</div>
</div>
</section>
<section id="for-loops-1" class="slide level2">
<h2>For loops</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) { </span>
<span id="cb668-2"><a href="#cb668-2"></a>  <span class="fu">print</span>(x[i]<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb668-3"><a href="#cb668-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inside the parentheses <code>for ()</code> we have just a <span class="hl-yellow"><strong>sequence of numbers</strong></span> that we have learned to construct. If we wanted it to do the same but excluding for example the second element it would be enough to define the indexes to traverse as <code>c(1, 3, 4)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb669"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb669-2"><a href="#cb669-2"></a>  </span>
<span id="cb669-3"><a href="#cb669-3"></a>  <span class="fu">print</span>(x[i]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb669-4"><a href="#cb669-4"></a>  </span>
<span id="cb669-5"><a href="#cb669-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0
[1] 1
[1] 16</code></pre>
</div>
</div>
</section>
<section id="for-loops-2" class="slide level2">
<h2>For loops</h2>
<p>We can also define a variable <code>y &lt;- rep(0, 4)</code> (an “empty” <strong>vector</strong> filled with zeros), storing the <span class="hl-yellow"><strong>i-th element of the vector</strong></span> defined as <code>x[i]^2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb671"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb671-2"><a href="#cb671-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb671-3"><a href="#cb671-3"></a>  </span>
<span id="cb671-4"><a href="#cb671-4"></a>  y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb671-5"><a href="#cb671-5"></a>  </span>
<span id="cb671-6"><a href="#cb671-6"></a>}</span>
<span id="cb671-7"><a href="#cb671-7"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 49  1 16</code></pre>
</div>
</div>
<div class="fragment">
<p>The above is equivalent to this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb673"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb673-2"><a href="#cb673-2"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 49  1 16</code></pre>
</div>
</div>
</div>
</section>
<section id="avoiding-loops" class="slide level2">
<h2>Avoiding loops</h2>
<p>Using the <code>{microbenchmark}</code> package we can see how <span class="hl-yellow"><strong>loops are less efficient</strong></span> (hence most of the time we try to avoid them if there is an alternative).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb675"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb675-2"><a href="#cb675-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb675-3"><a href="#cb675-3"></a><span class="fu">microbenchmark</span>(y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb675-4"><a href="#cb675-4"></a>               <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) { y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">^</span><span class="dv">2</span> },</span>
<span id="cb675-5"><a href="#cb675-5"></a>               <span class="at">times =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
                                    expr      min       lq       mean    median
                                y &lt;- x^2    2.009    3.157    5.29761    3.8745
 for (i in 1:100) {     y[i] &lt;- x[i]^2 } 1747.092 2686.238 3728.00569 3259.3155
        uq       max neval
    6.2525    64.657   500
 4131.3855 21647.262   500</code></pre>
</div>
</div>
</section>
<section id="for-loops-3" class="slide level2">
<h2>For loops</h2>
<p>Let’s look at another example <span class="hl-yellow"><strong>combining numeric and character vectors</strong></span>: let’s define again a vector of ages and names, and let’s go through each one printing a message on the screen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb677"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Javi"</span>, <span class="st">"Laura"</span>, <span class="st">"Carlos"</span>, <span class="st">"Lucía"</span>, <span class="st">"Mar"</span>)</span>
<span id="cb677-2"><a href="#cb677-2"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">51</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">29</span>)</span>
<span id="cb677-3"><a href="#cb677-3"></a></span>
<span id="cb677-4"><a href="#cb677-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) { </span>
<span id="cb677-5"><a href="#cb677-5"></a>  </span>
<span id="cb677-6"><a href="#cb677-6"></a>  <span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"{names[i]} are {ages[i]} years old"</span>)) </span>
<span id="cb677-7"><a href="#cb677-7"></a>  </span>
<span id="cb677-8"><a href="#cb677-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Javi are 33 years old
Laura are 51 years old
Carlos are 18 years old
Lucía are 43 years old
Mar are 29 years old</code></pre>
</div>
</div>
</section>
<section id="for-loops-4" class="slide level2">
<h2>For loops</h2>
<p>Notice that <span class="hl-yellow"><strong>if we don’t want to worry about adding another person</strong></span>, we can make the loop start at 1 and end at the <span class="hl-yellow"><strong>last place</strong></span> (whichever one it is), using <code>length()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb679"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(names)) { </span>
<span id="cb679-2"><a href="#cb679-2"></a>  </span>
<span id="cb679-3"><a href="#cb679-3"></a>  <span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"{names[i]} are {ages[i]} years old"</span>)) </span>
<span id="cb679-4"><a href="#cb679-4"></a>  </span>
<span id="cb679-5"><a href="#cb679-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Javi are 33 years old
Laura are 51 years old
Carlos are 18 years old
Lucía are 43 years old
Mar are 29 years old</code></pre>
</div>
</div>
</section>
<section id="for-loops-5" class="slide level2">
<h2>For loops</h2>
<p>Although the set that the loop runs through is usually numeric indices, we can <span class="hl-yellow"><strong>run through any type of object</strong></span>, for example days of the week</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb681"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb681-2"><a href="#cb681-2"></a>week_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"monday"</span>, <span class="st">"tuesday"</span>, <span class="st">"wednesday"</span>, <span class="st">"thursday"</span>,</span>
<span id="cb681-3"><a href="#cb681-3"></a>               <span class="st">"friday"</span>, <span class="st">"saturday"</span>, <span class="st">"sunday"</span>)</span>
<span id="cb681-4"><a href="#cb681-4"></a></span>
<span id="cb681-5"><a href="#cb681-5"></a><span class="cf">for</span> (days <span class="cf">in</span> week_days) {</span>
<span id="cb681-6"><a href="#cb681-6"></a>  </span>
<span id="cb681-7"><a href="#cb681-7"></a>  <span class="fu">print</span>(<span class="fu">str_to_upper</span>(days))</span>
<span id="cb681-8"><a href="#cb681-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MONDAY"
[1] "TUESDAY"
[1] "WEDNESDAY"
[1] "THURSDAY"
[1] "FRIDAY"
[1] "SATURDAY"
[1] "SUNDAY"</code></pre>
</div>
</div>
</section>
<section id="for-loops-6" class="slide level2">
<h2>For loops</h2>
<p>One last example: let’s go through our <code>swiss</code> dataset from the <code>{datasets}</code> package and we will <strong>pass to missing data</strong> all the fertility values greater than 80.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb683"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(swiss)) {</span>
<span id="cb683-2"><a href="#cb683-2"></a>  </span>
<span id="cb683-3"><a href="#cb683-3"></a>  <span class="cf">if</span> (swiss<span class="sc">$</span>Fertility[i] <span class="sc">&gt;</span> <span class="dv">80</span>) { </span>
<span id="cb683-4"><a href="#cb683-4"></a>    </span>
<span id="cb683-5"><a href="#cb683-5"></a>    swiss<span class="sc">$</span>Fertility[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb683-6"><a href="#cb683-6"></a>    </span>
<span id="cb683-7"><a href="#cb683-7"></a>  }</span>
<span id="cb683-8"><a href="#cb683-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>This would be exactly equivalent to the <code>if_else()</code> vectorized <code>if_else()</code> we saw previously</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb684"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1"></a><span class="fu">data</span>(<span class="st">"swiss"</span>)</span>
<span id="cb684-2"><a href="#cb684-2"></a>swiss<span class="sc">$</span>Fertility <span class="ot">&lt;-</span> <span class="fu">if_else</span>(swiss<span class="sc">$</span>Fertility <span class="sc">&gt;</span> <span class="dv">80</span>, <span class="cn">NA</span>, swiss<span class="sc">$</span>Fertility)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="while-loops" class="slide level2">
<h2>While loops</h2>
<p>Another way to design a loop is with the <code>while { }</code> structure, which will execute the loop an <span class="hl-yellow"><strong>unknown a priori number of times</strong></span>, it will do so until the <span class="hl-yellow"><strong>imposed condition is no longer true</strong></span>. For example, we will initialize a variable <code>cycles &lt;- 1</code>, and at each step we will increment by one unit, and we will not exit the loop until <code>cycles &gt; 4</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb685"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1"></a>cycles <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb685-2"><a href="#cb685-2"></a><span class="cf">while</span>(cycles <span class="sc">&lt;=</span> <span class="dv">4</span>) {</span>
<span id="cb685-3"><a href="#cb685-3"></a>  </span>
<span id="cb685-4"><a href="#cb685-4"></a>  <span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"Not yet, cycles {cycles}"</span>)) </span>
<span id="cb685-5"><a href="#cb685-5"></a>  cycles <span class="ot">&lt;-</span> cycles <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb685-6"><a href="#cb685-6"></a>  </span>
<span id="cb685-7"><a href="#cb685-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Not yet, cycles 1
Not yet, cycles 2
Not yet, cycles 3
Not yet, cycles 4</code></pre>
</div>
</div>
</section>
<section id="while-loops-1" class="slide level2">
<h2>While loops</h2>
<p>And what happens when the <span class="hl-yellow"><strong>condition never becomes FALSE</strong></span>? See for yourself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb687"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1"></a><span class="cf">while</span> (<span class="dv">1</span> <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb687-2"><a href="#cb687-2"></a>  </span>
<span id="cb687-3"><a href="#cb687-3"></a>  <span class="fu">print</span>(<span class="st">"Press ESC to abort the loop"</span>)</span>
<span id="cb687-4"><a href="#cb687-4"></a>  </span>
<span id="cb687-5"><a href="#cb687-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>A <code>while { }</code> loop can be very dangerous if it is not well controlled that the loop ends at some point.</p>
</div>
</div>
</div>
</section>
<section id="while-loops-2" class="slide level2">
<h2>While loops</h2>
<p>We have two commands reserved to be able to <span class="hl-yellow"><strong>abort a loop or forcibly advance</strong></span>:</p>
<ul>
<li><code>break</code>: enables you to <span class="hl-yellow"><strong>stop a loop</strong></span> even if it has not reached the end of its index set to traverse (or the condition is still met).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb688"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb688-2"><a href="#cb688-2"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb688-3"><a href="#cb688-3"></a>    </span>
<span id="cb688-4"><a href="#cb688-4"></a>    <span class="cf">break</span> <span class="co"># if i = 3, stop the loop</span></span>
<span id="cb688-5"><a href="#cb688-5"></a>    </span>
<span id="cb688-6"><a href="#cb688-6"></a>  }</span>
<span id="cb688-7"><a href="#cb688-7"></a>  <span class="fu">print</span>(i)</span>
<span id="cb688-8"><a href="#cb688-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2</code></pre>
</div>
</div>
</section>
<section id="while-loops-3" class="slide level2">
<h2>While loops</h2>
<p>We have two commands reserved to be able to <span class="hl-yellow"><strong>abort a loop or forcibly advance</strong></span>:</p>
<ul>
<li><code>next</code>: <span class="hl-yellow"><strong>forces the loop to advance</strong></span> to the next iteration, aborting the current iteration it is in.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb690-2"><a href="#cb690-2"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb690-3"><a href="#cb690-3"></a>    </span>
<span id="cb690-4"><a href="#cb690-4"></a>    <span class="cf">next</span> <span class="co"># if i = 3, we continue</span></span>
<span id="cb690-5"><a href="#cb690-5"></a>    </span>
<span id="cb690-6"><a href="#cb690-6"></a>  }</span>
<span id="cb690-7"><a href="#cb690-7"></a>  <span class="fu">print</span>(i)</span>
<span id="cb690-8"><a href="#cb690-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2
[1] 4
[1] 5</code></pre>
</div>
</div>
</section>
<section id="repeat-loops" class="slide level2">
<h2>Repeat loops</h2>
<p>Although it is a rarely used option, there is a control structure called <code>repeat { }</code> that executes a <span class="hl-yellow"><strong>loop infinitely until we order it to stop</strong></span> with a break.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb692"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1"></a>count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb692-2"><a href="#cb692-2"></a><span class="cf">repeat</span> { </span>
<span id="cb692-3"><a href="#cb692-3"></a>  </span>
<span id="cb692-4"><a href="#cb692-4"></a>  count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb692-5"><a href="#cb692-5"></a>  <span class="cf">if</span> (count <span class="sc">&gt;=</span> <span class="dv">100</span>) { <span class="cf">break</span> }</span>
<span id="cb692-6"><a href="#cb692-6"></a>  </span>
<span id="cb692-7"><a href="#cb692-7"></a>}</span>
<span id="cb692-8"><a href="#cb692-8"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
</section>
<section id="replicate" class="slide level2">
<h2>Replicate</h2>
<p>Another way to <span class="hl-yellow"><strong>repeat or replicate</strong></span> code, apart from the loop structures already seen, is to make use of <code>replicate()</code>, which for the moment we will not make it depend on an index: we will simply <span class="hl-yellow"><strong>repeat n times</strong></span> the same code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb694"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb694-2"><a href="#cb694-2"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, x<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    4    4    4
[3,]    9    9    9</code></pre>
</div>
</div>
</section>
<section id="tu-turno-7" class="slide level2">
<h2>💻 Your turn</h2>
<div class="panel-tabset">
<ul id="tabset-15" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-15-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-15-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-15-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-15-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-15-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1">
<p>📝 Modify the code below to print a message on the screen if all data in the <code>airquality</code> set are from months other than January.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb696"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb696-2"><a href="#cb696-2"></a>months <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb696-3"><a href="#cb696-3"></a></span>
<span id="cb696-4"><a href="#cb696-4"></a><span class="cf">if</span> (months <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb696-5"><a href="#cb696-5"></a>  <span class="fu">print</span>(<span class="st">"No data for the month of January"</span>)</span>
<span id="cb696-6"><a href="#cb696-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb697"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb697-2"><a href="#cb697-2"></a>months <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb697-3"><a href="#cb697-3"></a></span>
<span id="cb697-4"><a href="#cb697-4"></a><span class="cf">if</span> (<span class="fu">all</span>(months <span class="sc">!=</span> <span class="dv">1</span>)) {</span>
<span id="cb697-5"><a href="#cb697-5"></a>  <span class="fu">print</span>(<span class="st">"No data for the month of January"</span>)</span>
<span id="cb697-6"><a href="#cb697-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-2">
<p>📝 Modify the code below to store in a variable called <code>high_temperature</code> a <code>TRUE</code> value if any of the records have a temperature greater than 90 (they are in Farenheit) and a <code>FALSE</code> otherwise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1"></a>temp<span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb698-2"><a href="#cb698-2"></a></span>
<span id="cb698-3"><a href="#cb698-3"></a><span class="cf">if</span> (temp <span class="sc">==</span> <span class="dv">100</span>) {</span>
<span id="cb698-4"><a href="#cb698-4"></a>  <span class="fu">print</span>(<span class="st">"Some of the records have temperatures above 90 Farenheit."</span>)</span>
<span id="cb698-5"><a href="#cb698-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb699"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb699-1"><a href="#cb699-1"></a><span class="co"># Option 1</span></span>
<span id="cb699-2"><a href="#cb699-2"></a>temp <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb699-3"><a href="#cb699-3"></a>high_temp <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb699-4"><a href="#cb699-4"></a><span class="cf">if</span> (<span class="fu">any</span>(temp <span class="sc">&gt;</span> <span class="dv">90</span>)) {</span>
<span id="cb699-5"><a href="#cb699-5"></a>   high_temp <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb699-6"><a href="#cb699-6"></a>}</span>
<span id="cb699-7"><a href="#cb699-7"></a></span>
<span id="cb699-8"><a href="#cb699-8"></a><span class="co"># Option 2</span></span>
<span id="cb699-9"><a href="#cb699-9"></a>high_temp <span class="ot">&lt;-</span> <span class="fu">any</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-3">
<p>📝 Modify the code below to design a <code>for</code> loop of 5 iterations that loops through the first 5 odd ones and adds one to them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb700"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb700-2"><a href="#cb700-2"></a>  </span>
<span id="cb700-3"><a href="#cb700-3"></a>  <span class="fu">print</span>(i)</span>
<span id="cb700-4"><a href="#cb700-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) {</span>
<span id="cb701-2"><a href="#cb701-2"></a>  </span>
<span id="cb701-3"><a href="#cb701-3"></a>  <span class="fu">print</span>(i <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb701-4"><a href="#cb701-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-4">
<p>📝 Modify the code below to design a <code>while</code> loop that starts with a <code>count &lt;- 1</code> variable and stops when it reaches 6.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb702"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb702-2"><a href="#cb702-2"></a><span class="cf">while</span> (count <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb702-3"><a href="#cb702-3"></a>  </span>
<span id="cb702-4"><a href="#cb702-4"></a>  <span class="fu">print</span>(count)</span>
<span id="cb702-5"><a href="#cb702-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb703"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb703-2"><a href="#cb703-2"></a><span class="cf">while</span> (count <span class="sc">&lt;</span> <span class="dv">6</span>) {</span>
<span id="cb703-3"><a href="#cb703-3"></a>  </span>
<span id="cb703-4"><a href="#cb703-4"></a>  <span class="fu">print</span>(count)</span>
<span id="cb703-5"><a href="#cb703-5"></a>  count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb703-6"><a href="#cb703-6"></a>  </span>
<span id="cb703-7"><a href="#cb703-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-5">
<p>📝 Using <code>sample()</code>, it simulates the roll of 100 dice (each with 6 sides), but in such a way that the die is tricked, and calculates the average of the rolls.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb704"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb704-1"><a href="#cb704-1"></a><span class="co"># no tricked</span></span>
<span id="cb704-2"><a href="#cb704-2"></a>rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb704-3"><a href="#cb704-3"></a><span class="fu">mean</span>(rolls)</span>
<span id="cb704-4"><a href="#cb704-4"></a></span>
<span id="cb704-5"><a href="#cb704-5"></a><span class="co"># tricked</span></span>
<span id="cb704-6"><a href="#cb704-6"></a>rolls <span class="ot">&lt;-</span></span>
<span id="cb704-7"><a href="#cb704-7"></a>  <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb704-8"><a href="#cb704-8"></a>         <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb704-9"><a href="#cb704-9"></a><span class="fu">mean</span>(rolls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="case-8" class="slide level2">
<h2>🐣 Case study 8</h2>
<p>📝 Design a <code>for</code> loop of 200 iterations that, starting at an initial value of 100 (euros), adds 3€ (updating the value) if the current number of the iteration is even, and subtracts 5€ if it is odd (investigate the <code>%%</code> function).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb705"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1"></a><span class="dv">10</span> <span class="sc">%%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1"></a><span class="dv">11</span> <span class="sc">%%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb709"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1"></a><span class="dv">12</span> <span class="sc">%%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb711"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1"></a><span class="dv">13</span> <span class="sc">%%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="fragment">
<p>📝 Design the above loop but store the money from each iteration in some variable</p>
</div>
<div class="fragment">
<p>📝 Design the loop of exercise 5 but stop when we have no money left.</p>
</div>
</section>
<section id="quali-factors" class="slide level2">
<h2>Quali: factors</h2>
<p>In statistics, when we talk about <span class="hl-yellow"><strong>qualitative variables</strong></span>, we will call <strong>levels or modalities</strong> the <strong>different values</strong> that these data can take. For example, in the case of the <code>sex</code> variable of the <code>starwars</code> set, we have 4 allowed levels: <code>female</code>, <code>hermaphroditic</code>, <code>male</code> and <code>none</code> (in addition to missing data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb713"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="quali-factors-1" class="slide level2">
<h2>Quali: factors</h2>
<p>These kinds of variables are known in <code>R</code> as <span class="hl-yellow"><strong>factors</strong></span>, and the fundamental package to deal with them is <code>{forcats}</code> (from the <code>{tidyverse}</code> environment).</p>

<img data-src="img/factors.jpg" class="r-stretch"></section>
<section id="quali-factors-2" class="slide level2">
<h2>Quali: factors</h2>
<p>This package allows us to set the <span class="hl-yellow"><strong>levels</strong></span> (stored internally as <code>levels</code>) that a given categorical variable takes so that no mistakes, errors in data collection and generation can be generated. It also makes their analysis less computationally expensive when doing searches and comparisons, giving them a <span class="hl-yellow"><strong>different treatment than normal text strings</strong></span>.</p>
<div class="fragment">
<p>Let’s see a simple example simulating a <code>party</code> variable taking the values <code>"PP"</code>, <code>"PSOE"</code> and <code>"SUMAR"</code> (of size 15)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb715-2"><a href="#cb715-2"></a>party <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"PP"</span>, <span class="st">"PSOE"</span>, <span class="st">"SUMAR"</span>), <span class="at">size =</span> <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb715-3"><a href="#cb715-3"></a>party</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PP"    "PSOE"  "SUMAR" "PP"    "PP"    "SUMAR" "PSOE"  "SUMAR" "SUMAR"
[10] "SUMAR" "PP"    "PSOE"  "PP"    "PSOE"  "SUMAR"</code></pre>
</div>
</div>
<p>The <code>party</code> variable is currently of <span class="hl-yellow"><strong>type text</strong></span>, of type <code>chr</code>, something we can check with <code>class(state)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb717"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1"></a><span class="fu">class</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-3" class="slide level2">
<h2>Quali: factors</h2>
<p>From a statistical and computational point of view, for <code>R</code> this variable right now would be equivalent to a named variable. But statistically <span class="hl-yellow"><strong>a variable as a string</strong></span> is not the same as a categorical variable that <span class="hl-yellow"><strong>can only take those 3 levels</strong></span>. How to <span class="hl-yellow"><strong>convert to factor</strong></span>?</p>
<div class="fragment">
<p>By making use of the <code>as_factor()</code> function from the <code>{forcats}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb719"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb719-2"><a href="#cb719-2"></a>party_fct <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(party),</span>
<span id="cb719-3"><a href="#cb719-3"></a>                    <span class="st">"party"</span> <span class="ot">=</span> <span class="fu">as_factor</span>(party))</span>
<span id="cb719-4"><a href="#cb719-4"></a>party_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
      id party
   &lt;int&gt; &lt;fct&gt;
 1     1 PP   
 2     2 PSOE 
 3     3 SUMAR
 4     4 PP   
 5     5 PP   
 6     6 SUMAR
 7     7 PSOE 
 8     8 SUMAR
 9     9 SUMAR
10    10 SUMAR
11    11 PP   
12    12 PSOE 
13    13 PP   
14    14 PSOE 
15    15 SUMAR</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-4" class="slide level2">
<h2>Quali: factors</h2>
<p>Not only the class of the variable has changed, but now, below the saved value, the sentence <code>Levels: ...</code> appears: these are the <span class="hl-yellow"><strong>modalities or levels</strong></span> of our qualitative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb721"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1"></a>party_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    PSOE  SUMAR PP    PP    SUMAR PSOE  SUMAR SUMAR SUMAR PP    PSOE 
[13] PP    PSOE  SUMAR
Levels: PP PSOE SUMAR</code></pre>
</div>
</div>
</section>
<section id="quali-factors-5" class="slide level2">
<h2>Quali: factors</h2>
<p>Imagine that we are defining the database of deputies of the Congress and that the deputies of the PP did not attend that day to the plenary session: although our variable does not take that value THAT DAY, the state <code>PSOE</code> is a <span class="hl-yellow"><strong>allowed level in the database</strong></span> (so even if we eliminate it, because it is a factor, the level remains, we do not have it now but it is an allowed level).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1"></a>party_fct <span class="sc">|&gt;</span> </span>
<span id="cb723-2"><a href="#cb723-2"></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PP"</span>, <span class="st">"SUMAR"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb723-3"><a href="#cb723-3"></a>  <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    SUMAR PP    PP    SUMAR SUMAR SUMAR SUMAR PP    PP    SUMAR
Levels: PP PSOE SUMAR</code></pre>
</div>
</div>
</section>
<section id="quali-factors-6" class="slide level2">
<h2>Quali: factors</h2>
<p>With <code>factor()</code> function we can <span class="hl-yellow"><strong>explicitly specify</strong></span> the names of the modalities and using <code>levels = ...</code> we can explicitly tell it the <span class="hl-yellow"><strong>“order” of the modalities</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb725"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1"></a>party_fct <span class="ot">&lt;-</span></span>
<span id="cb725-2"><a href="#cb725-2"></a>  <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(party),</span>
<span id="cb725-3"><a href="#cb725-3"></a>         <span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SUMAR"</span>, <span class="st">"PP"</span>, <span class="st">"PSOE"</span>)))</span>
<span id="cb725-4"><a href="#cb725-4"></a>party_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    PSOE  SUMAR PP    PP    SUMAR PSOE  SUMAR SUMAR SUMAR PP    PSOE 
[13] PP    PSOE  SUMAR
Levels: SUMAR PP PSOE</code></pre>
</div>
</div>
</section>
<section id="quali-factors-7" class="slide level2">
<h2>Quali: factors</h2>
<p>The previous “order” is just in the sense which it will be counted/plotted first) but <span class="hl-purple"><strong>we don’t have (yet) an ordinal variable</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1"></a>party_fct<span class="sc">$</span>party <span class="sc">&lt;</span> <span class="st">"SUMAR"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
</div>
<div class="fragment">
<p>What if we want to <span class="hl-yellow"><strong>define a qualitative variable ORDINAL</strong></span>? Inside <code>factor()</code> we must indicate that <code>ordered = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb729"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1"></a>marks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"B"</span>, <span class="st">"A+"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"D"</span>, <span class="st">"A+"</span>)</span>
<span id="cb729-2"><a href="#cb729-2"></a>marks_database <span class="ot">&lt;-</span></span>
<span id="cb729-3"><a href="#cb729-3"></a>  <span class="fu">tibble</span>(<span class="st">"student"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(marks),</span>
<span id="cb729-4"><a href="#cb729-4"></a>         <span class="st">"marks"</span> <span class="ot">=</span></span>
<span id="cb729-5"><a href="#cb729-5"></a>           <span class="fu">factor</span>(marks, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A+"</span>),</span>
<span id="cb729-6"><a href="#cb729-6"></a>                  <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb729-7"><a href="#cb729-7"></a>marks_database <span class="sc">|&gt;</span> <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-8" class="slide level2">
<h2>Quali: factors</h2>
<p>What changes? If you notice now, although the variable is still qualitative, we can <span class="hl-yellow"><strong>make comparisons and order the records</strong></span> because there is a <span class="hl-purple"><strong>hierarchy</strong></span> between the modalities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1"></a>marks_database <span class="sc">|&gt;</span> <span class="fu">filter</span>(marks <span class="sc">&gt;=</span> <span class="st">"B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  student marks
    &lt;int&gt; &lt;ord&gt;
1       1 A    
2       4 B    
3       5 A+   
4       6 A    
5      10 B    
6      11 A    
7      17 A+   </code></pre>
</div>
</div>
</section>
<section id="quali-factors-9" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>If we want to tell it to <span class="hl-yellow"><strong>drop an unused level</strong></span> at that moment (and that we want to <span class="hl-purple"><strong>exclude from the definition</strong></span>) we can do it with <code>fct_drop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb733"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb733-1"><a href="#cb733-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb733-2"><a href="#cb733-2"></a>  <span class="fu">filter</span>(marks <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb733-3"><a href="#cb733-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A E F B A C C D B A C C E F D
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+</code></pre>
</div>
</div>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/drop_factor.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb735"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb735-1"><a href="#cb735-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb735-2"><a href="#cb735-2"></a>  <span class="fu">filter</span>(marks <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb735-3"><a href="#cb735-3"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_drop</span>(marks)) <span class="sc">|&gt;</span>  </span>
<span id="cb735-4"><a href="#cb735-4"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A E F B A C C D B A C C E F D
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A</code></pre>
</div>
</div>
</section>
<section id="quali-factors-10" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>Just as we can delete levels we can <span class="hl-yellow"><strong>expand existing levels</strong></span> (even if there is no data for that level at that time) with <code>fct_expand()</code>.</p>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/factor_expand.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb737"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb737-1"><a href="#cb737-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb737-2"><a href="#cb737-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb737-3"><a href="#cb737-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+ &lt; F- &lt; A++</code></pre>
</div>
</div>
</section>
<section id="quali-factors-11" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>In addition with <code>fct_explicit_na()</code> we can <span class="hl-yellow"><strong>assign a level to the missing values</strong></span> to be included in the analysis and visualizations.</p>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/factor_explicit.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb739"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb739-1"><a href="#cb739-1"></a><span class="fu">fct_explicit_na</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] a         b         (Missing)
Levels: a b (Missing)</code></pre>
</div>
</div>
</section>
<section id="quali-factors-12" class="slide level2">
<h2>Quali: factors</h2>
<p>Even once defined we can <span class="hl-yellow"><strong>reorder the levels</strong></span> with <code>fct_relevel()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb741"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1"></a>marks_database_expand <span class="ot">&lt;-</span> </span>
<span id="cb741-2"><a href="#cb741-2"></a>  marks_database <span class="sc">|&gt;</span>  </span>
<span id="cb741-3"><a href="#cb741-3"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb741-4"><a href="#cb741-4"></a>  <span class="fu">pull</span>(marks)</span>
<span id="cb741-5"><a href="#cb741-5"></a></span>
<span id="cb741-6"><a href="#cb741-6"></a>marks_database_expand <span class="sc">|&gt;</span> </span>
<span id="cb741-7"><a href="#cb741-7"></a>  <span class="fu">fct_relevel</span>(<span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F- &lt; F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+ &lt; A++</code></pre>
</div>
</div>
</section>
<section id="quali-factors-13" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p>This way of working with qualitative variables allows us to give a <span class="hl-yellow"><strong>theoretical definition</strong></span> of our database, and we can even count values that do not yet exist (but could), making use of <code>fct_count()</code>.</p>
</div><div class="column" style="width:45%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/fct_count.jpg" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb743"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb743-1"><a href="#cb743-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb743-2"><a href="#cb743-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb743-3"><a href="#cb743-3"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb743-4"><a href="#cb743-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  f         n
  &lt;ord&gt; &lt;int&gt;
1 F         2
2 E         2
3 D         2
4 C         4
5 B         2
6 A         3
7 A+        2
8 F-        0
9 A++       0</code></pre>
</div>
</div>
</section>
<section id="quali-factors-14" class="slide level2">
<h2>Quali: factors</h2>
<p>The levels can also be <span class="hl-yellow"><strong>sorted by frequency</strong></span> with <code>fct_infreq()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb745"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb745-1"><a href="#cb745-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb745-2"><a href="#cb745-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_infreq</span>(marks)) <span class="sc">|&gt;</span> </span>
<span id="cb745-3"><a href="#cb745-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: C &lt; A &lt; F &lt; E &lt; D &lt; B &lt; A+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb747"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb747-2"><a href="#cb747-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_infreq</span>(marks)) <span class="sc">|&gt;</span> </span>
<span id="cb747-3"><a href="#cb747-3"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb747-4"><a href="#cb747-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  f         n
  &lt;ord&gt; &lt;int&gt;
1 C         4
2 A         3
3 F         2
4 E         2
5 D         2
6 B         2
7 A+        2</code></pre>
</div>
</div>
</section>
<section id="quali-factors-15" class="slide level2">
<h2>Quali: factors</h2>
<p>Sometimes we will want to <span class="hl-yellow"><strong>group levels</strong></span>, for example, not allowing levels that <span class="hl-yellow"><strong>do not happen a minimum number of times</strong></span> with <code>fct_lump_min(..., min = ..)</code> (observations that do not meet this will go to a <strong>generic level</strong> called <code>Other</code>, although this can be changed with the <code>other_level</code> argument).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb749"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb749-1"><a href="#cb749-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb749-2"><a href="#cb749-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">%&gt;%</span> </span>
<span id="cb749-3"><a href="#cb749-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A     Other Other Other Other A     C     C     Other Other A     C    
[13] C     Other Other Other Other
Levels: C &lt; A &lt; Other</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb751"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb751-1"><a href="#cb751-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb751-2"><a href="#cb751-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span></span>
<span id="cb751-3"><a href="#cb751-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb751-4"><a href="#cb751-4"></a>               <span class="at">other_level =</span> <span class="st">"Less frequent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A             Less frequent Less frequent Less frequent Less frequent
 [6] A             C             C             Less frequent Less frequent
[11] A             C             C             Less frequent Less frequent
[16] Less frequent Less frequent
Levels: C &lt; A &lt; Less frequent</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="quali-factors-16" class="slide level2">
<h2>Quali: factors</h2>
<p>We can do something equivalent but based on its <span class="hl-yellow"><strong>relative frequency</strong></span> with <code>fct_lump_prop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb753"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb753-1"><a href="#cb753-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb753-2"><a href="#cb753-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb753-3"><a href="#cb753-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.15</span>,</span>
<span id="cb753-4"><a href="#cb753-4"></a>                <span class="at">other_level =</span> <span class="st">"less frequent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A             less frequent less frequent less frequent less frequent
 [6] A             C             C             less frequent less frequent
[11] A             C             C             less frequent less frequent
[16] less frequent less frequent
Levels: C &lt; A &lt; less frequent</code></pre>
</div>
</div>
</section>
<section id="quali-factors-17" class="slide level2">
<h2>Quali: factors</h2>
<p>We can apply this to our datasets to <span class="hl-yellow"><strong>recategorize variables</strong></span> very quickly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb755"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb755-1"><a href="#cb755-1"></a>starwars <span class="sc">|&gt;</span>  </span>
<span id="cb755-2"><a href="#cb755-2"></a>  <span class="fu">drop_na</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb755-3"><a href="#cb755-3"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb755-4"><a href="#cb755-4"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb755-5"><a href="#cb755-5"></a>                        <span class="at">other_level =</span> <span class="st">"Others"</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb755-6"><a href="#cb755-6"></a>  <span class="fu">count</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  species     n
  &lt;fct&gt;   &lt;int&gt;
1 Droid       6
2 Gungan      3
3 Human      35
4 Others     39</code></pre>
</div>
</div>
</section>
<section id="quali-factors-18" class="slide level2">
<h2>Quali: factors</h2>
<p>With <code>fct_reorder()</code> we can also indicate that we want to <span class="hl-yellow"><strong>order the factors</strong></span> according to a function applied to another variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb757"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb757-1"><a href="#cb757-1"></a>starwars_factor <span class="ot">&lt;-</span> </span>
<span id="cb757-2"><a href="#cb757-2"></a>  starwars <span class="sc">|&gt;</span>  </span>
<span id="cb757-3"><a href="#cb757-3"></a>  <span class="fu">drop_na</span>(height, species) <span class="sc">|&gt;</span> </span>
<span id="cb757-4"><a href="#cb757-4"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb757-5"><a href="#cb757-5"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb757-6"><a href="#cb757-6"></a>                        <span class="at">other_level =</span> <span class="st">"Others"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb758"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb758-1"><a href="#cb758-1"></a>starwars_factor <span class="sc">|&gt;</span>  <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Others Human  Others Others Human  Human  Others Human 
[21] Human  Droid  Others Human  Human  Others Human  Others Others Human 
[31] Others Human  Gungan Gungan Gungan Others Others Human  Others Others
[41] Others Others Others Others Human  Others Others Others Others Others
[51] Others Others Others Human  Human  Human  Others Others Others Human 
[61] Human  Human  Human  Others Others Others Others Human  Others Droid 
[71] Others Others Others Others Others Human  Others Human 
Levels: Droid Gungan Human Others</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb760"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb760-1"><a href="#cb760-1"></a>starwars_factor <span class="sc">|&gt;</span> </span>
<span id="cb760-2"><a href="#cb760-2"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">fct_reorder</span>(species, height, mean)) <span class="sc">|&gt;</span> </span>
<span id="cb760-3"><a href="#cb760-3"></a>  <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Others Human  Others Others Human  Human  Others Human 
[21] Human  Droid  Others Human  Human  Others Human  Others Others Human 
[31] Others Human  Gungan Gungan Gungan Others Others Human  Others Others
[41] Others Others Others Others Human  Others Others Others Others Others
[51] Others Others Others Human  Human  Human  Others Others Others Human 
[61] Human  Human  Human  Others Others Others Others Human  Others Droid 
[71] Others Others Others Others Others Human  Others Human 
Levels: Droid Others Human Gungan</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="your-turn" class="slide level2">
<h2>💻 Your turn</h2>
<div class="panel-tabset">
<ul id="tabset-16" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-16-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-16-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-16-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-16-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-16-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-16-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-16-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-16-1">
<p>📝 Given the variable <code>months</code> defined below (defined as a character vector), convert this variable to factor (just that)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb762"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb762-1"><a href="#cb762-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb763"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb763-1"><a href="#cb763-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>)</span>
<span id="cb763-2"><a href="#cb763-2"></a>months_fct <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(months)</span>
<span id="cb763-3"><a href="#cb763-3"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-2">
<p>📝 Given the variable <code>months</code> defined below converts this variable to a factor but indicating the levels correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb764"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb764-1"><a href="#cb764-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Apr"</span>, <span class="st">"Jan"</span>, <span class="st">"Oct"</span>, <span class="st">"Jul"</span>, <span class="st">"Jan"</span>, <span class="st">"Sep"</span>, <span class="cn">NA</span>, <span class="st">"Feb"</span>, <span class="st">"Dic"</span>,</span>
<span id="cb764-2"><a href="#cb764-2"></a>           <span class="st">"Jul"</span>, <span class="st">"Mar"</span>, <span class="st">"Jan"</span>, <span class="st">"Mar"</span>, <span class="st">"Feb"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>,  <span class="cn">NA</span>,</span>
<span id="cb764-3"><a href="#cb764-3"></a>           <span class="st">"Dic"</span>, <span class="st">"Jul"</span>, <span class="st">"Nov"</span>, <span class="st">"Feb"</span>, <span class="st">"Oct"</span>, <span class="st">"Jun"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb765"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb765-1"><a href="#cb765-1"></a>months_fct <span class="ot">&lt;-</span></span>
<span id="cb765-2"><a href="#cb765-2"></a>  <span class="fu">factor</span>(months,</span>
<span id="cb765-3"><a href="#cb765-3"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dic"</span>))</span>
<span id="cb765-4"><a href="#cb765-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-3">
<p>📝 Count how many values there are for each month but keep in mind that they are factors (maybe there are unused levels and you should get a 0 for them).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb766"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb766-1"><a href="#cb766-1"></a>meses_fct <span class="sc">|&gt;</span>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-4">
<p>📝 Since there are missing values, it indicates that the absentee is a thirteenth level labeled <code>"missing"</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb767"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb767-1"><a href="#cb767-1"></a>months_fct <span class="ot">&lt;-</span> </span>
<span id="cb767-2"><a href="#cb767-2"></a>  months_fct <span class="sc">|&gt;</span> </span>
<span id="cb767-3"><a href="#cb767-3"></a>  <span class="fu">fct_explicit_na</span>(<span class="at">na_level =</span> <span class="st">"missing"</span>)</span>
<span id="cb767-4"><a href="#cb767-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-5">
<p>📝 Removes unused levels.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb768"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb768-1"><a href="#cb768-1"></a>months_fct <span class="ot">&lt;-</span> </span>
<span id="cb768-2"><a href="#cb768-2"></a>  months_fct <span class="sc">%&gt;%</span></span>
<span id="cb768-3"><a href="#cb768-3"></a>  <span class="fu">fct_drop</span>()</span>
<span id="cb768-4"><a href="#cb768-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-6">
<p>📝 Sort the levels by frequency of occurrence.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb769"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb769-1"><a href="#cb769-1"></a>months_fct <span class="sc">|&gt;</span> </span>
<span id="cb769-2"><a href="#cb769-2"></a>  <span class="fu">fct_infreq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-7">
<p>📝 Group levels so that any level that does not appear at least 7% of the time is grouped in a level called <code>"other months"</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb770"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb770-1"><a href="#cb770-1"></a>months_fct <span class="ot">&lt;-</span></span>
<span id="cb770-2"><a href="#cb770-2"></a>  months_fct <span class="sc">|&gt;</span> </span>
<span id="cb770-3"><a href="#cb770-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.07</span>, <span class="at">other_level =</span> <span class="st">"other months"</span>)</span>
<span id="cb770-4"><a href="#cb770-4"></a>months_fct </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="clase-9" class="title-slide slide level1 center">
<h1>Lesson 9: lists, joins and SQL</h1>
<p><span style="color:#444442;"><strong>Lists. Joins and SQL connection</strong></span></p>
</section>
<section id="lists" class="slide level2">
<h2>Lists</h2>
<p>We have already seen that lists are an object in R that allows us to store <span class="hl-yellow"><strong>collections of variables of different type</strong></span> (as with <code>data.frame</code> and <code>tibble</code>) but also <span class="hl-purple"><strong>different lengths</strong></span>, with totally heterogeneous structures (even a list can have inside it another list).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb771"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb771-1"><a href="#cb771-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span>
<span id="cb771-2"><a href="#cb771-2"></a>age <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb771-3"><a href="#cb771-3"></a>marks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb771-4"><a href="#cb771-4"></a>parents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Paloma"</span>, <span class="st">"Goyo"</span>)</span>
<span id="cb771-5"><a href="#cb771-5"></a></span>
<span id="cb771-6"><a href="#cb771-6"></a>list_var <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> name, <span class="st">"age"</span> <span class="ot">=</span> age, <span class="st">"marks"</span> <span class="ot">=</span> marks, <span class="st">"parents"</span> <span class="ot">=</span> parents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb772"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb772-1"><a href="#cb772-1"></a>list_var<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb774"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb774-1"><a href="#cb774-1"></a>list_var<span class="sc">$</span>marks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7  8  5  3 10  9</code></pre>
</div>
</div>
</section>
<section id="lists-1" class="slide level2">
<h2>Lists</h2>
<p>We can also make <span class="hl-yellow"><strong>lists with other lists inside</strong></span>, so that to access each level we must use the <code>[[]]</code> operator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb776"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb776-1"><a href="#cb776-1"></a>list_of_lists <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"list_1"</span> <span class="ot">=</span> list_var[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="st">"list_2"</span> <span class="ot">=</span> list_var[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb776-2"><a href="#cb776-2"></a><span class="fu">names</span>(list_of_lists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list_1" "list_2"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb778"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb778-1"><a href="#cb778-1"></a><span class="fu">names</span>(list_of_lists[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "name" "age" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb780"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb780-1"><a href="#cb780-1"></a>list_of_lists[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi"</code></pre>
</div>
</div>
<div class="fragment">
<p>We are allowed to store <span class="hl-yellow"><strong>n-dimensional data</strong></span>!</p>
</div>
</section>
<section id="lists-2" class="slide level2">
<h2>Lists</h2>
<p>One of the disadvantages is that a list <span class="hl-yellow"><strong>cannot be vectorized</strong></span> immediately, so any arithmetic operation applied to a list will give <span class="hl-red"><strong>error</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb782"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb782-1"><a href="#cb782-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb782-2"><a href="#cb782-2"></a>data <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data/2: non-numeric argument to binary operator</code></pre>
</div>
</div>
<div class="fragment">
<p>For this purpose, one of the common (but outdated) options is to make use of the <code>lapply()</code> family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb784"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb784-1"><a href="#cb784-1"></a><span class="fu">lapply</span>(data, <span class="at">FUN =</span> <span class="cf">function</span>(x) { x <span class="sc">/</span> <span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] 0.5 1.0 1.5 2.0 2.5

$b
 [1]  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5 10.0</code></pre>
</div>
</div>
<p>By default, the output of <code>lapply()</code>is always a <span class="hl-yellow"><strong>list of equal length</strong></span>.</p>
</div>
</section>
<section id="lists-3" class="slide level2">
<h2>Lists</h2>
<p>A more flexible and versatile option is to make use of the <code>{purrr}</code> package of the <code>{tidyverse}</code> environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb786"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb786-1"><a href="#cb786-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This package is intended to mimic the <span class="hl-yellow"><strong>functional programming</strong></span> of other languages such as Scala or Hadoop’s <span class="hl-yellow"><strong>map-reduce strategy</strong></span> (from Google).</p>

<img data-src="img/purrr.png" class="r-stretch"></section>
<section id="lists-4" class="slide level2">
<h2>Lists</h2>
<p>The simplest function of the <code>{purrr}</code> package is the <code>map()</code> function, which <span class="hl-yellow"><strong>applies a vectorized function</strong></span> to each of the elements of a list. Let’s see a first example applied to vectors</p>
<div class="fragment">
<p><code>map()</code> allows us to <span class="hl-yellow"><strong>“map” each list</strong></span> and apply the function element by element (if applicable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb787"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb787-1"><a href="#cb787-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"x1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"x2"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb787-2"><a href="#cb787-2"></a><span class="fu">map</span>(x, sqrt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x1
[1] 1.000000 1.414214 1.732051 2.000000

$x2
 [1] 3.316625 3.464102 3.605551 3.741657 3.872983 4.000000 4.123106 4.242641
 [9] 4.358899 4.472136</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>With vectors we have a default vectorization because <code>R</code> performs element-by-element operations. Note that, by default, the <span class="hl-yellow"><strong>output of <code>map</code> is a list</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="lists-5" class="slide level2">
<h2>Lists</h2>
<p>Let’s look at another example. Define in a list two samples from 2 normal distributions, of different sample size and different mean. Compute the mean of each one.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb789"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb789-1"><a href="#cb789-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1500</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.7</span>),</span>
<span id="cb789-2"><a href="#cb789-2"></a>          <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">2800</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">1.5</span>))</span>
<span id="cb789-3"><a href="#cb789-3"></a><span class="fu">map</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] -0.006135355

[[2]]
[1] 1.950277</code></pre>
</div>
</div>
</section>
<section id="lists-6" class="slide level2">
<h2>Lists</h2>
<p>What if we want to calculate the mean of their squared values?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb791"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb791-1"><a href="#cb791-1"></a><span class="fu">map</span>(x, <span class="cf">function</span>(x) { <span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.4794524

[[2]]
[1] 6.094396</code></pre>
</div>
</div>
</section>
<section id="lists-7" class="slide level2">
<h2>Lists</h2>
<p>In addition to being <span class="hl-yellow"><strong>more readable and efficient</strong></span>, with <code>{purrr}</code> we can <span class="hl-yellow"><strong>decide the output format</strong></span> after the operation</p>
<ul>
<li>output as <span class="hl-purple"><strong>numeric (double) vector</strong></span> with <code>map_dbl()</code></li>
<li>output as <span class="hl-purple"><strong>numeric (int) vector</strong></span> with <code>map_int()</code></li>
<li>output as <span class="hl-purple"><strong>character vector</strong></span> with <code>map_chr()</code></li>
<li>output as <span class="hl-purple"><strong>logical vector</strong></span> with <code>map_lgl()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb793"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb793-1"><a href="#cb793-1"></a><span class="fu">map_dbl</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.006135355  1.950277482</code></pre>
</div>
<div class="sourceCode cell-code" id="cb795"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb795-1"><a href="#cb795-1"></a><span class="fu">map_chr</span>(x, <span class="cf">function</span>(x) { <span class="fu">glue</span>(<span class="st">"Mean is {round(mean(x), 5)}"</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean is -0.00614" "Mean is 1.95028" </code></pre>
</div>
</div>
</section>
<section id="lists-8" class="slide level2">
<h2>Lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb797"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb797-1"><a href="#cb797-1"></a><span class="fu">c</span>(x[[<span class="dv">1</span>]][<span class="dv">3</span>], x[[<span class="dv">2</span>]][<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3489989  3.1888925</code></pre>
</div>
</div>
<p>Also, if you pass it a <span class="hl-yellow"><strong>number</strong></span> instead of a function, it will return the <span class="hl-yellow"><strong>ith element of each list</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb799"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb799-1"><a href="#cb799-1"></a><span class="fu">map_dbl</span>(x, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3489989  3.1888925</code></pre>
</div>
</div>
</section>
<section id="lists-9" class="slide level2">
<h2>Lists</h2>
<p>We also have the option of generalizing it to be able to use functions that <span class="hl-yellow"><strong>need two arguments in the form of a list</strong></span> (binary operations), with <code>map2()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb801"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb801-1"><a href="#cb801-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb801-2"><a href="#cb801-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"c"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>), <span class="st">"b"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb801-3"><a href="#cb801-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1]  2 20  9

$b
[1] 41 41 37</code></pre>
</div>
</div>
</section>
<section id="lists-10" class="slide level2">
<h2>Lists</h2>
<p>We can obtain the output in the form of <code>data.frame</code> by adding <code>list_rbind()</code> or <code>list_cbind()</code>, which <span class="hl-yellow"><strong>converts a list into a table</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb803"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb803-1"><a href="#cb803-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb803-2"><a href="#cb803-2"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb803-3"><a href="#cb803-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { <span class="fu">tibble</span>(x, y) }) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  x         y
  &lt;chr&gt; &lt;int&gt;
1 a         1
2 b         2
3 c         3</code></pre>
</div>
</div>
</section>
<section id="lists-11" class="slide level2">
<h2>Lists</h2>
<p>We can generalize it further with <code>pmap_xxx()</code> which allows us to use <span class="hl-yellow"><strong>multiple arguments (multiple lists)</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb805"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb805-1"><a href="#cb805-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb805-2"><a href="#cb805-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb805-3"><a href="#cb805-3"></a>z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>)</span>
<span id="cb805-4"><a href="#cb805-4"></a><span class="fu">pmap_dbl</span>(<span class="fu">list</span>(x, y, z), sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111 221 331</code></pre>
</div>
</div>
</section>
<section id="lists-12" class="slide level2">
<h2>Lists</h2>
<p>We have other types of iterators that, although they assume inputs, do not return anything, as <code>walk()</code> (just one input argument), <code>walk2()</code> (two arguments) and <code>pwalk()</code> (multiple arguments), all <span class="hl-yellow"><strong>invisibly return</strong></span>, just call a function for its <span class="hl-yellow"><strong>side effects</strong></span> rather than its return value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb807"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb807-1"><a href="#cb807-1"></a><span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb807-2"><a href="#cb807-2"></a>  <span class="fu">map2</span>(<span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>),</span>
<span id="cb807-3"><a href="#cb807-3"></a>       <span class="cf">function</span>(x, y) { x <span class="sc">+</span> y }) <span class="sc">|&gt;</span> </span>
<span id="cb807-4"><a href="#cb807-4"></a>  <span class="fu">walk</span>(print)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12 14 16
[1] 18 20 22</code></pre>
</div>
</div>
</section>
<section id="your-turn-1" class="slide level2">
<h2>💻 Your turn</h2>
<div class="panel-tabset">
<ul id="tabset-17" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-17-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-17-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-17-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-17-1">
<p>📝 Define a list of 4 elements of different types and access the second of them (I will include one that is a tibble so that you can see that in a list there is room for everything).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb809"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb809-1"><a href="#cb809-1"></a>list_example <span class="ot">&lt;-</span></span>
<span id="cb809-2"><a href="#cb809-2"></a>  <span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="st">"Javier"</span>, <span class="st">"cp"</span> <span class="ot">=</span> <span class="dv">28019</span>,</span>
<span id="cb809-3"><a href="#cb809-3"></a>       <span class="st">"siblings"</span> <span class="ot">=</span> <span class="cn">TRUE</span>,</span>
<span id="cb809-4"><a href="#cb809-4"></a>       <span class="st">"marks"</span> <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"maths"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">9</span>),</span>
<span id="cb809-5"><a href="#cb809-5"></a>                        <span class="st">"lang"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">6</span>)))</span>
<span id="cb809-6"><a href="#cb809-6"></a>list_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-2">
<p>📝 From the list above, access the elements that occupy places 1 and 4 of the list defined above.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb810"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb810-1"><a href="#cb810-1"></a>list_example[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb810-2"><a href="#cb810-2"></a></span>
<span id="cb810-3"><a href="#cb810-3"></a>list_example<span class="sc">$</span>name</span>
<span id="cb810-4"><a href="#cb810-4"></a>list_example<span class="sc">$</span>marks</span>
<span id="cb810-5"><a href="#cb810-5"></a></span>
<span id="cb810-6"><a href="#cb810-6"></a>list_example[<span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"marks"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-3">
<p>📝 Load the <code>starwars</code> dataset from the <code>{dplyr}</code> package and access the second movie that appears in <code>starwars$films</code> (for each character). Determine which ones do not appear in more than one movie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb811"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb811-1"><a href="#cb811-1"></a>second_film <span class="ot">&lt;-</span> <span class="fu">map</span>(starwars<span class="sc">$</span>films, <span class="dv">2</span>)</span>
<span id="cb811-2"><a href="#cb811-2"></a><span class="fu">map_lgl</span>(second_film, is.null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
[13] FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE
[25]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE
[37]  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE
[49] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE
[61] FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[73] FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[85]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="joins" class="slide level2">
<h2>Joins</h2>
<p>When working with data we will not always have the information in a single table, and sometimes, we will be interested in <span class="hl-yellow"><strong>cross-referencing</strong></span> information from different sources.</p>
<div class="fragment">
<p>For this we will use a classic of every language that handles data: the famous <span class="hl-yellow"><strong>join</strong></span>, a tool that will allow us to <span class="hl-yellow"><strong>cross one or several tables</strong></span>, making use of a <span class="hl-yellow"><strong>identifying column</strong></span> of each one of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb813"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb813-1"><a href="#cb813-1"></a>table_1 <span class="sc">|&gt;</span></span>
<span id="cb813-2"><a href="#cb813-2"></a>  <span class="fu">xxx_join</span>(table_2, <span class="at">by =</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="joins-1" class="slide level2">
<h2>Joins</h2>
<ul>
<li><p><code>inner_join()</code>: only <span class="hl-yellow"><strong>records with id in both</strong></span> tables survive.</p></li>
<li><p><code>full_join()</code>: keeps <span class="hl-yellow"><strong>all records in both</strong></span> tables.</p></li>
<li><p><code>left_join()</code>: keeps <span class="hl-yellow"><strong>all the records of the first table</strong></span>, and looks for which ones have id also in the second one (in case of <span class="hl-yellow"><strong>not having it, it fills with NA</strong></span> the fields of the 2nd table).</p></li>
<li><p><code>right_join()</code>: keeps <span class="hl-yellow"><strong>all records in the second table</strong></span>, and searches which ones have id also in the first one.</p></li>
</ul>

<img data-src="img/sql-joins.jpg" class="r-stretch"></section>
<section id="joins-2" class="slide level2">
<h2>Joins</h2>
<p>Let’s test the various joins with a simple example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb814"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb814-1"><a href="#cb814-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb814-2"><a href="#cb814-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb815"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb815-1"><a href="#cb815-1"></a>tb_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_x
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb817"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb817-1"><a href="#cb817-1"></a>tb_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="left_join" class="slide level2">
<h2>left_join()</h2>
<p>Imagine that we want to <span class="hl-yellow"><strong>incorporate</strong></span> to <code>tb_1</code> the <span class="hl-yellow"><strong>information from table_2</strong></span>, identifying the records by the key column (<code>by = "key"</code>, the column it has to cross): we want to keep all the records of the first table and look for which ones have the same value in <code>key</code> also in the second one.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb819"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb819-1"><a href="#cb819-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb819-2"><a href="#cb819-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/left_join.jpg"></p>
</div>
</div>
</div>
</section>
<section id="left_join-1" class="slide level2">
<h2>left_join()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb821"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb821-1"><a href="#cb821-1"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb821-2"><a href="#cb821-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Notice that the <span class="hl-yellow"><strong>records in the first one whose key was not found in the second one</strong></span> has given them the value of <span class="hl-yellow"><strong>absent</strong></span>.</p>
</section>
<section id="right_join" class="slide level2">
<h2>right_join()</h2>
<p>The <code>right_join()</code> will perform the opposite operation: we will now <span class="hl-yellow"><strong>incorporate</strong></span> to <code>tb_2</code> the <span class="hl-yellow"><strong>information from table_2</strong></span>, identifying the records by the <code>key</code> column: we want to keep all the records of the second one and look for which ones have id (same value in <code>key</code>) also in the first table.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb823"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb823-1"><a href="#cb823-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb823-2"><a href="#cb823-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/right_join.jpg"></p>
</div>
</div>
</div>
</section>
<section id="right_join-1" class="slide level2">
<h2>right_join()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb825"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb825-1"><a href="#cb825-1"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb825-2"><a href="#cb825-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
<p>Notice that now the <span class="hl-yellow"><strong>records of the second one whose key was not found in the first one</strong></span> are the ones given the value of <span class="hl-yellow"><strong>absent</strong></span>.</p>
</section>
<section id="keys-and-suffixes" class="slide level2">
<h2>keys and suffixes</h2>
<p>The key columns we will use for the crossover <span class="hl-yellow"><strong>will not always be named the same</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb827"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb827-1"><a href="#cb827-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb827-2"><a href="#cb827-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li><code>by = c("key_2" = "key_2")</code>: we will indicate in which column of each table are the keys that we are going to cross.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb828"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb828-1"><a href="#cb828-1"></a><span class="co"># Left</span></span>
<span id="cb828-2"><a href="#cb828-2"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb828-3"><a href="#cb828-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb830"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb830-1"><a href="#cb830-1"></a><span class="co"># Right</span></span>
<span id="cb830-2"><a href="#cb830-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb830-3"><a href="#cb830-3"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keys-and-suffixes-1" class="slide level2">
<h2>keys and suffixes</h2>
<p>We can also <span class="hl-yellow"><strong>cross over several columns at the same time</strong></span> (it will interpret as equal record the one that has the same set of keys), with <code>by = c("var1_t1" = "var1_t2", "var2_t1" = "var2_t2", ...)</code>. Let’s modify the previous example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb832"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb832-1"><a href="#cb832-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),  <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb832-2"><a href="#cb832-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_21"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"k_22"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"e"</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb833"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb833-1"><a href="#cb833-1"></a><span class="co"># Left</span></span>
<span id="cb833-2"><a href="#cb833-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb833-3"><a href="#cb833-3"></a>  <span class="fu">left_join</span>(tb_2,</span>
<span id="cb833-4"><a href="#cb833-4"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     3 c     x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb835"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb835-1"><a href="#cb835-1"></a><span class="co"># Right</span></span>
<span id="cb835-2"><a href="#cb835-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb835-3"><a href="#cb835-3"></a>  <span class="fu">right_join</span>(tb_2,</span>
<span id="cb835-4"><a href="#cb835-4"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     4 e     &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keys-and-suffixes-2" class="slide level2">
<h2>keys and suffixes</h2>
<p>It could also happen that when crossing two tables, there are <span class="hl-yellow"><strong>columns of values named the same</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb837"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb837-1"><a href="#cb837-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb837-2"><a href="#cb837-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb838"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb838-1"><a href="#cb838-1"></a><span class="co"># Left</span></span>
<span id="cb838-2"><a href="#cb838-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb838-3"><a href="#cb838-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Notice that <span class="hl-yellow"><strong>default adds the suffixes</strong></span> <code>.x</code> and <code>.y</code> to tell us which table they come from.</p>
</div>
</section>
<section id="keys-and-suffixes-3" class="slide level2">
<h2>keys and suffixes</h2>
<p>This <span class="hl-yellow"><strong>suffix can be specified</strong></span> in the optional argument <code>suffix = ...</code>, which allows us to <span class="hl-yellow"><strong>distinguish the variables</strong></span> of one table from another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb840"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb840-1"><a href="#cb840-1"></a><span class="co"># Left</span></span>
<span id="cb840-2"><a href="#cb840-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb840-3"><a href="#cb840-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>),</span>
<span id="cb840-4"><a href="#cb840-4"></a>            <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_table1"</span>, <span class="st">"_table2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_table1 val_table2
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1     1 x1         y1        
2     2 x2         y2        
3     3 x3         &lt;NA&gt;      </code></pre>
</div>
</div>
</section>
<section id="full_join" class="slide level2">
<h2>full_join()</h2>
<p>The two previous cases form what is known as <span class="hl-yellow"><strong>outer joins</strong></span>: crosses where observations are kept that appear in at least one table. The third outer join is known as <code>full_join()</code> which will <span class="hl-yellow"><strong>keep observations from both</strong></span> tables, <span class="hl-yellow"><strong>adding rows</strong></span> that do not match the other table.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb842"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb842-1"><a href="#cb842-1"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb842-2"><a href="#cb842-2"></a>  <span class="fu">full_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/full_join.jpg"></p>
</div>
</div>
</section>
<section id="inner_join" class="slide level2">
<h2>inner_join()</h2>
<p>Opposite the outer join is what is known as <span class="hl-yellow"><strong>inner join</strong></span>, with <code>inner_join()</code>: a join in which only the <span class="hl-yellow"><strong>observations that appear in both tables</strong></span> are kept, only those records that are patched are kept.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb844"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb844-1"><a href="#cb844-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb844-2"><a href="#cb844-2"></a>  <span class="fu">inner_join</span>(tb_2,  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/inner_join.png"></p>
</div>
</div>
</section>
<section id="inner_join-1" class="slide level2">
<h2>inner_join()</h2>
<p>Note that in terms of records, <code>inner_join</code> if it is commutative, <strong>we don’t care about the order of the tables</strong>: the only thing that changes is the order of the columns it adds.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb846"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb846-1"><a href="#cb846-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb846-2"><a href="#cb846-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb848"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb848-1"><a href="#cb848-1"></a>tb_2 <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(tb_1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="st">"key_1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_2 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 y1    x1   
2     2 y2    x2   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="semianti_join" class="slide level2">
<h2>semi/anti_join()</h2>
<p>Finally we have two interesting tools to <span class="hl-yellow"><strong>filter (not cross) records</strong></span>: <code>semi_join()</code> and <code>anti_join()</code>. The <span class="hl-yellow"><strong>semi join</strong></span> leaves us in the <span class="hl-yellow"><strong>first table the records whose key is also in the second table</strong></span> (like an inner join but without adding the info from the second table). And the second one, the anti join, does just the opposite (those that are not).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb850"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb850-1"><a href="#cb850-1"></a><span class="co"># semijoin</span></span>
<span id="cb850-2"><a href="#cb850-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb850-3"><a href="#cb850-3"></a>  <span class="fu">semi_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb852"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb852-1"><a href="#cb852-1"></a><span class="co"># antijoin</span></span>
<span id="cb852-2"><a href="#cb852-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb852-3"><a href="#cb852-3"></a>  <span class="fu">anti_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     3 x3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="your-turn-2" class="slide level2">
<h2>💻 Your turn</h2>
<p>For the exercises we will use the tables available in the package <code>{nycflights13}</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb854"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb854-1"><a href="#cb854-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>airlines</strong>: name of airlines (with their abbreviation).</li>
<li><strong>airports</strong>: airport data (names, longitude, latitude, altitude, etc).</li>
<li><strong>flights</strong>, <strong>planes</strong>: flight and aircraft data.</li>
<li><strong>weather</strong>: hourly weather data.</li>
</ul>
</section>
<section id="your-turn-3" class="slide level2">
<h2>💻 Your turn</h2>
<div class="panel-tabset">
<ul id="tabset-18" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-18-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-18-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-18-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-18-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-18-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-18-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-18-1">
<p>📝 From package <code>{nycflights13}</code> incorporates into the <code>flights</code> table the airline data in <code>airlines</code>. We want to maintain all flight records, adding the airline information to the airlines table.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb855"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb855-1"><a href="#cb855-1"></a>flights_airlines <span class="ot">&lt;-</span></span>
<span id="cb855-2"><a href="#cb855-2"></a>  flights <span class="sc">|&gt;</span> </span>
<span id="cb855-3"><a href="#cb855-3"></a>  <span class="fu">left_join</span>(airlines, <span class="at">by =</span> <span class="st">"carrier"</span>)</span>
<span id="cb855-4"><a href="#cb855-4"></a>flights_airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-2">
<p>📝 To the table obtained from the crossing of the previous section, include the data of the aircraft in <code>planes</code>, but including only those flights for which we have information on their aircraft (and vice versa).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb856"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb856-1"><a href="#cb856-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb856-2"><a href="#cb856-2"></a>  flights_airlines <span class="sc">|&gt;</span> </span>
<span id="cb856-3"><a href="#cb856-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>)</span>
<span id="cb856-4"><a href="#cb856-4"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-3">
<p>📝 Repeat the previous exercise but keeping both <code>year</code> variables (in one is the year of flight, in the other is the year of construction of the aircraft), and distinguishing them from each other</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb857"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb857-1"><a href="#cb857-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb857-2"><a href="#cb857-2"></a>  flights_airlines <span class="sc">|&gt;</span></span>
<span id="cb857-3"><a href="#cb857-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>,</span>
<span id="cb857-4"><a href="#cb857-4"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_flight"</span>, <span class="st">"_build_aircraft"</span>))</span>
<span id="cb857-5"><a href="#cb857-5"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-4">
<p>📝 To the table obtained from the previous exercise includes the longitude and latitude of the airports in <code>airports</code>, distinguishing between the latitude/longitude of the airport at destination and at origin.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb858"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb858-1"><a href="#cb858-1"></a>flights_airlines_planes <span class="sc">|&gt;</span> </span>
<span id="cb858-2"><a href="#cb858-2"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb858-3"><a href="#cb858-3"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb858-4"><a href="#cb858-4"></a>  <span class="fu">rename</span>(<span class="at">lat_origin =</span> lat, <span class="at">lon_origin =</span> lon) <span class="sc">|&gt;</span> </span>
<span id="cb858-5"><a href="#cb858-5"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb858-6"><a href="#cb858-6"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb858-7"><a href="#cb858-7"></a>  <span class="fu">rename</span>(<span class="at">lat_dest =</span> lat, <span class="at">lon_dest =</span> lon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-5">
<p>📝 Filter from <code>airports</code> only those airports from which flights depart. Repeat the process filtering only those airports where flights arrive.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb859"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb859-1"><a href="#cb859-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb859-2"><a href="#cb859-2"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"origin"</span>))</span>
<span id="cb859-3"><a href="#cb859-3"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb859-4"><a href="#cb859-4"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-6">
<p>📝 How many flights do we not have information about the aircraft? Eliminate flights that do not have an aircraft ID (other than NA) beforehand.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb860"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb860-1"><a href="#cb860-1"></a>flights <span class="sc">|&gt;</span></span>
<span id="cb860-2"><a href="#cb860-2"></a>  <span class="fu">drop_na</span>(tailnum) <span class="sc">|&gt;</span></span>
<span id="cb860-3"><a href="#cb860-3"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>) <span class="sc">|&gt;</span></span>
<span id="cb860-4"><a href="#cb860-4"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="dbplyr-sql-connection" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>Finally we are going to introduce the <code>{dbplyr}</code> package, which will allow us to combine <code>SQL</code> code into <code>R</code> to perform <span class="hl-yellow"><strong>database queries</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb861"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb861-1"><a href="#cb861-1"></a><span class="fu">install.packages</span>(<span class="st">"dbplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<p>If you are using R to do data analysis, most of the data you need probably already lives in a database. We will learn how to <span class="hl-yellow"><strong>load data in to a local database</strong></span>.</p>
</section>
<section id="dbplyr-sql-connection-1" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb862"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb862-1"><a href="#cb862-1"></a><span class="fu">install.packages</span>(<span class="st">"RSQLite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also need to install a <span class="hl-yellow"><strong>DBI backend package</strong></span> (an interface that allows <code>{dplyr}</code> to work with many different databases using the same code). Five commonly used backends are:</p>
<ul>
<li><p><code>RMariaDB</code> connects to MySQL and MariaDB</p></li>
<li><p><code>RPostgres</code> connects to Postgres and Redshift.</p></li>
<li><p><code>RSQLite</code> embeds a SQLite database.</p></li>
<li><p><code>odbc</code> connects to many commercial databases via the open database connectivity protocol.</p></li>
<li><p><code>bigrquery</code> connects to Google’s BigQuery.</p></li>
</ul>
<div class="fragment">
<p>In the following, we are going to use the <span class="hl-yellow"><strong>RSQLite backend</strong></span> (automatically installed when you install <code>{dbplyr}</code>).</p>
</div>
</section>
<section id="dbplyr-sql-connection-2" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>If we want to <span class="hl-yellow"><strong>work with a database adopting dplyr grammar</strong></span>, we must first connect to it. The connection will be done by using <code>DBI::dbConnect()</code>. The arguments to <code>DBI::dbConnect()</code> vary from database to database, but the first argument is always the database backend. SQLite only needs a path to the database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb863"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb863-1"><a href="#cb863-1"></a>connection <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">dbname =</span> <span class="st">":memory:"</span>)</span>
<span id="cb863-2"><a href="#cb863-2"></a>connection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQLiteConnection&gt;
  Path: :memory:
  Extensions: TRUE</code></pre>
</div>
</div>
<p>Here, the string <code>":memory:"</code> is a special path that creates <span class="hl-yellow"><strong>a temporary in-memory database</strong></span>.</p>
</section>
<section id="dbplyr-sql-connection-3" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The temporary database previously created has no yet data in it. We will <span class="hl-yellow"><strong>copy an existing database</strong></span> (for example, <code>gapminder</code> from <code>{gapminder}</code> package) using <code>copy_to()</code>. Using <code>tbl()</code> we “obtain” the database (called as named in <code>copy_to()</code>).</p>
<p>The main difference is that not it is a <span class="hl-yellow"><strong>remote source in a SQLite database</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb865"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb865-1"><a href="#cb865-1"></a><span class="fu">copy_to</span>(connection, gapminder<span class="sc">::</span>gapminder, <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"gapminder_database"</span>)</span>
<span id="cb865-2"><a href="#cb865-2"></a>gapminder_db <span class="ot">&lt;-</span> <span class="fu">tbl</span>(connection, <span class="st">"gapminder_database"</span>)</span>
<span id="cb865-3"><a href="#cb865-3"></a>gapminder_db</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;gapminder_database&gt; [?? x 6]
# Database: sqlite 3.43.2 [:memory:]
   country     continent  year lifeExp      pop gdpPercap
   &lt;chr&gt;       &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-4" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The main goal of <code>{dbplyr}</code> is to <span class="hl-yellow"><strong>automatically generate SQL from <code>dplyr</code> grammar</strong></span> that we are already familiar with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb867"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb867-1"><a href="#cb867-1"></a>gapminder_db <span class="sc">|&gt;</span></span>
<span id="cb867-2"><a href="#cb867-2"></a>  <span class="fu">select</span>(country, year, lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 3]
# Database: sqlite 3.43.2 [:memory:]
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-5" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The most important difference between ordinary tibbles and remote database queries is that now <span class="hl-yellow"><strong>our <code>R</code> code is translated into SQL and executed in the database on the remote server</strong></span>, not in R on your local machine: it never pulls data into R unless you explicitly ask for it, <span class="hl-purple"><strong>delaying doing any work until the last possible moment</strong></span> (sends it to the database in one step).</p>
<div class="fragment">
<p>It is not <span class="hl-yellow"><strong>until we ask for the data</strong></span> (writing <code>gapminder_query</code> in console, for example), <code>dplyr</code> verbs generates the SQL and requests the results from the database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb869"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb869-1"><a href="#cb869-1"></a>gapminder_query <span class="ot">&lt;-</span> </span>
<span id="cb869-2"><a href="#cb869-2"></a>  gapminder_db <span class="sc">|&gt;</span></span>
<span id="cb869-3"><a href="#cb869-3"></a>  <span class="fu">select</span>(country, year, lifeExp)</span>
<span id="cb869-4"><a href="#cb869-4"></a>gapminder_query</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 3]
# Database: sqlite 3.43.2 [:memory:]
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-6" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p><strong>What is happening behind the scenes?</strong></p>
<div class="fragment">
<p><code>{dplyr}</code> is <span class="hl-yellow"><strong>translating our R code into SQL verbs</strong></span>, that we can check (without doing) by using <code>show_query()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb871"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb871-1"><a href="#cb871-1"></a>gapminder_query <span class="sc">|&gt;</span> </span>
<span id="cb871-2"><a href="#cb871-2"></a>  <span class="fu">show_query</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `country`, `year`, `lifeExp`
FROM `gapminder_database`</code></pre>
</div>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-7" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>As commented, our remote database queries is not in R on your local machine: it never pulls data into R unless you explicitly ask for it. To do it, you can iterate a few times before you figure out what data you need, and then we use <code>collect()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb873"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb873-1"><a href="#cb873-1"></a>gapminder_tibble <span class="ot">&lt;-</span></span>
<span id="cb873-2"><a href="#cb873-2"></a>  gapminder_query <span class="sc">|&gt;</span> </span>
<span id="cb873-3"><a href="#cb873-3"></a>  <span class="fu">collect</span>()</span>
<span id="cb873-4"><a href="#cb873-4"></a>gapminder_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 3
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-8" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>You can also use <code>translate_sql()</code> to translate individual expressions from <code>dplyr</code> to SQL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb875"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb875-1"><a href="#cb875-1"></a>dbplyr<span class="sc">::</span><span class="fu">translate_sql</span>((x <span class="sc">+</span> y) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">con =</span> connection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt; (`x` + `y`) / 2.0</code></pre>
</div>
</div>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks</h1>
<p><span style="color:#444442;"><strong>Thanks! </strong></span></p>
<div class="footer footer-default">
<p><a href="..."><strong>Javier Álvarez Liébana</strong></a> • Master in Computational Social Sciences • 2023-2024</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal"},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"16956441010174300204","id":"48f01a60569d3088","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>